{
   "roles" : {
      "default" : {
         "summaries" : [
            "detection_attackers_scanning_for_vulnerable_jboss_servers",
            "detection_common_ransomware_extensions",
            "detection_web_servers_executing_suspicious_processes",
            "detection_attrib_to_hide_files",
            "detection_delete_shadow_copies",
            "detection_protocols_authenticating_in_cleartext",
            "detection_excessive_dns_failures",
            "detection_port_monitor_via_registry",
            "detection_remote_wmi_process_instantiation",
            "detection_netbackup_failed_backup",
            "detection_suspicious_email_attachments",
            "detection_clients_connecting_to_multiple_dns_servers",
            "detection_malicious_application_shimming_via_registry",
            "detection_fsutil_deleting_journals",
            "suspicious_box_usage",
            "external_alarm_activity",
            "suspicious_powershell_activity",
            "suspicious_privilege_escalation",
            "unusual_external_alarm",
            "scanning_activity",
            "suspicious_account_lockout",
            "multiple_authentications",
            "multiple_box_operations",
            "multiple_box_login_errors",
            "multiple_box_logins",
            "multiple_authentication_failures",
            "multiple_external_alarms",
            "unusual_time_of_badge_access",
            "many_usb_file_copies",
            "sse_hostnotincmdb",
            "detection_remote_wmi_command_attempt",
            "detection_file_write_spikes",
            "showcase_unusual_child_process_for_spoolsv_or_connhost",
            "detection_shim_database_installation",
            "sse_dyndns",
            "user_many_dlp_events",
            "user_login_local_credentials",
            "detection_brand_abuse_email",
            "detection_email_attachments_with_spaces",
            "detection_schtasks_forced_reboot",
            "detection_malicious_powershell_process_encoded_command",
            "detection_badrabbit_schtasks",
            "detection_suspicious_wevtutil_usage",
            "detection_registry_persistence",
            "new_data_exfil_dlp_alerts",
            "detection_sc_manipulating_services",
            "detection_brand_abuse_web",
            "detection_unauthorized_dns_servers",
            "detection_dns_query_length_with_high_standard_deviation",
            "detection_tor_traffic",
            "detection_unusually_long_content-type_length",
            "detection_hosts_file_modification",
            "user_login_unauthorized_geo",
            "detection_unusually_long_commandlines",
            "detection_common_ransomware_notes",
            "detection_rare_executables_on_endpoint",
            "detection_windows_event_log_cleared",
            "detection_dns_amplification_any_query",
            "detection_netbackup_no_backups_in_time_period",
            "detection_smb_traffic_spike",
            "detection_dyn_dns_queries",
            "detection_remote_desktop_network_traffic",
            "detection_uncommon_processes",
            "detection_unauthorized_assets_via_mac_address",
            "detection_cscript_via_cmd",
            "detection_reg_used_to_hide_files",
            "detection_malicious_powershell_process_obfuscation_techniques",
            "detection_new_user_accounts",
            "detection_schtasks_scheduling_job_on_remote_system",
            "detection_system_processes_run_from_unexpected_locations",
            "detection_usb_insertion",
            "detection_dns_tunnelling",
            "detection_disable_remote_uac",
            "detection_suspicious_reg_process",
            "detection_remote_desktop_process_running_on_system",
            "detection_malicious_requests_to_exploit_jboss_servers",
            "detection_protocol_mismatch",
            "detection_new_connections_to_routers",
            "detection_brand_abuse_dns",
            "detection_malicious_powershell_process_multiple_suspicious_arguments",
            "detection_shim_database_file_creation",
            "detection_long_dns_text_response",
            "detection_activity_related_to_pass_the_hash",
            "detection_prohibited_apps_spawning_cmdprompt",
            "detection_sql_injection_with_long_urls",
            "detection_excessive_user_account_lockouts",
            "detection_no_win_updates_in_timeframe",
            "detection_excessive_lockouts_from_endpoint",
            "detection_prohibited_software_on_endpoint",
            "detection_registry_privilege_escalation",
            "detection_open_redirect_in_splunk_web",
            "detection_prohibited_allowed_through_fw",
            "detection_overwrite_accessibility_binaries",
            "detection_malicious_powershell_process_connect_to_internet_with_hidden_window",
            "detection_rundll_loading_dll_by_ordinal",
            "showcase_new_suspicious_exe_launch_for_user",
            "showcase_new_sfdc_event_type",
            "showcase_new_runas",
            "showcase_first_logon",
            "showcase_new_path_for_common_filename",
            "showcase_series_discovery_tools_hashes",
            "showcase_huge_volume_dns_requests",
            "showcase_external_emails_with_internal_domain",
            "showcase_spike_in_sfdc_document_downloads",
            "showcase_new_parent_process_for_cmd",
            "showcase_high_entropy_processes",
            "showcase_new_sfdc_clients",
            "showcase_renamed_executables",
            "showcase_first_git_peer",
            "showcase_significant_printing",
            "showcase_new_host_with_suspicious_cmd_launch",
            "showcase_new_path_for_familiar_filename",
            "showcase_unusually_long",
            "showcase_remote_powershell_launches",
            "showcase_series_attacker_tools_filename",
            "showcase_new_interactive_service_logon",
            "showcase_unique_patient_records_viewed",
            "showcase_new_ad_domain",
            "showcase_hosts_where_sourcetypes_go_silent",
            "showcase_new_local_admin_account",
            "showcase_increase_interactive_logon",
            "showcase_many_hosts",
            "showcase_new_service_creations",
            "showcase_git_downloads",
            "showcase_increase_in_interactively_logged_on_users",
            "showcase_spike_in_sfdc_exports",
            "showcase_spike_in_password_reset_emails",
            "showcase_hosts_with_many_timestamps",
            "showcase_network_dc_dest",
            "showcase_increase_in_runas",
            "showcase_first_seen_domain_controller",
            "showcase_new_sfdc_tables_peer",
            "showcase_series_attacker_tools_hashes",
            "showcase_series_discovery_tools_filename",
            "showcase_spike_in_outgoing_email",
            "showcase_new_sfdc_tables",
            "showcase_short_lived_accounts",
            "showcase_lookalike_filenames",
            "showcase_new_logon_type",
            "showcase_huge_volume_dns_volume",
            "showcase_emails_with_lookalike_domains",
            "showcase_first_git",
            "showcase_first_usb",
            "AWS_New_API_Call_Per_User",
            "Basic_Expired_Account",
            "AWS_APIs_Called_More_Often_Than_Usual_Per_Account",
            "Basic_Scanning",
            "basic_gdpr_login_role_check",
            "UC0114",
            "UC0115",
            "UC0030",
            "UC0110",
            "UC0111",
            "UC0112",
            "AWS_Instance_Created_by_Unusual_User",
            "Large_Web_Upload",
            "AWS_Cloud_Provisioning_Activity_from_Unusual_Country",
            "AWS_New_API_Call_Per_Peer_Group",
            "Recurring_Infection_on_Host",
            "Multiple_Infections_on_Host",
            "Outdated_Malware_Definitions",
            "UC0107",
            "AWS_Unusual_Amount_of_Modifications_to_ACLs",
            "basic_brute_force",
            "UC0020",
            "AWS_Instance_Modified_by_Unusual_User",
            "UC0109",
            "UC0108",
            "Update_Service",
            "AWS_Cloud_Provisioning_Activity_from_Unusual_IP",
            "splunk_access_provisioning",
            "Basic_Malware_Outbreak",
            "sser_monitor_unsuccessful_backups",
            "sser_tor_traffic",
            "sser_ransomware_note_files",
            "sser_smb_traffic_allowed",
            "sser_monitor_autorun_registry_keys",
            "sser_detect_log_clearing_with_wevtutil",
            "sser_malicious_command_line_executions",
            "sser_fake_windows_processes",
            "sser_monitor_unsuccessful_windows_updates",
            "sser_ransomware_vulnerabilities",
            "sser_monitor_successful_backups",
            "sser_detect_journal_clearing",
            "sser_detect_lateral_movement_with_wmi",
            "sser_windows_event_log_clearing_events",
            "sser_ransomware_extensions",
            "sser_monitor_successful_windows_updates",
            "sser_spike_in_smb_traffic",
            "multiple_outgoing_connections",
            "download_from_internal_server",
            "UC0019",
            "UC0018",
            "insecure_or_cleartext_authentication_detected",
            "UC0010",
            "UC0013",
            "UC0012",
            "UC0015",
            "UC0014",
            "UC0016",
            "excessive_failed_logins",
            "host_with_high_number_of_listening_ports",
            "blacklisted_domain",
            "high_volume_email_activity_to_noncorporate_domains_by_user",
            "high_or_critical_priority_host_with_malware_detected",
            "asset_ownership_unspecified",
            "host_with_multiple_infections",
            "suspicious_http_redirects",
            "suspicious_domain_communication",
            "excessive_data_transmission",
            "anomalous_new_listening_port",
            "unroutable_activity_detected",
            "high_number_of_hosts_not_updating_malware_signatures",
            "UC0065",
            "host_with_high_number_of_services",
            "unusual_network_activity",
            "suspicious_network_exploration",
            "multiple_logins",
            "expected_host_not_reporting",
            "UC0091",
            "UC0090",
            "UC0092",
            "UC0095",
            "UC0097",
            "UC0096",
            "UC0099",
            "UC0098",
            "unusual_vpn_login_geolocation",
            "suspicious_domain_name",
            "UC0024",
            "external_website_attack",
            "UC0022",
            "UC0023",
            "high_process_count",
            "UC0029",
            "brute_force_access_behavior_detected_over_one_day",
            "potential_webshell_activity",
            "threat_activity_detected",
            "substantial_increase_in_port_activity",
            "same_error_on_many_servers_detected",
            "inactive_account_activity_detected",
            "high_volume_of_traffic_from_high_or_critical_host_observed",
            "machine_generated_beacon",
            "UC0103",
            "UC0102",
            "UC0101",
            "UC0100",
            "UC0105",
            "UC0104",
            "outbreak_detected",
            "suspicious_ip_address_communication",
            "prohibited_service_detected",
            "UC0079",
            "UC0077",
            "UC0075",
            "UC0074",
            "UC0073",
            "UC0072",
            "UC0071",
            "unusual_ad_event",
            "watchlisted_event_observed",
            "flight_risk_user",
            "blacklisted_application",
            "cleartext_password_at_rest_detected",
            "new_user_account_created_on_multiple_hosts",
            "unusually_long_vpn_session",
            "potential_gap_in_data",
            "abnormally_high_number_of_endpoint_changes_by_user",
            "excessive_http_failure_responses",
            "UC0106",
            "host_with_old_infection_or_potential_reinfection",
            "UC0031",
            "UC0037",
            "UC0036",
            "UC0035",
            "prohibited_port_activity_detected",
            "excessive_dns_queries",
            "abnormally_high_number_of_http_method_events_by_src",
            "UC0046",
            "UC0044",
            "vulnerability_scanner_detected_by_targets",
            "UC0041",
            "activity_from_expired_user_identity",
            "UC0049",
            "unusual_web_browser",
            "network_change_detected",
            "high_or_critical_priority_individual_logging_into_infected_machine",
            "unusual_machine_access",
            "completely_inactive_account",
            "land_speed_violation",
            "host_with_a_recurring_malware_infection",
            "anomalous_new_process",
            "excessive_dns_failures",
            "period_with_unusual_ad_activity_sequences",
            "concurrent_login_attempts_detected",
            "untriaged_notable_events",
            "substantial_increase_in_events",
            "brute_force_access_behavior_detected",
            "shortlived_account_detected",
            "UC0042",
            "web_uploads_to_noncorporate_sites_by_users",
            "high_number_of_infected_hosts",
            "UC0008",
            "UC0009",
            "UC0002",
            "UC0003",
            "UC0001",
            "UC0006",
            "UC0007",
            "UC0004",
            "UC0005",
            "geographically_improbable_access_detected",
            "network_device_rebooted",
            "multiple_primary_functions_detected",
            "prohibited_process_detected",
            "account_deleted",
            "personally_identifiable_information_detected",
            "UC0028",
            "malicious_ad_activity",
            "host_sending_excessive_email",
            "UC0021",
            "vulnerability_scanner_detected_by_events",
            "anomalous_audit_trail_activity_detected",
            "anomalous_new_service",
            "unusual_activity_time",
            "UC0087",
            "blacklisted_ip_address",
            "UC0055",
            "UC0054",
            "UC0057",
            "Unusual_AWS_Regions",
            "AWS_Public_Bucket",
            "UC0051",
            "UC0050",
            "New_Domain",
            "UC0053",
            "UC0052",
            "unusual_geolocation_of_communication_destination",
            "default_account_activity_detected",
            "default_account_at_rest_detected",
            "unusual_volume_of_network_activity",
            "unusual_usb_activity",
            "UC0082",
            "UC0083",
            "gdpr_investigation",
            "gdpr_glass_table",
            "UC0084",
            "old_passwords",
            "UC0085",
            "UC0088",
            "suspicious_data_movement",
            "access_inscope_resources_unencrypted",
            "access_inscope_resources",
            "codeword_threshold_departments",
            "pull_list_of_privileged_users",
            "risky_events_from_privileged_users",
            "land_speed_privileged",
            "aggregated_risk",
            "showcase_first_logon_jump_server",
            "privileged_acts_unprivileged_users",
            "new_privileged_user",
            "new_cloud_provider",
            "stale_account_usage",
            "unauthorized_login_attempt",
            "building_departmental_peer_group",
            "flight_risk_printing",
            "flight_risk_email",
            "potential_day_trading",
            "flight_risk_user_browsing",
            "unauthorized_web_browsing",
            "detection_aws_activity_from_non_approved_accounts",
            "detection_new_aws_console_login_by_user",
            "detection_process_launching_netsh",
            "detection_s3_access_from_new_ip",
            "detection_aws_cloud_provisioning_from_previously_unseen_ip",
            "detection_psexec_accepteula",
            "detection_process_with_spaces_before_extension",
            "detection_first_time_seen_cmd_line",
            "detection_spike_aws_api_call_per_account",
            "detection_large_icmp_outbound",
            "detection_deletion_network_acl",
            "detection_splunk_information_disclosure",
            "detection_change_file_association",
            "detection_abnormally_high_instances_launched",
            "detection_local_admin_account_creation",
            "detection_stop_security_services",
            "detection_netsh_launching_process",
            "detection_spike_aws_security_group_activity",
            "detection_dragonfly_schtasks",
            "detection_path_interception_program.exe",
            "detection_aws_cloud_provisioning_from_previously_unseen_city",
            "detection_process_with_double_extension",
            "detection_aws_cloud_provisioning_from_previously_unseen_region",
            "detection_spectre_meltdown_vulnerabilities",
            "detection_short_lived_accounts",
            "detection_emailserver_high_volume_outbound_traffic_to_hosts",
            "detection_outbound_smb_connections",
            "detection_ec2_instance_started_with_previously_unseen_ami",
            "detection_ec2_instance_started_with_previously_unseen_instance_type",
            "detection_users_without_mfa",
            "detection_aws_activity_in_new_region",
            "detection_suspicious_write_to_sysvol",
            "detection_reg_manipulating_services",
            "detection_hosts_receiving_high_volume_network_traffic_from_email_servers",
            "detection_create_local_admin_via_net",
            "detection_spike_vpc_blocked_traffic",
            "detection_aws_spike_acl_activity",
            "detection_single_letter_executables",
            "detection_ec2_instance_modified_by_previously_unseen_user",
            "detection_email_files_not_in_outlook_directory",
            "detection_add_to_untrust_cert_store",
            "detection_abnormally_high_instance_termination",
            "detection_suspicious_file_writes",
            "detection_suspicious_write_to_recycler",
            "detection_remote_registry_modifications",
            "detection_create_hidden_shares",
            "detection_acl_with_open_ports",
            "detection_ec2_instance_created_by_previously_unseen_user",
            "detection_malicious_powershell_process_execpolicy",
            "detection_api_acitivity_from_previously_unseen_user_role",
            "detection_aws_cloud_provisioning_from_previously_unseen_country",
            "detection_aws_cross_account_activity_from_new_account",
            "detection_powershell_reg_key_mod",
            "detection_spike_s3_deletion",
            "detection_cred_dump_via_reg",
            "detection_powershell_get_sedebug",
            "detection_mshta_launching_scripts",
            "detection_new_open_s3_buckets",
            "detection_first_time_seen_running_windows_service",
            "detection_powershell_read_from_lsass",
            "detection_children_of_spoolsv",
            "detection_wmi_perm_event_subscription",
            "detection_wmi_temp_event_subscription",
            "detection_wmi_perm_event_subscription_sysmon",
            "detection_samsam_test_file_write",
            "detection_wmi_process_launch",
            "detection_account_harvesting",
            "detection_remote_desktop_bruteforce",
            "detection_execution_of_nirsoft_tools",
            "detection_dns_record_changed",
            "detection_sncd_processes",
            "detection_osx_coldroot_pack",
            "detection_osx_keyboard_taps",
            "detection_batch_file_write_system32",
            "detection_wmi_script_execution",
            "detection_samsam_payload_extensions",
            "detection_suspicious_java_classes",
            "detection_anomalous_webclick",
            "detection_dyn_dns_web_traffic",
            "detection_password_sharing"
         ]
      }
   },
   "summaries" : {
      "network_device_rebooted" : {
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_App_for_Enterprise_Security",
         "data_source_categories" : "DS015ConfigurationManagement-ET01General",
         "mitre_tactic" : "|TA0005",
         "journey" : "Stage_4",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Configuration Management",
         "highlight" : "No",
         "help" : "Help not needed -- ES Use Case",
         "category" : "Operations",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Network",
         "name" : "Network Device Rebooted",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "SPLEase" : "Accelerated",
         "mitre_technique" : "|T1089",
         "search_name" : "Network - Network Device Rebooted - Rule",
         "description" : "Increases the risk score of network devices that have been rebooted."
      },
      "detection_aws_cross_account_activity_from_new_account" : {
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS",
         "help" : "This search<ol><li>Retrieves the <b>AssumeRole</b> event</li><li>Verifies that the log entry contains a value for the account ID of the requesting account</li><li>Ensures that the requesting account ID does not match the account ID of the requested account</li><li>Pulls in the previously seen requesting and requested account IDs</li><li>Splits up and executes multiple search paths at the same.</li><li>The first path determines the <b>firstTime</b> and <b>lastTime</b> entries for the cache file</li><li>Outputs the data to the cache file.</li><li>Creates a conditional statement that is always false (both because we don't want these values to exit the search pipeline and because we think we're clever).</li></ol>The second pipeline adds the <b>firstTime</b> and <b>lastTime</b> entries to search results. Next, it filters out any account pairs that haven't been seen for the first time within the last hour. The <code>isnotnull(_time)</code> will remove the entries from the cache file.<br></br>The search finishes by gathering the data that it will display to the user.",
         "includeSSE" : "Yes",
         "name" : "AWS Cross Account Activity From Previously Unseen Account",
         "mitre" : "Credential Access",
         "domain" : "Network",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "This search looks for AssumeRole events where an IAM role in a different account is requested for the first time.",
         "search_name" : "ESCU - AWS Cross Account Activity From Previously Unseen Account - Rule",
         "mitre_technique" : "",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0006",
         "journey" : "Stage_3",
         "story" : "AWS Cross Account Activity",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection"
      },
      "showcase_first_logon" : {
         "relevance" : "By monitoring and alerting on first time log ins to a server, you are able to detect if/when an adversary is able to escalate permissions or add new accounts to AD, or to endpoints directly. This should be a priority particularly for critical infrastructure, high-value and mission critical assets or those systems containing sensitive data. In addition to external adversary, this type of behavior can also be indicative of a potential insider threat issue, where an employee is probing their access, or potentially testing new accounts they may have created for malicious purposes.",
         "domain" : "Access",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>You should not review these alerts directly (except for access to extremely sensitive system), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
         "mitre" : "Lateral Movement",
         "includeSSE" : "Yes",
         "name" : "First Time Logon to New Server",
         "gdprtext" : "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and validate the user account accessing the specific system. Determine who the system owner is and contact them. If it is authorized, document it as such and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as a first time logon to a server that was never logged into before could suggest compromised credentials gaining access to other systems.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is an anonymized collection of Windows Logon events. For this analysis, we are effectively grouping by username and system name, which will give us a row for each username+systemname combination. We check if the first time that has occurred was in the last day.</p>",
         "released" : "1.0.0",
         "category" : "Lateral Movement|GDPR",
         "mitre_technique" : "|T1021|T1076",
         "SPLEase" : "Medium",
         "description" : "<p>Find users who logged into a new server for the first time.</p><p><b>Alert Volume:</b> Very High</p>",
         "killchain" : "Installation|Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "alertvolume" : "Very High",
         "relatedUseCases" : [
            "Basic_Scanning",
            "excessive_failed_logins",
            "detection_no_win_updates_in_timeframe"
         ],
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=First Log On to Server - Demo",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Compliance|Security Monitoring",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Authentication|Vendor-Specific Data",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "First Log On to Server - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "First Log On to Server - Live"
            },
            {
               "name" : "First Log On to Server - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_1",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-winsec",
         "mitre_tactic" : "TA0008"
      },
      "unroutable_activity_detected" : {
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : "",
         "alertvolume" : "Other",
         "mitre_tactic" : "|TA0007|TA0011",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "journey" : "Stage_2",
         "app" : "Splunk_App_for_Enterprise_Security",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "released" : "2.0.0",
         "category" : "Scanning",
         "help" : "Help not needed -- ES Use Case",
         "name" : "Unrouteable Activity Detected",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Network",
         "hasSearch" : "No",
         "searchKeywords" : "Unroutable",
         "description" : "Alerts when activity to or from a host that is unrouteable is detected.",
         "SPLEase" : "Accelerated",
         "mitre_technique" : "|T1046|T1032|T1095|T1094"
      },
      "privileged_acts_unprivileged_users" : {
         "highlight" : "No",
         "datasource" : "Authentication|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Compliance|Insider Threat",
         "examples" : [
            {
               "name" : "Privileged Actions by Unprivileged Users - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Privileged Actions by Unprivileged Users - Live"
            }
         ],
         "journey" : "Stage_4",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-winsec",
         "mitre_tactic" : "TA0004",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "High",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Privileged Actions by Unprivileged Users - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/privileged_acts_unprivileged_users.png",
         "description" : "Detect users who shouldn't be able admins taking privileged actions.",
         "mitre_technique" : "|T1078",
         "SPLEase" : "Basic",
         "hasSearch" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Non-Privileged Users taking Privileged Actions",
         "relevance" : "Most larger organizations have strict controls to look for users enacting privileged actions. The other option is to not monitor this activity, potentially leaving you blind to new administrators coming in your environment. Once you have built out a list of privileged users, you can look for any instances of privileged activities from other accounts.",
         "domain" : "Access",
         "knownFP" : "The #1 scenario when this alerts falsely is when the events themselves are incorrectly marked with tag=privileged. The Windows TA defines what eventtypes (basically, micro-searches that we evaluate every time you click the search button) is privileged in a file called tags.conf. You can always tune this set of tags, though it's probably easier to just add NOT EventCode=XXXX to block out the event IDs that you don't find valuable. If this becomes onerous for you, you can always start alerting on the first time this occurs for a particular user or particular system by using a first time seen detection.",
         "mitre" : "Privilege Escalation",
         "category" : "Compliance|Insider Threat|Privilege Escalation",
         "released" : "2.2.0",
         "help" : "<p>This example leverages the Simple Search Assistant. Our dataset is a list of anonymized Windows events with the EventCode and the tags (which come from the technology add-ons). The live search leverages the same dataset from the Windows TAs.</p>",
         "operationalize" : "When this alert fires, you should first analyze whether this particular event is one that you would not expect the user to be able to do with their existing permissions. If that's the case, analyze the groups that the user is a member of, or see if there's a local account with the same username that might be the source of these rights. Evaluate whether this is allowable or not.",
         "howToImplement" : "<p>Implementation of this search depends on two key components -- privileged events, and a list of privileged (and not) users.</p><p>Generating the privileged events is relatively straightforward to get started with as many TAs will define privileged actions by default.</p><p>Generating a list of risky users is complicated -- that's why one of the most detailed examples in Splunk Security Essentials takes this on! Check it out! (<a href=\"/app/Splunk_Security_Essentials/showcase_simple_search?ml_toolkit.dataset=Pull%20List%20of%20Privileged%20Users%20-%20Demo\" target=\"_blank\">link</a>).</p><p>Once you have these components, implementation of this detection is straightforward.</p>"
      },
      "new_cloud_provider" : {
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, validate whether the usage of this cloud provider is permitted by your policy, and investigate to see what data is being stored there. Common allowable scenarios can be uploading into a box folder provided by a vendor for secure support file upload, which might be allowable, versus the backup of data to a personal Google drive account. Ultimately this search will generate many shades of gray, so it's prudent to understand supporting information such as the amount of data transmitted before reaching out to the employee or their manager to determine next steps.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is an anonymized collection of Palo Alto Networks events. For this analysis, we are effectively grouping by username and app name after filtering for the category, which will give us a row for each username+appname combination. We check if the first time that has occurred was in the last day.</p>",
         "category" : "Data Exfiltration|Insider Threat|Shadow IT",
         "released" : "2.2.0",
         "relevance" : "Data exfiltration techniques vary across the world, but certainly a very common approach taken in 2018 is to upload data to a non-corporate file storage solution. Tracking new file storage solutions end up in your environment is a key capability to track where data flows in your organization along with the adoption of Shadow IT.",
         "domain" : "Network",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>You should not review these alerts directly (except for access to extremely sensitive system), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
         "mitre" : "Exfiltration",
         "includeSSE" : "Yes",
         "name" : "New Cloud Provider for User",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1048|T1102",
         "SPLEase" : "Medium",
         "description" : "<p>Detect a user who is accessing a cloud storage provider they've never used before.</p>",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/new_cloud_provider.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Cloud Provider for User - Demo",
         "alertvolume" : "High",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "New Cloud Provider for User - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "New Cloud Provider for User - Live",
               "label" : "Live Data"
            },
            {
               "label" : "Accelerated Data",
               "name" : "New Cloud Provider for User - Accelerated"
            }
         ],
         "journey" : "Stage_2",
         "mitre_tactic" : "TA0010|TA0011",
         "data_source_categories" : "DS005WebProxyRequest-ET01RequestedWebAppAware",
         "usecase" : "Insider Threat|Security Monitoring",
         "icon" : "Core_Use_Case.png",
         "highlight" : "Yes",
         "datasource" : "Web Proxy",
         "displayapp" : "Splunk Security Essentials"
      },
      "showcase_unusually_long" : {
         "alertvolume" : "Low",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Find Unusually Long CLI Commands - Demo",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "icon" : "Core_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Find Unusually Long CLI Commands - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Find Unusually Long CLI Commands - Live"
            }
         ],
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "domain" : "Endpoint",
         "relevance" : "To avoid detection by file integrity monitoring solutions or similar, malware will often execute code 'in memory' and never write the code to disk. But if you're watching process executions in some detail via windows process command line auditing or via Sysmon or similar, you can often pick up anomalous behavior such as statistically significant command line execution lengths. The example given here shows a command interpreter executing a large amount of .vbs code to download a ransomware encryption binary.",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect a spike in the length of the CLI commands, but that doesn't mean you really want to put it in front of an analyst. So while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>You should not review these alerts directly (except for access to extremely sensitive system), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
         "mitre" : "Execution",
         "name" : "Find Unusually Long CLI Commands",
         "includeSSE" : "Yes",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Sysmon process launch logs (EventCode 1). The search then looks for unusually long command line strings, and surfaces those.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and determine the user account that is generating the alert. Contact the user and system owner to determine if it is authorized, and document if it is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as excessively long command lines commands could house malicious scripts.</p>",
         "howToImplement" : "Implementing this search is similar to any of the other searches that require EDR data. In order to use it, we need to get process launch events, and know the full command line string (so the file path, process name, and the command line arguments). For the demo and live version of this search we use Microsoft Sysmon with the CommandLine field, but you could adjust that to another data source and change the field name (it is not a CIM field).",
         "released" : "1.0.0",
         "category" : "Endpoint Compromise",
         "mitre_technique" : "|T1059",
         "SPLEase" : "Medium",
         "description" : "<p>Oftentimes we're able to detect malware by looking for unusually long command line strings.</p><p><b>Alert Volume:</b> Low</p>",
         "killchain" : "Installation|Exploitation|Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "datasources" : "Endpoint Detection and Response"
      },
      "UC0091" : {
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Using host based logs such as firewall or host intrusion detection for each asset with a governance category verify communication (accept or reject) has occurred with origination from one or more authorized platform vulnerability scanners (e.g. Rapid7, Nessus, OpenVAS).",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "released" : "2.0.0",
         "category" : "Operations",
         "help" : "Help not needed -- PS Use Case",
         "name" : "Validate Execution of Platform Vulnerability Scan",
         "includeSSE" : "No",
         "domain" : "Operations",
         "mitre" : "",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Network Communication|Host-based IDS",
         "usecase" : "Security Monitoring",
         "icon" : "PS_Use_Case.png",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other"
      },
      "sser_tor_traffic" : {
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS010NetworkCommunication-ET01TrafficAppAware",
         "mitre_tactic" : "TA0010|TA0011",
         "examples" : [
            {
               "name" : "Monitor TOR traffic - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Monitor TOR traffic - Live"
            },
            {
               "name" : "Monitor TOR traffic - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_1",
         "alertvolume" : "Low",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Monitor TOR traffic - Demo",
         "relatedUseCases" : [
            "Large_Web_Upload",
            "showcase_huge_volume_dns_volume",
            "detection_long_dns_text_response"
         ],
         "similarUseCases" : [
            "detection_tor_traffic"
         ],
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1041|T1048|T1071|T1095|T1188",
         "description" : "<p>The anonymity of TOR makes it the perfect place to hide C&C, exfiltration, or ransomware payment via bitcoin. This example looks for ransomware activity based on FW logs.</p><p><b>Alert Volume:</b> Low</p>",
         "searchKeywords" : "",
         "killchain" : "Command and Control",
         "hasSearch" : "Yes",
         "mitre" : "Exfiltration|Command and Control",
         "knownFP" : "None at the moment",
         "domain" : "Network",
         "includeSSE" : "Yes",
         "name" : "Basic TOR Traffic Detection",
         "operationalize" : "When this search fires, you will to verify with the system owner that the traffic generated was by them.  Verify with corporate policies if TOR is allowed in your environment.",
         "help" : "The anonymity of TOR makes it the perfect place for hackers who want to anonymize command and control or network connections. Many forms of ransomware install a TOR client to facilitate their payment via bitcoin. This use case analyzes your network traffic data to identify hosts that are generating TOR traffic within your environment.",
         "howToImplement" : "This use case requires you to index data from a source that does protocol analysis to determine the type of network traffic being used, regardless of the port associated with the traffic. This data is often available from next-generation firewalls or other traffic analysis tools such as Splunk Stream or Bro.",
         "category" : "Command and Control|Endpoint Compromise",
         "released" : "1.0.0"
      },
      "UC0106" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Detect evasion/escalation technique where the password of a privileged user reset by another authorized account this should be rare and supported by appropriate trouble ticketing and authentication of the requesting user. ",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "category" : "Account Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "includeSSE" : "No",
         "name" : "Reset of password other than by self for privileged user",
         "mitre" : "",
         "domain" : "Access",
         "mitre_tactic" : "",
         "journey" : "Stage_2",
         "app" : "Splunk_Professional_Services",
         "datasource" : "Audit Trail",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "PS_Use_Case.png",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other"
      },
      "unusual_volume_of_network_activity" : {
         "usecase" : "Insider Threat|Application Security|Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Network Communication",
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_2",
         "mitre_tactic" : "",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : "DoS is not covered in MITRE ATT&CK",
         "mitre_technique" : "",
         "search_name" : "Network - Unusual Volume of Network Activity - Rule",
         "SPLEase" : "Advanced",
         "description" : "Detects unusual network traffic that may be indicative of a DoS attack as indicated by a high number of unique sources or a high volume of firewall packets",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Network",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "Unusual Volume of Network Activity",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Data Exfiltration|Denial of Service"
      },
      "pull_list_of_privileged_users" : {
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/pull_list_of_privileged_users.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Pull List of Privileged Users - Demo",
         "mitre_notes" : "This is about building detections and understanding internal environment.  Not about finding indications of attacker behavior. ",
         "alertvolume" : "Very Low",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "Pull List of Privileged Users - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "SysAdmins",
               "name" : "Pull List of Privileged Users - SysAdmins from LDAP"
            },
            {
               "label" : "VIP Employees",
               "name" : "Pull List of Privileged Users - VIP Employees from LDAP"
            },
            {
               "name" : "Pull List of Privileged Users - Users Taking Privileged Acts",
               "label" : "Privileged Actios"
            },
            {
               "label" : "Calculate Risk Scores",
               "name" : "Pull List of Privileged Users - Calculate Risk Scores from LDAP"
            },
            {
               "label" : "Demo Data (Related Accounts)",
               "name" : "Pull List of Privileged Users - Connect Multiple Accounts to Employee - Demo"
            },
            {
               "label" : "Related Accounts",
               "name" : "Pull List of Privileged Users - Connect Multiple Accounts to Employee"
            }
         ],
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "data_source_categories" : "VendorSpecific-winsec-domaincontroller",
         "usecase" : "Insider Threat",
         "icon" : "Core_Use_Case.png",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "operationalize" : "This search does not directly create alarms, but is only used to generate lists of users for use in other searches. See Related Content. ",
         "howToImplement" : "<p>There are multiple approaches for pulling lists of Privileged Users, and multiple definitions of what privileged really means for a given scenario.</p><p><b>Pulling Users</b>. In this example we show three different methods for pulling lists of users: querying LDAP, querying a database, or looking for users who take the actions that a privileged user would take. Let's walk through these examples. <ul><li>Pulling from LDAP - there are three different approaches for pulling from LDAP. We generally recommend that most users start by using the Supporting Add-on for Active Directory (aka SA-ldapsearch) which provides the ldapsearch command. This command is native in Splunk, and works great for on premises installations in organizations with fewer than 50,000 users (<a href=\"https://splunkbase.splunk.com/app/1151/\" target=\"_blank\">app link</a>, <a href=\"http://docs.splunk.com/Documentation/SA-LdapSearch/2.1.6/User/AbouttheSplunkSupportingAdd-onforActiveDirectory\" target=\"_blank\">docs link</a>). You can also pull data using AD Monitor, which is the Splunk Universal Forwarder's ability to monitor Active Directory for changes -- recommended for large organizations, and for Cloud environments (<a href=\"http://docs.splunk.com/Documentation/Splunk/7.0.2/Data/MonitorActiveDirectory\" target=\"_blank\">doc link</a>). Finally, it is sometimes simpler to use Powershell for this effort (<a href=\"https://gallery.technet.microsoft.com/scriptcenter/Powershell-script-to-5edcdaea\" target=\"_blank\">link</a>).</li><li>Organizations with formal systems for managing privileged users that don't sync to Active Directory will most frequently need to pull a list of users by querying a database (though sometimes an API is available). This frequently occurs when you have an on-prem software application backed by a database that stores a list of privileged users. The process you will walk through to pull that data into Splunk is to first discover the username and password to log into the database along with the query that will return your desired set of users, and then configure Splunk DB Connect (<a href=\"https://splunkbase.splunk.com/app/2686/\" target=\"_blank\">link</a>, <a href=\"http://docs.splunk.com/Documentation/DBX/latest\">doc link</a>) to pull that data. Learning the credentials and the required query is sometimes very easy, and sometimes very difficult, but often you will be able to find help from Splunk Professional Services or on <a href=\"https://answers.splunk.com/\">Splunk Answers</a>.</li><li>Finally, we can always infer a list of privileged users by finding users who take privileged actions. There are many ways to approach this process, but the simplest is by searching for the use of tag=privileged  on authentication events, as defined by the Splunk Common Information Model.</li></ul></p><p>Now we've discussed how to ingest the data in the first place -- but we haven't discussed what data we actually should be ingesting. There are two primary categories of privileged users that we might want to monitor: those who have administrative rights, and those that are privileged. <ul><li>Those who have administrative rights is a very simple question to answer in a smaller organization, but exponentially more difficult with the complexity of the environment. It's best to start with standard privileged AD groups, such as Domain Admins, and then expand into environment-specific groups, such as the custom help desk admin group that had local admin rights on all workstations (every company has at least one of these). It's often easiest to find these types of groups by hunting through LDAP for key terms such as \"*admin*\" or \"*operator*\" etc. Finally, wrap up by searching for users with specific admin rights, such as privileged service accounts and see what groups (if any) they belong to. It's generally advisable to look for known administrative users across the organization (either specific names, or by naming scheme such as jsmith-a) and seeing which groups these users belong to.</li><li>Generally speaking, understanding VIP users in an organization can be dramatically easier than finding all admin accounts. Title will frequently get you all you need, though you may also find that tracking the # of steps away from the CEO based on reporting structure can be very effective. It's important to not forget employees that are associated with highly visible people but aren't themselves as visible, particularly the executive assistants for all your important users. They generally have full access to an exec's calendar, mailboxes, and more often than we would like they will also have a text file somewhere on their computer with the executive's password (or similar).</li></ul></p>",
         "help" : "<p>This example leverages the Simple Search Assistant. There are several ways to pull this data from live environments -- see the different options for more information.</p>",
         "category" : "Insider Threat",
         "released" : "2.2.0",
         "domain" : "Access",
         "relevance" : "Every organization should seek to inform their detections with the relative risk of the users and systems involved. If two users send out a large volume of data but one of those users is a database administrator, you should probably respond to that alert first. Security organizations serious about insider threat should be able to look at different dimensions of privilege and then inform both their detection methods and their response prioritization accordingly. The two easiest of those dimensions are \"users with elevated rights on systems\" (e.g., sysadmins, database admins, etc.) and \"employees who have access to privileged information\" (e.g., executives, employees involved in mergers and acquisitions, etc.). It's entirely possible that you will build out a series of different lists for different scenarios (for example, a list of users read in on a particularly acquisition project, etc.) but it's easiest to start with just accounts that have elevated rights and those that have privileged information.",
         "mitre" : "Privilege Escalation|Credential Access",
         "knownFP" : "The concept of a false positive versus false negative is slightly different for this example as ultimately we are working to build out a list of users, but both are extremely common. Mapping the organizational structure (and permissions structures) of an organization is inherently very complicated, and will require lots of testing and tuning to get a meaningful list. The benefit though is that since this search does not directly create alarms, some amount of inaccuracy is acceptable.",
         "name" : "Pull List of Privileged Users",
         "includeSSE" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "",
         "SPLEase" : "Hard",
         "description" : "To focus detection or response on privileged users, you must first build a list of accounts that have elevated rights or access to privileged information."
      },
      "detection_suspicious_wevtutil_usage" : {
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "similarUseCases" : [
            "sser_windows_event_log_clearing_events",
            "detection_windows_event_log_cleared",
            "sser_detect_log_clearing_with_wevtutil"
         ],
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "story" : "Ransomware",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0005",
         "journey" : "Stage_3",
         "mitre" : "Defense Evasion",
         "domain" : "Endpoint",
         "name" : "Suspicious wevtutil Usage",
         "includeSSE" : "Yes",
         "help" : "This search looks for execution of wevtutil.exe with command-line arguments that indicate that it has been used to delete the setup, application, security, or system event logs. The search returns the number of times the behavior was observed, the first and last time it was seen, the host exhibiting the behavior and the user context of the process execution.",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "SPLEase" : "None",
         "mitre_technique" : "T1070",
         "search_name" : "ESCU - Suspicious wevtutil Usage - Rule",
         "description" : "The wevtutil.exe application is the windows event log utility. This searches for wevtutil.exe with parameters for clearing the application, security, setup, or system event logs.",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No"
      },
      "showcase_new_interactive_service_logon" : {
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Authentication|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-winsec",
         "mitre_tactic" : "TA0004|TA0003|TA0008|TA0005",
         "journey" : "Stage_1",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "New Interactive Logon from a Service Account - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "New Interactive Logon from a Service Account - Live"
            }
         ],
         "alertvolume" : "Low",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Interactive Logon from a Service Account - Demo",
         "relatedUseCases" : [
            "sser_fake_windows_processes",
            "showcase_new_local_admin_account"
         ],
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1078|T1021",
         "description" : "<p>In most environments, service accounts should not log on interactively. This search finds new user/host combinations for accounts starting with \"svc_.\" </p><p><b>Alert Volume:</b> Low</p>",
         "searchKeywords" : "",
         "killchain" : "Command and Control",
         "hasSearch" : "Yes",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>In most environments, you should be able to directly respond to this event because service accounts should not suddenly start logging on interactively.</p>",
         "mitre" : "Privilege Escalation|Persistence|Lateral Movement|Defense Evasion",
         "domain" : "Access",
         "relevance" : "<p>Service accounts are more than likely privileged accounts in organizations. However, they should almost never log on interactively (e.g., via Remote Desktop, or by physically sitting at a keyboard and monitor). Because of their privilege and the fact that their usernames often describe their level of access (e.g., svc_exchange_admin), they're a big target for account compromise. Mature organizations should monitor for this activity, and investigate any new logon activity.",
         "includeSSE" : "Yes",
         "name" : "New Interactive Logon from a Service Account",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li><b>For this search</b> it is also key to verify that the username format of service accounts (or a lookup, if appropriate) is accurate so that you are just looking at service accounts.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the event, as well as the user account and system, credentials that were used, process executed and other pertinent information. Contact the owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of interactive logon events, and then we apply a filter for when the account name starts with svc_ -- obviously you could adjust this, or leverage a lookup as applicable in your environment. We check the first time that each user has logged interactively onto each server. Notably, this search is probably one of the most difficult in the environment from a performance perspective. Searching for Logon Types requires pulling back almost all of the data off of disk -- it would be highly recommended to leverage a lookup to cache your baseline (on the roadmap for a future version of this app). That said, for most organizations you could likely dispense with the baseline and just whitelist known good service account / host combinations as well.</p>",
         "released" : "1.0.0",
         "category" : "Endpoint Compromise"
      },
      "detection_wmi_perm_event_subscription" : {
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious WMI Use",
         "journey" : "Stage_1",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0002|TA0003",
         "domain" : "Endpoint",
         "incluseSSE" : "No",
         "mitre" : "Execution|Persistence",
         "includeSSE" : "Yes",
         "name" : "WMI Permanent Event Subscription",
         "help" : "Attackers are increasingly abusing Windows Management Infrastructure (WMI) for stealth, persistence, lateral movement, or just to leverage its functionality. This search looks for the creation of a WMI event subscription by watching for Windows event ID 5861.",
         "category" : "Adversary Tactics|",
         "released" : "2.2.0",
         "mitre_technique" : "T1047|T1084",
         "description" : "This search looks for the creation of WMI permanent event subscriptions.",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No"
      },
      "UC0014" : {
         "mitre" : "",
         "domain" : "Access",
         "includeSSE" : "No",
         "name" : "Monitor Secondary Accounts after Primary Disabled",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Insider Threat",
         "released" : "2.0.0",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "A human user may own multiple accounts. When the primary account of the human is expired, disabled, or deleted, we should expect no further activity from any other account owned by the user.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "similarUseCases" : [
            "activity_from_expired_user_identity",
            "Basic_Expired_Account"
         ],
         "usecase" : "Insider Threat",
         "icon" : "PS_Use_Case.png",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Authentication",
         "highlight" : "No",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_3"
      },
      "UC0102" : {
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Traditional brute force attacks generate hundreds or thousands of failed access attempts against a single host. This is a variation of brute force, where the objective is to detect password guessing attempts that do not cause account lockouts or will not trigger other &quot;failed access&quot; notable events. ",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Access",
         "includeSSE" : "No",
         "name" : "Slow/Controlled Password Guessing Detected",
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Scanning|Account Compromise",
         "usecase" : "Security Monitoring",
         "icon" : "PS_Use_Case.png",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Authentication",
         "highlight" : "No",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_2",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case"
      },
      "detection_rundll_loading_dll_by_ordinal" : {
         "hasSearch" : "No",
         "killchain" : "Installation",
         "searchKeywords" : "",
         "description" : "This search looks for DLLs under %AppData% being loaded by rundll32.exe that are calling the exported function at ordinal 2. Calling exported functions by ordinal is not as common as calling by exported name. There was a bug fixed in IDAPro on 2016-08-08 that would not display functions without names.  Calling functions by ordinal would overcome the lack of name and make it harder for analyst to reverse engineer.",
         "search_name" : "ESCU - RunDLL Loading DLL By Ordinal - Rule",
         "mitre_technique" : "T1085",
         "SPLEase" : "None",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "This search looks for rundll32.exe being run, loading a DLL out of a directory or subdirectory of AppData, and specifying the function at ordinal 2 be run.",
         "includeSSE" : "Yes",
         "name" : "RunDLL Loading DLL By Ordinal",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Unusual Processes",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "flight_risk_user" : {
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "description" : "Detecting indications of a persistent interest in flight risk based on signals in email, web, and other user activity.",
         "help" : "Help not needed -- UBA Use Case",
         "category" : "Insider Threat",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Other",
         "name" : "Flight Risk User",
         "includeSSE" : "Yes",
         "app" : "Splunk_User_Behavior_Analytics",
         "data_source_categories" : "DS001MAIL-ET03Send|DS005WebProxyRequest-ET01Requested",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Insider Threat",
         "datasource" : "Email|Web Proxy",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "Yes",
         "dashboard" : "UBA_Use_Case",
         "mitre_notes" : "Insider Threat, not external attacker",
         "alertvolume" : "Other"
      },
      "detection_stop_security_services" : {
         "name" : "Attempt To Stop Security Service",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion",
         "category" : "Adversary Tactics",
         "released" : "2.2.0",
         "help" : "This search looks for the processes <b>net.exe</b> and <b>sc.exe</b> with a parameter of <code>\"stop\"</code>. It then searches a list of security-related services included in a lookup file for matches on the command line. Results are subsequently returned in table format. The included lookup file can be modified to update the services to monitor.",
         "description" : "This search looks for attempts to stop security-related services on the endpoint.",
         "mitre_technique" : "T1089",
         "search_name" : "ESCU - Attempt To Stop Security Service - Rule",
         "hasSearch" : "No",
         "killchain" : "Installation|Actions on Objective",
         "searchKeywords" : "",
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "mitre_tactic" : "TA0005",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Disabling Security Tools"
      },
      "detection_reg_manipulating_services" : {
         "released" : "2.2.0",
         "category" : "Malware",
         "help" : "This search looks for modifications to registry paths that specify the definition and configuration of Windows services by reg.exe. Reg.exe is a Windows utility that allows for manipulation of the registry via the command line. Malware often uses the Windows services architecture to persist, hide in plain sight, and gain the ability to interact with the Windows kernel. While it is common to modify the configuration of Windows services (and new services may be created with software installs), the use of reg.exe to create or modify a service configuration is unusual and a technique commonly used by attackers. The search returns the count, the first time the activity was seen, the last time activity was seen, the registry path that was modified, the host where the modification took place, and the user that performed the modification.",
         "includeSSE" : "Yes",
         "name" : "Reg.exe Manipulating Windows Services Registry Keys",
         "domain" : "Endpoint",
         "mitre" : "Persistence|Privilege Escalation|Defense Evasion",
         "hasSearch" : "No",
         "killchain" : "Installation",
         "searchKeywords" : "",
         "description" : "The search looks for reg.exe modifying registry keys that define Windows services and their configurations.",
         "mitre_technique" : "T1050|T1031|T1089",
         "search_name" : "ESCU - Reg.exe Manipulating Windows Services Registry Keys - Rule",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0003|TA0004|TA0005",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Windows Service Abuse",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png"
      },
      "showcase_high_entropy_processes" : {
         "alertvolume" : "Medium",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Processes With High Entropy Names in Users Directory - Demo",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "mitre_tactic" : "TA0005",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "journey" : "Stage_3",
         "examples" : [
            {
               "name" : "Processes With High Entropy Names in Users Directory - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Processes With High Entropy Names in Users Directory - Live"
            }
         ],
         "app" : "Splunk_Security_Essentials",
         "name" : "Processes with High Entropy Names",
         "includeSSE" : "Yes",
         "knownFP" : "<p>This search looks for potentially randomized filenames using Shannon Entropy. Entropy is a basic measure of randomness, but tends to become less accurate with longer strings. You should not review these alerts directly (except for access to extremely sensitive system), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
         "mitre" : "Defense Evasion",
         "relevance" : "To avoid detection, malware often will launch malicious code with random filenames and/or paths. In this example, we use Shannon Entropy, provided by the URL Toolbox app, to identify these probable random names and report on them. Files with non-human-created character patterns are returned.",
         "domain" : "Endpoint",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of process launch logs (either Sysmon EventCode 1, or Windows Event ID 4688 -- either works). The search then leverages the URL Toolbox app from apps.splunk.com to determine entropy in the filename or file path. It takes filenames with the highest entropy, and surfaces them.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the file, path, user and system associated with this alert. Contact the user and system owner to determine if it is authorized, and document if it is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as randomized file names on a system may serve as a way to mask malware.</p>",
         "howToImplement" : "Implementing this search is similar to any of the other searches that require EDR data. In order to use it, we need to get process launch events. For the demo and live version of this search we use Windows Security Event ID 4688, as it tends to be the most common, but you could apply it to any other data source that shows you launched processes -- just adjust the file path field (New_Process_Name) to match (it is not a CIM field).",
         "description" : "<p>Some malware will launch processes with randomized filenames.</p><p><b>Alert Volume:</b> Medium</p>",
         "SPLEase" : "Hard",
         "mitre_technique" : "|T1027",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Installation"
      },
      "concurrent_login_attempts_detected" : {
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Authentication",
         "highlight" : "No",
         "app" : "Splunk_App_for_Enterprise_Security",
         "mitre_tactic" : "|TA0001|TA0004",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "journey" : "Stage_2",
         "mitre" : "",
         "domain" : "Access",
         "name" : "Concurrent Login Attempts Detected",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- ES Use Case",
         "category" : "IAM Analytics|Account Sharing|Account Compromise",
         "released" : "2.0.0",
         "SPLEase" : "Accelerated",
         "search_name" : "Access - Concurrent App Accesses - Rule",
         "mitre_technique" : "|T1078",
         "description" : "Alerts on concurrent access attempts to an app from different hosts. These are good indicators of shared passwords and potential misuse.",
         "searchKeywords" : "",
         "hasSearch" : "No"
      },
      "UC0073" : {
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "journey" : "Stage_2",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "highlight" : "No",
         "datasource" : "Anti-Virus",
         "displayapp" : "Splunk Professional Services",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "includeSSE" : "No",
         "name" : "Endpoint detected malware infection from URL",
         "domain" : "Endpoint",
         "mitre" : "",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Endpoint anti-malware detection event occurred where the malicious content was retrieved from an external URL. Possible indication of gaps in protection by web proxy, intrusion prevention, or advanced threat prevention. Use the information available for the event and determine how existing prevention controls can be modified to prevent future infections.",
         "mitre_technique" : "",
         "SPLEase" : "None"
      },
      "suspicious_ip_address_communication" : {
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "icon" : "UBA_Use_Case.png",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Network Communication",
         "highlight" : "No",
         "app" : "Splunk_User_Behavior_Analytics",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "|TA0011",
         "journey" : "Stage_6",
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "mitre_notes" : "",
         "mitre_technique" : "|T1094|T1071|T1095",
         "description" : "Suspicious IP Address Communication",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Other",
         "name" : "Suspicious IP Address Communication",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.0.0",
         "category" : "Command and Control|Endpoint Compromise|Data Exfiltration"
      },
      "detection_hosts_file_modification" : {
         "mitre" : "Command and Control|Exfiltration",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Windows hosts file modification",
         "help" : "The hosts file is present on both Windows and Linux endpoints. The purpose of the hosts file is to provide a mapping between hostnames and IP addresses, the same way DNS is used to provide such a mapping. However, the information in the hosts file takes precedence over information received via DNS and a DNS query will not be issued if the hostname of interest is found in the hosts file. As such, attackers have been observed adding entries to the host file to override any DNS resolution. For this reason, it is useful to monitor for changes to this file, which typically do not occur very often in legitimate cases.",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "SPLEase" : "None",
         "mitre_technique" : "|TA0011",
         "search_name" : "ESCU - Windows hosts file modification - Rule",
         "description" : "The search looks for modifications to the hosts file on all Windows endpoints across your environment.",
         "searchKeywords" : "",
         "killchain" : "Command and Control",
         "hasSearch" : "No",
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "story" : "Host Redirection",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "TA0011",
         "journey" : "Stage_3"
      },
      "UC0022" : {
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Endpoints attempting to communicate with an excessive number of unique hosts over a given time period may indicate malicious code. ",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "released" : "2.0.0",
         "category" : "Scanning|Lateral Movement|Data Exfiltration",
         "help" : "Help not needed -- PS Use Case",
         "name" : "Endpoint communicating with an excessive number of unique hosts",
         "includeSSE" : "No",
         "domain" : "Network",
         "mitre" : "",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "highlight" : "No",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Professional Services",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Insider Threat",
         "icon" : "PS_Use_Case.png",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other"
      },
      "detection_port_monitor_via_registry" : {
         "help" : "In this search, we look for modifications to registry keys used for adding print-monitor entries on Microsoft platforms via the <code>registry_path</code> field in the endpoint data model. It then provides the destination, command used to initiate the change, the user who conducted this activity, the resource affected (registry_key_name), and the entire path of the registry.",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "domain" : "Endpoint",
         "mitre" : "Persistence|Privilege Escalation",
         "name" : "Monitor Registry Keys for Print Monitors",
         "includeSSE" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "|T1060|T1013",
         "search_name" : "ESCU - Monitor Registry Keys for Print Monitors - Rule",
         "SPLEase" : "None",
         "description" : "This search looks for registry activity associated with modifications to the registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors</code>. In this scenario, an attacker can load an arbitrary .dll into the print-monitor registry by giving the full path name to the after.dll. The system will execute the .dll with elevated (SYSTEM) permissions and will persist after reboot.",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Windows Persistence Techniques",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0003|TA0004",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response"
      },
      "UC0112" : {
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Windows Service logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standard sourcetypes.",
         "domain" : "Access",
         "gdprtext" : "<h4>Problem:</h4><p>Keeping up with patch maintenance is a critical part of effective cyber-hygiene. Windows-based systems are especially at risk when unpatched, considering the number and frequency of exploits that use Windows vulnerabilities to establish a foothold, move laterally, or propagate. Windows-based systems that stop updating may be the target of malicious activity -- or, the same type of event may simply be the result of an environmental change, other configuration issue on the host, or scheduled downtime. If the update service itself it disabled on the host, then it may indicate a compromised system.</p><h4>Impact:</h4><p>Unpatched systems put data at risk. For any unpatched environments/systems that are involved in processing personal data, this situation can be critical, and especially so in a GDPR context, since any GDPR-tagged systems not receiving updates could jeopardize a state of compliance. Article 32 of the GDPR requires that organizations regularly test, assess and evaluate effectiveness of implemented technical and organizational security controls. In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58). If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). </p><h4>Resolution Path:</h4><p>The data mapping exercise from the DPO can inform which Windows-based systems are in-scope -- that is, those systems that are associated with the GDPR category. From there, identify the in-scope systems where updates are not occurring, pinpoint the root issue for updates not occurring, and remediate those hosts by configuring them or the environment appropriately, depending on what the root issue turns out to be.</p>",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1089",
         "description" : "Any GDPR-tagged systems not receiving updates could jeopardize your GDPR status due to Article 32. Detect systems where the Windows Update service is disabled.",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=Update Service GDPR - Demo",
         "similarUseCases" : [
            "UC0115"
         ],
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "|TA0005",
         "data_source_categories" : "DS019PatchManagement-Eligible",
         "journey" : "Stage_4",
         "gdpr" : "32|58|82",
         "usecase" : "Security Monitoring|Compliance",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "howToImplement" : "First, use your data mapping results to build a lookup that associates systems to their GDPR category. If you are using the Windows Forwarder with the WinHostMon://Service input configured, this search should work automatically. If you're using another source to detect Service status, you may need to adjust the search string to match your data source.",
         "operationalize" : "When Windows Update is disabled, the immediate question is why. Ask the user if they disabled it, look for software installations that might have done it, or look for any errors related to the Windows Update Service (wuauserv.exe).",
         "category" : "GDPR|Operations",
         "released" : "2.0.0",
         "knownFP" : "No known false positives at this time.",
         "mitre" : "",
         "relevance" : "GDPR Article 32 requires that you regularly test, assess and evaluate the effectiveness of your implemented technical and organizational security controls. If the Authority executes their powers and your Organization is in the scope of a Privacy Audit you need to demonstrate compliance (Article 58). Also in case you face a breach and individuals are impacted they have the right to compensation of the damage - if an organization can prove that they have done everything appropriate to the risk and deployed proper countermeasures, they shouldn't be liable (Article 82). Ensuring patches are applied to your systems is industry best practices and state of the art.",
         "name" : "In-Scope System with Windows Update Disabled",
         "SPLEase" : "Basic",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_windows_update_disabled.png",
         "alertvolume" : "Low",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Update Service GDPR - Demo"
            },
            {
               "name" : "Update Service GDPR - Live",
               "label" : "Live Data"
            }
         ],
         "icon" : "Core_Use_Case.png",
         "datasource" : "Patch Management"
      },
      "showcase_external_emails_with_internal_domain" : {
         "name" : "Emails from Outside the Organization with Company Domains",
         "includeSSE" : "Yes",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>Sending emails from your organization's domain from outside the organization is not uncommon, but new sources should be rare and investigated. Because this search has a behavioral component, only new sources (or very rare sources you haven't seen before, such as maybe quarter-end notifications) should show up and be investigated. Those can be filtered out, or you can use the lookup cache to build a long baseline that allows for it. </p></p>The only other source of false positives here will be more IP addresses from known and trusted vendors -- you can filter out entire cidr ranges, or just quickly dismiss the alerts based on forward and reverse DNS matching both matching an allowed source.</p>",
         "mitre" : "Initial Access",
         "domain" : "Network",
         "released" : "1.2.0",
         "category" : "Endpoint Compromise|SaaS",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the event, the system that originated the incoming mail and if possible identify the sender, recipient, subject of the mail and attachments, if any. Contact the recipient and mail administrator. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Make sure that you specify the correct domain name (or domain names) that belong to your company.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is an anonymized collection of email logs centered around a particular user for a month.</p>",
         "description" : "<p>Phishers will often try to send emails where the from address uses your organization's domain name, e.g., emailing finance from yourceo@yourcompany.com. Detect that now!</p><p><b>Alert Volume:</b> Very Low</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1192",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Delivery",
         "alertvolume" : "Very Low",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New External IPs Sending Company Emails - Demo",
         "relatedUseCases" : [
            "detection_email_attachments_with_spaces",
            "showcase_spike_in_outgoing_email",
            "high_volume_email_activity_to_noncorporate_domains_by_user",
            "detection_suspicious_email_attachments",
            "UC0004"
         ],
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/emails_from_outside_org.png",
         "datasource" : "Email",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "data_source_categories" : "DS001MAIL-ET02Receive",
         "mitre_tactic" : "TA0001",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "New External IPs Sending Company Emails - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "New External IPs Sending Company Emails - Live"
            },
            {
               "label" : "Cisco ESA Live Data",
               "name" : "New External IPs Sending Company Emails - Cisco ESA Live"
            },
            {
               "label" : "Accelerated Data",
               "name" : "New External IPs Sending Company Emails - Accelerated"
            }
         ],
         "app" : "Splunk_Security_Essentials"
      },
      "potential_day_trading" : {
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat",
         "highlight" : "No",
         "datasource" : "Web Proxy",
         "displayapp" : "Splunk Security Essentials",
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_1",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Suspected Day Trading Activity - Demo"
            },
            {
               "name" : "Suspected Day Trading Activity - Live",
               "label" : "Live Data"
            }
         ],
         "mitre_tactic" : "",
         "data_source_categories" : "DS005WebProxyRequest-ET01RequestedWebAppAware",
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/potential_day_trading.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Suspected Day Trading Activity - Demo",
         "mitre_notes" : "Not an attacker technique",
         "mitre_technique" : "",
         "SPLEase" : "Medium",
         "description" : "<p>Detect users who exhibit a large amount of stock trading activity in their proxy logs.</p>",
         "killchain" : "",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "domain" : "Network",
         "relevance" : "<p>Users who are day trading rather than focusing on their actual jobs are a risk in many ways to organizations. At a base level, it indicates that the employee is not focused on their job, which is typically an HR issue. Some Splunk customers have discussed this detection to detect flight risks. Some organizations believe employees who do day trading have generally questionable judgment and shouldn't have access to high value resources, though this is typically reserved only for very sensitive and risk adverse organizations.</p>",
         "knownFP" : "<p>This search is beta -- refer to <i>How to Implement</i> for details.</p>",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "Potential Day Trading",
         "howToImplement" : "<p>Honesty first: this particular rule has had no testing in real world scenarios and should be considered very beta-quality. Ultimately we are trying to infer that a user is exercising day trading from their proxy logs with categorization, which is very tricky. Really what this detection looks for is \"sustained heavy access to websites that are associated with stock trading.\" In most organizations, many users will periodically trade stocks. Some users may even leave a stock website up all day (or leverage widgets that track stock access). The goal is to set the bar high enough that anyone who triggers this particular rule is spending lots of time trading, with traffic to a number of different sites.</p><p>To build the rule, we looked at an organization that did not have any known day trading behavior -- we looked for users who had large amount of trading-related activities, and looked at what a heavy versus light hour was, to try to determine what it would look like when a user was focused on this. However, because we don't have a few bad users to make sure we would detect the right or wrong things, we can't say with confidence that we have exactly the right patterns. That said, this should be a good foundation. If you have the opportunity to tune this in your organization and can offer some real-world experiences, please provide feedback!</p><p>There are three thresholds in this particular search.<ol><li>In the first, we look for connections that last longer than 60 seconds. Most web servers that expect return traffic will keep connections open for prolonged periods of time to improve performance and reduce utilization on their load balancers. In testing, this seems to filter out some advertising.</li><li>For the second filter, we look in a single hour for where there are at least 30 different connections. Thirty different connections lasting longer than a minute indicates a very heavy amount of activity in that hour.</li><li>Finally we count how many hours have that amount of activity over the last week (specifically, looking for at least 20 hours of heavy activity).</li></ol></p><p>Again, we would love to get feedback on the viability of this rule based on real-world experience.</p>",
         "operationalize" : "<p>Because this search is beta, tread carefully. Your first action should be to inspect the sites that the user was browsing to, to see if they do in fact resemble stock trading activities. If it does, most orgs will pass to HR as desired to deal with it, or just combine it with other activities to indicate a flight risk user. Your final action should be to tell us (dveuve@splunk.com) whether this was a false positive or not, so that we can improve our detections.</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of proxy logs.</p>",
         "released" : "2.2.0",
         "category" : "Insider Threat"
      },
      "sser_ransomware_note_files" : {
         "similarUseCases" : [
            "detection_common_ransomware_notes"
         ],
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Ransomware Notes - Demo",
         "alertvolume" : "Low",
         "examples" : [
            {
               "name" : "Ransomware Notes - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Ransomware Notes - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "mitre_tactic" : "TA0002",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "released" : "1.0.0",
         "category" : "Endpoint Compromise",
         "operationalize" : "When this search fires, you will want to start your incident response process for dealing with a ransomware infection.  You should check for recent backups for the systems effected by the infection.",
         "help" : "Most ransomware leaves a note on the endpoint containing directions for the victim to pay a ransom. This use case looks for these note files.",
         "howToImplement" : "This use case requires Sysmon to be installed on the endpoints you wish to monitor and the Sysmon add-on installed on your forwarders and search heads. The search uses the ransomware_notes.csv lookup file, which contains the names of common ransomware note files.",
         "includeSSE" : "Yes",
         "name" : "Ransomware Note Files",
         "domain" : "Endpoint",
         "knownFP" : "None at the moment",
         "mitre" : "Execution",
         "hasSearch" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "<p>Most ransomware leaves a note on the endpoint containing directions for the victim to pay a ransom. This use case looks for these note files.</p><p><b>Alert Volume:</b> Low</p>",
         "mitre_technique" : "|T1204",
         "SPLEase" : "Basic"
      },
      "anomalous_new_listening_port" : {
         "searchKeywords" : "",
         "hasSearch" : "No",
         "SPLEase" : "Advanced",
         "search_name" : "Endpoint - Anomalous New Listening Port - Rule",
         "mitre_technique" : "|T1065|T1043",
         "description" : "Alerts a series of hosts begin listening on a new port within 24 hours. This may be an indication that the devices have been compromised or have had new (and potentially vulnerable) software installed.",
         "help" : "Help not needed -- ES Use Case",
         "category" : "Endpoint Compromise|Unauthorized Software|Lateral Movement",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Anomalous New Listening Port",
         "app" : "Splunk_App_for_Enterprise_Security",
         "data_source_categories" : "DS009EndPointIntel-ET06ListeningPorts",
         "mitre_tactic" : "|TA0011",
         "journey" : "Stage_4",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other"
      },
      "detection_remote_wmi_process_instantiation" : {
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "story" : "Suspicious WMI Use",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "journey" : "Stage_3",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "SPLEase" : "None",
         "search_name" : "ESCU - Remote Process Instantiation via WMI - Rule",
         "mitre_technique" : "T1047",
         "description" : "This search looks for wmic.exe being launched with parameters to spawn a process on a remote system.",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "mitre" : "Execution",
         "domain" : "Endpoint",
         "name" : "Remote Process Instantiation via WMI",
         "includeSSE" : "Yes",
         "help" : "Attackers are increasingly abusing native Windows utilities such as wmic.exe as a means to \"live off the land\", and avoid introducing new executables to the target system. In this search, we are looking for instances of wmic.exe being run with various parameters that are not typically used by administrators.",
         "category" : "Lateral Movement",
         "released" : "2.0.0"
      },
      "blacklisted_ip_address" : {
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "usecase" : "Advanced Threat Detection",
         "icon" : "UBA_Use_Case.png",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "app" : "Splunk_User_Behavior_Analytics",
         "mitre_tactic" : "|TA0011|TA0010",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "journey" : "Stage_4",
         "mitre" : "",
         "domain" : "Other",
         "includeSSE" : "Yes",
         "name" : "Blacklisted IP Address",
         "help" : "Help not needed -- UBA Use Case",
         "category" : "Endpoint Compromise|Threat Intelligence",
         "released" : "2.0.0",
         "mitre_technique" : "|T1094|T1095|T1071|T1048|T1041",
         "description" : "Generates anomalies for traffic that goes to Blacklisted IPs",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No"
      },
      "UC0005" : {
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Compliance",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Any Host Logs",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Unauthorized Software|Compliance|Endpoint Compromise",
         "released" : "2.0.0",
         "domain" : "Endpoint",
         "mitre" : "",
         "name" : "System modification to insecure state",
         "includeSSE" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Authorized, or unauthorized users may attempt to modify existing hardened configuration policies, or disable monitoring tools."
      },
      "detection_account_harvesting" : {
         "usecase" : "Other",
         "icon" : "ES_Use_Case.png",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Web Server",
         "highlight" : "No",
         "story" : "Web Fraud Detection",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS014WebServer-ET01Access",
         "mitre_tactic" : "",
         "journey" : "Stage_1",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "mitre_technique" : "T1136",
         "description" : "This search is used to identify the creation of multiple user accounts using the same email domain name.",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "mitre" : "",
         "incluseSSE" : "No",
         "domain" : "Threat",
         "name" : "Web Fraud - Account Harvesting",
         "includeSSE" : "Yes",
         "help" : "When a fraudster is setting the stage for a campaign, they will often create many user accounts on the website. This is a simple example of how to detect a many-account creation hosted on a Magento2 e-commerce platform, where the fraudster is using email addresses from a single email domain.",
         "category" : "Abuse|",
         "released" : "2.2.0"
      },
      "brute_force_access_behavior_detected_over_one_day" : {
         "usecase" : "Security Monitoring|Compliance",
         "icon" : "ES_Use_Case.png",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Authentication",
         "highlight" : "No",
         "app" : "Splunk_App_for_Enterprise_Security",
         "mitre_tactic" : "|TA0006",
         "data_source_categories" : "DS003Authentication-ET01Success|DS003Authentication-ET02Failure",
         "journey" : "Stage_2",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "similarUseCases" : [
            "basic_brute_force",
            "brute_force_access_behavior_detected",
            "excessive_failed_logins",
            "UC0099",
            "UC0108",
            "UC0109"
         ],
         "SPLEase" : "Accelerated",
         "search_name" : "Access - Brute Force Access Behavior Detected Over 1d - Rule",
         "mitre_technique" : "|T1110",
         "description" : "Detects an excessive number of failed login attempts, along with a successful attempt, over a one day period (this could indicate a successful brute force attack)",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Access",
         "includeSSE" : "Yes",
         "name" : "Brute Force Access Behavior Detected Over One Day",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Lateral Movement|IAM Analytics"
      },
      "flight_risk_user_browsing" : {
         "searchKeywords" : "",
         "killchain" : "",
         "hasSearch" : "Yes",
         "SPLEase" : "Medium",
         "mitre_technique" : "",
         "description" : "<p>This search implements several heuristics to look for indications that a user is a flight risk from Web Logs. Detect a user who may be leaving before they do.</p>",
         "operationalize" : "<p>There are several checks being run in this search. Most of these will require some tuning, and are often best to combine with another correlation searches that look for anomalous activities (e.g., data exfiltration). <ul><li><b>Browsing to Job Hunting Sites over Multiple Days</b>: while recruiters may spend their entire days on job hunting sites, most users will not heavily use job hunting sites.</li><li><b>Searching for \"Interview Questions\"</b>: when starting a job hunt, most people will refresh themselves on common interview questions, or look for similar resources. While this could indicate that someone is interviewing a candidate at your company, it can also be a crafty way to detect a flight risk.</li><li><b>Browsing to the Top Results for Interview Questions</b>: while most organizations won't be able to introspect Google searches because of their complete implementation of HTTPS with certificate pinning, you can see if users click on the top results for those queries.</li></ul></p><p>You should likely not look at the results of this search directly, but correlate it with other risky events via the Risk Framework in ES or the Threat Models in UBA.</p>",
         "help" : "<p>This example leverages the  search assistant. Our dataset is an anonymized collection of . For this analysis, we are .</p>",
         "howToImplement" : "<p>Initial implementation of this search is very straightforward -- just implement Common Information Model compliant proxy logs, and it will work. You should then evaluate how many false positives you get from the different components, and tune as appropriate. Focus your efforts on reducing event volume to a reasonable level, and then use the results to add into the ES Risk Framework or the UBA Threat Models.</p>",
         "category" : "Insider Threat",
         "released" : "2.2.0",
         "mitre" : "Exfiltration",
         "knownFP" : "<p>This search will innately generate false positives when a user is helping a friend who is job hunting, or interviewing a candidate. While you can attempt to build the correlation searches to tune out some of those false positives (e.g., alert on sustained job hunting browsing for a user who is not in HR and is not the hiring manager for any open positions), that can be practically impossible. It's more common to use a flight risk alert to correlate with other risky events, such as data exfil alerts coming from your DLP or your UEBA systems.</p>",
         "domain" : "Network",
         "relevance" : "<p>Detecting users who are about to leave, before they actually give notice, can provide you the opportunity to potentially fix the situation for an unhappy employee, but also can help you prevent the exfiltration of sensitive data (which usually happens before an employee actually gives notice). Look for the indications that an employee may be leaving, by checking proxy logs.</p>",
         "includeSSE" : "Yes",
         "name" : "Flight Risk Web Browsing",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS005WebProxyRequest-ET01RequestedWebAppAware",
         "mitre_tactic" : "TA0010",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Flight Risk Web Browsing - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Flight Risk Web Browsing - Live"
            }
         ],
         "journey" : "Stage_1",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Web Proxy",
         "highlight" : "Yes",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/flight_risk_user_browsing.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Flight Risk Web Browsing - Demo",
         "mitre_notes" : "Not an attacker technique",
         "alertvolume" : "Medium"
      },
      "unusual_ad_event" : {
         "description" : "Detects rare events in Microsoft Windows logs.",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "name" : "Unusual Windows Security Event",
         "includeSSE" : "Yes",
         "domain" : "Other",
         "mitre" : "",
         "category" : "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
         "released" : "2.0.0",
         "help" : "Help not needed -- UBA Use Case",
         "highlight" : "Yes",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk User Behavior Analytics",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance",
         "journey" : "Stage_4",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "",
         "app" : "Splunk_User_Behavior_Analytics",
         "alertvolume" : "Other",
         "mitre_notes" : "too broad for specific attack(s)",
         "dashboard" : "UBA_Use_Case"
      },
      "detection_first_time_seen_running_windows_service" : {
         "category" : "Malware",
         "released" : "2.2.0",
         "help" : "This search looks for a change in the status of a Windows service and extracts the name of the service and the action taken by the service. Then the cache file of previously seen Windows services is added to the search. At this point, the search takes two different paths: the first updates the cache file with the latest information and the second searches for services that have never before been seen. It returns the time, the Windows host name, and the service name.",
         "includeSSE" : "Yes",
         "name" : "First Time Seen Running Windows Service",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "hasSearch" : "No",
         "killchain" : "Installation|Actions on Objective",
         "searchKeywords" : "",
         "description" : "This search looks for the first time a Windows service is seen running in your environment.",
         "mitre_technique" : "T1050",
         "search_name" : "ESCU - First Time Seen Running Windows Service - Rule",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "journey" : "Stage_1",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "VendorSpecific-winsec",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Windows Service Abuse",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png"
      },
      "suspicious_account_lockout" : {
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "usecase" : "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance",
         "icon" : "UBA_Use_Case.png",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "app" : "Splunk_User_Behavior_Analytics",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "|TA0006",
         "journey" : "Stage_4",
         "mitre" : "",
         "domain" : "Other",
         "includeSSE" : "Yes",
         "name" : "Suspicious Account Lockout",
         "help" : "Help not needed -- UBA Use Case",
         "category" : "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
         "released" : "2.2.0",
         "mitre_technique" : "|T1110",
         "description" : "Looks for suspicious account lockouts that do not have any associations with password changes, password resets, password expiry within a specific time interval in and around the lockout period.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No"
      },
      "abnormally_high_number_of_http_method_events_by_src" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "Alerts when a host has an abnormally high number of HTTP requests by http method.",
         "SPLEase" : "Accelerated",
         "search_name" : "Web - Abnormally High Number of HTTP Method Events By Src - Rule",
         "mitre_technique" : "|T1190|T1110",
         "released" : "2.0.0",
         "category" : "Web Attack",
         "help" : "Help not needed -- ES Use Case",
         "name" : "Abnormally High Number of HTTP Method Events By Src",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Network",
         "data_source_categories" : "DS005WebProxyRequest-ET01Requested",
         "mitre_tactic" : "|TA0001|TA0006",
         "journey" : "Stage_2",
         "app" : "Splunk_App_for_Enterprise_Security",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Web Proxy",
         "highlight" : "No",
         "usecase" : "Application Security|Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "mitre_notes" : "",
         "dashboard" : "ES_Use_Case",
         "relatedUseCases" : [
            ""
         ],
         "alertvolume" : "Other"
      },
      "UC0002" : {
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance|Insider Threat",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_2",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Prohibited protocols such as IRC, FTP, or Gopher could indicate malicious activity on insecure systems located on the network. Consider Intra-network communication, and organization accepted communications from the Internet.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Network",
         "includeSSE" : "No",
         "name" : "Detection of prohibited protocol (application)",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Unauthorized Software|Data Exfiltration|Compliance",
         "released" : "2.0.0"
      },
      "detection_prohibited_allowed_through_fw" : {
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "datasource" : "Network Communication",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "usecase" : "Security Monitoring|Compliance",
         "icon" : "ES_Use_Case.png",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "TA0011|TA0010",
         "journey" : "Stage_4",
         "story" : "Ransomware",
         "app" : "Enterprise_Security_Content_Update",
         "gdprtext" : "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
         "name" : "Prohibited Network Traffic Allowed",
         "includeSSE" : "Yes",
         "mitre" : "Command and Control|Exfiltration",
         "domain" : "Network",
         "released" : "2.0.0",
         "category" : "Operations|GDPR",
         "help" : "The search looks for traffic marked 'is_prohibited' in the Enterprise Security lookup table 'interesting_ports_lookup', and then determines if any network devices have an associated 'allow' action on that traffic by checking the Network_Traffic data model.",
         "description" : "This search looks for network traffic defined by port and transport layer protocol in the Enterprise Security lookup table \"lookup_interesting_ports\", that is marked as prohibited, and has an associated 'allow' action in the Network_Traffic data model. This could be indicative of a misconfigured network device.",
         "SPLEase" : "None",
         "search_name" : "ESCU - Prohibited Network Traffic Allowed - Rule",
         "mitre_technique" : "T1043|T1048",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Delivery|Command and Control"
      },
      "prohibited_service_detected" : {
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "|TA0002|TA0003|TA0004",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "journey" : "Stage_4",
         "app" : "Splunk_App_for_Enterprise_Security",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "description" : "Alerts when a service in the prohibited service list is detected.",
         "SPLEase" : "Medium",
         "search_name" : "Endpoint - Prohibited Service Detection - Rule",
         "mitre_technique" : "|T1035|T1031|T1050",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "name" : "Prohibited Service Detected",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Endpoint",
         "category" : "Endpoint Compromise|Unauthorized Software",
         "released" : "2.0.0",
         "help" : "Help not needed -- ES Use Case"
      },
      "UC0050" : {
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Communication to an enclave network should only occur from another enclave network or sanitizing servers such as proxy or jump systems.",
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Compliance|Operations|Scanning",
         "mitre" : "",
         "domain" : "Network",
         "name" : "Communication to an enclave network from an non-enclave network",
         "includeSSE" : "No"
      },
      "detection_suspicious_reg_process" : {
         "name" : "Suspicious Reg.exe Process",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "help" : "This search looks for the execution of reg.exe with a parent process of cmd.exe. It then executes a subsearch looking for those cmd.exe processes with a parent that is not explorer.exe. It then joins those two searches to make sure that the reg.exe process is a grandchild of the non explorer.exe process. The search will return the number of such instances and the first and last time this activity has been seen on each endpoint and user.",
         "description" : "This search looks for reg.exe being launched from a command prompt not started by the user. When a user launches cmd.exe, the parent process is usually explorer.exe. This search filters out those instances.",
         "search_name" : "ESCU - Suspicious Reg.exe Process - Rule",
         "mitre_technique" : "T1112|T1059",
         "SPLEase" : "None",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0005|TA0002",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Disabling Security Tools"
      },
      "suspicious_box_usage" : {
         "description" : "Looks for combinations of actions performed by a Box user or against a Box resource that are suspicious.",
         "mitre_technique" : "|T1011|T1102|TA0010",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "dropbox google drive",
         "includeSSE" : "Yes",
         "name" : "Suspicious Box Usage",
         "domain" : "Other",
         "mitre" : "",
         "released" : "2.2.0",
         "category" : "Endpoint Compromise|Threat Intelligence",
         "help" : "Help not needed -- UBA Use Case",
         "highlight" : "No",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Vendor-Specific Data",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0010|TA0005",
         "data_source_categories" : "VendorSpecific-Box",
         "app" : "Splunk_User_Behavior_Analytics",
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case"
      },
      "showcase_many_hosts" : {
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Authentication|Vendor-Specific Data",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Unique Hosts Logged Into Per Day - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Unique Hosts Logged Into Per Day - Live"
            },
            {
               "name" : "Unique Hosts Logged Into Per Day - Accelerated",
               "label" : "Accelerated with Data Models"
            }
         ],
         "journey" : "Stage_1",
         "mitre_tactic" : "TA0008",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-winsec",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Low",
         "similarUseCases" : [
            "showcase_increase_in_interactively_logged_on_users",
            "showcase_increase_interactive_logon"
         ],
         "relatedUseCases" : [
            "basic_brute_force",
            "Basic_Scanning",
            "detection_excessive_user_account_lockouts",
            "detection_excessive_lockouts_from_endpoint"
         ],
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Unique Hosts Logged Into Per Day - Demo",
         "description" : "<p>Find users who log into more hosts than they typically do.</p><p><b>Alert Volume:</b> Low</p>",
         "mitre_technique" : "|T1021",
         "SPLEase" : "Hard",
         "hasSearch" : "Yes",
         "killchain" : "Installation|Actions on Objective",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Increase in # of Hosts Logged into",
         "domain" : "Access",
         "mitre" : "Lateral Movement",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p> ",
         "released" : "1.0.0",
         "category" : "Lateral Movement",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the account name associated with the suspicious domain. Establish the time the event occurred and from what system the login attempt occurred. Contact the user and system owners to determine if it is authorized, and if so document it as such and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted because compromised credentials may be used to gain access to a broad set of systems.</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of Windows Logon events (of all kinds). For this analysis, we are tracking the number of unique hosts the user has logged into per day 'dc(host) by user _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>"
      },
      "detection_powershell_reg_key_mod" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "High",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "journey" : "Stage_3",
         "story" : "Credential Dumping",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "released" : "2.2.0",
         "category" : "Adversary Tactics",
         "help" : "This search looks for the process reg.exe with the \"add\" parameter, which indicates the creation of a new value or modification of an existing value in the registry. In addition, it looks for parameters that specify the registry key to be added or modified, as well as the value of \"Unrestricted\". The appearance of \"ExecutionPolicy\" at the beginning of the search is there to optimize the search performance by first looking for that keyword, and then further searching through the matching events for further details.",
         "includeSSE" : "Yes",
         "name" : "Attempt To Set Default PowerShell Execution Policy To Unrestricted",
         "mitre" : "Execution",
         "domain" : "Endpoint",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Installation|Actions on Objective",
         "description" : "This search looks for the execution of reg.exe with parameters that indicate an attempt to set the default PowerShell execution policy on the system to \"Unrestricted\"",
         "mitre_technique" : "T1086|T1064",
         "search_name" : "ESCU - Attempt To Set Default PowerShell Execution Policy To Unrestricted - Rule"
      },
      "cleartext_password_at_rest_detected" : {
         "searchKeywords" : "",
         "hasSearch" : "No",
         "SPLEase" : "Medium",
         "search_name" : "Access - Cleartext Password At Rest - Rule",
         "mitre_technique" : "",
         "description" : "Detects cleartext passwords being stored at rest (such as in the Unix passwd file)",
         "help" : "Help not needed -- ES Use Case",
         "category" : "IAM Analytics",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Access",
         "includeSSE" : "Yes",
         "name" : "Cleartext Password At Rest Detected",
         "app" : "Splunk_App_for_Enterprise_Security",
         "mitre_tactic" : "",
         "data_source_categories" : "DS015ConfigurationManagement-ET01General",
         "journey" : "Stage_4",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Compliance",
         "datasource" : "Configuration Management",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "No",
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : "cyber hygiene",
         "alertvolume" : "Other"
      },
      "detection_remote_desktop_bruteforce" : {
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "datasource" : "Network Communication",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "data_source_categories" : "DS010NetworkCommunication-ET01TrafficAppAware",
         "mitre_tactic" : "TA0006|TA0008",
         "journey" : "Stage_1",
         "story" : "SamSam Ransomware",
         "app" : "Enterprise_Security_Content_Update",
         "includeSSE" : "Yes",
         "name" : "Remote Desktop Network Bruteforce",
         "mitre" : "Credential Access|Lateral Movement",
         "incluseSSE" : "No",
         "domain" : "Network",
         "category" : "Malware|",
         "released" : "2.2.0",
         "help" : "This search monitors for abnormal amounts of remote-desktop (RDP) traffic from a source to a destination that may be indicative of a brute-force attack. It does this by filtering out RDP traffic from the Network_Traffic.All_Traffic data model, using twice the standard deviation of all source-to-destination connections. If any tuple is within more than two standard deviations of all other usual RDP traffic flows, it is indicative of a brute-force attack.",
         "description" : "This search looks for RDP application network traffic and filters any source/destination pair generating more than twice the standard deviation of the average traffic.",
         "mitre_technique" : "T1076|T1110",
         "hasSearch" : "No",
         "killchain" : "Reconnaissance|Delivery"
      },
      "sser_ransomware_vulnerabilities" : {
         "SPLEase" : "Basic",
         "mitre_technique" : "",
         "description" : "<p>This use case queries your Vulnerability Management logs from solutions like Nessus in order to identify the hosts in your environment that might be vulnerable to ransomware.</p><p><b>Alert Volume:</b> Low</p>",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "mitre" : "Privilege Escalation|Lateral Movement",
         "knownFP" : "None at the moment",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Ransomware Vulnerabilities",
         "operationalize" : "When this search fires, you will want to verify that the patches for these vulnerabilities have not been applied yet.  If they have not been applied, then you should start your update process to remove these vulnerabilities from your environment.",
         "howToImplement" : "Index data from your vulnerability management system to search for or alert on systems with vulnerabilities that ransomware families often exploit. In this example, we use Nessus data with the Splunk Add-on for Tenable.",
         "help" : "This use case queries your Vulnerability Management logs from solutions like Nessus in order to identify the hosts in your environment that might be vulnerable to ransomware.",
         "category" : "Vulnerability",
         "released" : "1.0.0",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vulnerability Detection",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "",
         "data_source_categories" : "DS018VulnerabilityDetection-ET01SigDetected",
         "journey" : "Stage_4",
         "examples" : [
            {
               "name" : "Vulnerabilities Exploited by Ransomwares - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Vulnerabilities Exploited by Ransomwares - Live",
               "label" : "Live Data"
            }
         ],
         "alertvolume" : "Low",
         "mitre_notes" : "Cyber hygiene monitoring",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Vulnerabilities Exploited by Ransomwares - Demo",
         "relatedUseCases" : [
            ""
         ]
      },
      "detection_password_sharing" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "story" : "Web Fraud Detection",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS014WebServer-ET01Access",
         "mitre_tactic" : "|TA0001",
         "journey" : "Stage_1",
         "usecase" : "Other",
         "icon" : "ES_Use_Case.png",
         "datasource" : "Web Server",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "help" : "A common password across user accounts generally indicates that the users are choosing poor passwords or that a fraudster has a common password across multiple accounts embedded within a script. The search will extract the username and password information from the form_data field, then calculate the number and values for usernames that have the same passwords. Finally, it outputs the values where the unique usernames sharing passwords are greater than 5",
         "category" : "Abuse|",
         "released" : "2.2.0",
         "incluseSSE" : "No",
         "mitre" : "",
         "domain" : "Threat",
         "includeSSE" : "Yes",
         "name" : "Web Fraud - Password Sharing Across Accounts",
         "killchain" : "",
         "hasSearch" : "No",
         "mitre_technique" : "|T1078",
         "description" : "This search is used to identify user accounts that share a common password."
      },
      "UC0114" : {
         "SPLEase" : "Basic",
         "released" : "2.0.0",
         "category" : "GDPR|Operations",
         "operationalize" : "When a new host connects to an in-scope GDPR system, check to make sure it is documented.",
         "howToImplement" : "First, use your data mapping results to build a lookup that associates systems to their GDPR category. This search should work out of the box with Palo Alto Networks firewalls, and with any other device that uses the Splunk common information model. Just make sure you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!)",
         "name" : "New Connection to In-Scope Device",
         "relevance" : "In addition to the general security benefits, this detection will help the data privacy officer of an organization in their GDPR requirements to detect if any new applications or service providers have been connected to push or pull personal data without the proper documentation. This helps to trigger the update of the documentation and engage the DPO, enabling continuous monitoring to detect unauthorized and undocumented new applications that do not follow corporate processes.",
         "knownFP" : "No known false positives at this time.",
         "mitre" : "",
         "examples" : [
            {
               "name" : "New Connection GDPR - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "New Connection GDPR - Live"
            }
         ],
         "datasource" : "Network Communication",
         "icon" : "Core_Use_Case.png",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_new_connection.png",
         "alertvolume" : "Low",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "description" : "Alert Data Protection Officers to new systems that become involved in processing GDPR-scoped data via network communication logs, so DPOs can ensure the systems are authorized and documented.",
         "mitre_technique" : "",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Firewall logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Firewalls or the Common Information Model.",
         "includeSSE" : "Yes",
         "gdprtext" : "<h4>Problem:</h4><p>Data Protection Officers need to be alerted when new systems become involved in processing personal data under the scope of the GDPR, in order to ensure the systems are authorized and processing is properly documented.</p><h4>Impact:</h4><p>In addition to general security benefits, this detection will help inform the data privacy officer whether any new connections have been established to applications or service providers. For these connections, pushing or pulling personal data can be out of compliance. Under Article 30, organizations are required to maintain a record of processing activities, including the name and contact details of the controller, the purposes of the processing, description of the categories of data subjects and personal data processed. Additionally, they must maintain record of categories of recipients to whom the personal data have been or will be disclosed, including recipients in third countries or international. Detecting any new connected applications or service providers which might not be whitelisted or documented, can indicate a potential state of non-compliance state and the Data Privacy Officer will be required to follow up and document. This situation may not impact organizations who employ fewer than 250 persons and therefore may not have critical categories of personal data for processing.</p>",
         "domain" : "Access",
         "journey" : "Stage_4",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "usecase" : "Security Monitoring|Compliance",
         "gdpr" : "",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=New Connection GDPR - Demo",
         "mitre_notes" : "Does not seem to be ATT&CK technique related"
      },
      "detection_first_time_seen_cmd_line" : {
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0002|TA0003",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious Command-Line Executions",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "description" : "This search looks for command-line arguments that use a <code>/c</code> parameter to execute a command that has not previously been seen.",
         "search_name" : "ESCU - First time seen command line argument - Rule",
         "mitre_technique" : "T1064|T1059",
         "hasSearch" : "No",
         "killchain" : "Command and Control|Actions on Objective",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "First time seen command line argument",
         "domain" : "Endpoint",
         "mitre" : "Execution|Persistence",
         "released" : "2.2.0",
         "category" : "Adversary Tactics",
         "help" : "The subsearch returns all events where <code>cmd.exe</code> was used with a <code>/c</code> parameter in the command-line arguments to execute other commands/programs. It appends the historical data to those results in the lookup file. Next, it recalculates the <code>firstTime</code> and <code>lastTime</code> field for command-line execution and outputs this data to the lookup file to update the local cache. It returns only those events that have first been seen in the past one hour. This is combined with the main search to return the time, user, destination, process, parent process, and value of the command-line argument."
      },
      "detection_fsutil_deleting_journals" : {
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "The fsutil.exe application is a legitimate Windows utility used to perform tasks related to the file allocation table (FAT) and NTFS file systems. The update sequence number (USN) change journal provides a log of all changes made to the files on the disk. This search looks for fsutil.exe deleting the USN journal.",
         "search_name" : "ESCU - USN Journal Deletion - Rule",
         "mitre_technique" : "T1070",
         "SPLEase" : "None",
         "category" : "Ransomware",
         "released" : "2.0.0",
         "help" : "This search looks for the execution of fsutil.exe with command-line arguments to delete the USN journal. The search returns the count of the number of times it's seen this process execution with these arguments, the first and last time it's seen this behavior, the hosts it was executed on, and the user context under which it was executed.",
         "includeSSE" : "Yes",
         "name" : "USN Journal Deletion",
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0005",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Ransomware",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "detection_remote_registry_modifications" : {
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "This search monitors for remote modifications to registry keys.",
         "mitre_technique" : "",
         "search_name" : "ESCU - Remote Registry Key modifications - Rule",
         "released" : "2.2.0",
         "category" : "Adversary Tactics",
         "help" : "This search looks for modifications made to the Windows registry from remote locations using reg.exe&#151;a tool used to create/update/delete/modify Windows registry keys. It is accomplished through specifying the machine names in the registry path, by entering double backslashes, followed by a computer name. In this search, we look for registry changes where the registry path contains the name of a remote computer. The search returns the number of times the remote server has been accessed, the first and last times the activity occurred, the name of the modified registry path, the host on which the modification took place, and the name of the user that performed the modification.",
         "name" : "Remote Registry Key modifications",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion|Persistence|Lateral Movement",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "TA0005|TA0003|TA0008",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Windows Persistence Techniques",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "Basic_Scanning" : {
         "killchain" : "Reconnaissance",
         "SPLEase" : "Basic",
         "category" : "Scanning",
         "released" : "2.0.0",
         "operationalize" : "When scanning is occurring from an internal source, it's usually an indication that a host is infected and you need to start an incident response response to understand how and with what. When scanning occurs from outside sources, you probably don't care at all, because it's so difficult to do any meaningful response -- many people will add a filter to this search to exclude those (see Known False Positives).",
         "howToImplement" : "This search should work out of the box with Palo Alto Networks firewalls, and with any other device that uses the Splunk common information model. Just make sure you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!)",
         "name" : "Basic Scanning",
         "knownFP" : "The greatest source of false positives for this example are not really false positives. If you have external logs where hosts on the internet are port scanning your public infrastructure, it is definitely scanning, but it's not something you can actually do anything about. Many environments will add the following to their search strings: <pre>| search src_ip = 10.0.0.0/8 OR src_ip=172.16.0.0/12 OR src_ip=192.168.0.0/16 OR [your public ranges]</pre> You will also likely benefit from excluding any vulnerability scanners in your environment, as you pay them to scan the network.",
         "mitre" : "Discovery",
         "relevance" : "Scanning is a way for attackers to discover the attack surface of your organization (effectively, perform discovery), so they can prepare for an attack, or prepare for the next phase of an attack. It should only ever happen from authorized sources (e.g., vulnerability scanners) internally, and if someone else is doing scanning, you should know about it!",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Basic Scanning - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Basic Scanning - Live"
            },
            {
               "name" : "Basic Scanning - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "datasource" : "Network Communication",
         "icon" : "Core_Use_Case.png",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/basic_scanning.png",
         "alertvolume" : "Low",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "description" : "Looks for hosts that reach out to more than 500 hosts, or more than 500 ports in a short period of time, indicating scanning.",
         "mitre_technique" : "|T1046|T1018",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Palo Alto Networks logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for PAN or the Common Information Model.",
         "includeSSE" : "Yes",
         "domain" : "Network",
         "mitre_tactic" : "TA0007",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "journey" : "Stage_1",
         "app" : "Splunk_Security_Essentials",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "usecase" : "Security Monitoring",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Basic Scanning - Demo",
         "similarUseCases" : [
            "showcase_network_dc_dest",
            "vulnerability_scanner_detected_by_events",
            "vulnerability_scanner_detected_by_targets"
         ],
         "relatedUseCases" : [
            "basic_brute_force",
            "detection_excessive_user_account_lockouts",
            "showcase_many_hosts",
            "detection_excessive_lockouts_from_endpoint"
         ]
      },
      "unusual_web_browser" : {
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "datasource" : "Web Proxy",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "app" : "Splunk_User_Behavior_Analytics",
         "mitre_tactic" : "|TA0011|TA0010",
         "data_source_categories" : "DS005WebProxyRequest-ET01Requested",
         "journey" : "Stage_4",
         "mitre" : "",
         "domain" : "Other",
         "name" : "Unusual Web Browser",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- UBA Use Case",
         "category" : "Endpoint Compromise|Unauthorized Software",
         "released" : "2.0.0",
         "mitre_technique" : "|T1071|T1041",
         "description" : "Detects rare events for user agent string, device, and username in outbound HTTP data.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No"
      },
      "sser_windows_event_log_clearing_events" : {
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/win_event_clearing.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Windows Event Log Clearing Events - Demo",
         "similarUseCases" : [
            "detection_suspicious_wevtutil_usage",
            "detection_windows_event_log_cleared",
            "sser_detect_log_clearing_with_wevtutil"
         ],
         "relatedUseCases" : [
            "showcase_new_local_admin_account",
            "UC0006"
         ],
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0005",
         "examples" : [
            {
               "name" : "Windows Event Log Clearing Events - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Windows Event Log Clearing Events - Live"
            }
         ],
         "journey" : "Stage_1",
         "mitre" : "Defense Evasion",
         "knownFP" : "None at the moment",
         "domain" : "Endpoint",
         "name" : "Windows Event Log Clearing Events",
         "includeSSE" : "Yes",
         "operationalize" : "When this search fires, you will want to verify with the owner of the account responsible for clearing the Windows Logs that it was a legitimate action taken on their part. You will want to analyze the parent process to wevtutil and verify its activities.",
         "howToImplement" : "To run this search, you need to be logging Windows event logs from your Windows Systems.",
         "help" : "This use case looks for Windows event codes that indicate the Windows Audit Logs were tampered with.",
         "released" : "1.1.0",
         "category" : "Endpoint Compromise",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1070",
         "description" : "<p>This use case looks for Windows event codes that indicate the Windows Audit Logs were tampered with.</p><p><b>Alert Volume:</b> Low</p>",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes"
      },
      "showcase_first_seen_domain_controller" : {
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0008",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "First Connection to Domain Controller - Demo"
            },
            {
               "name" : "First Connection to Domain Controller - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_1",
         "alertvolume" : "Medium",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=First Connection to Domain Controller - Demo",
         "relatedUseCases" : [
            "New_Domain",
            "showcase_new_ad_domain"
         ],
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1021",
         "description" : "<p>A common indicator for lateral movement is when a user starts logging into new domain controllers.</p><p><b>Alert Volume:</b> Medium</p>",
         "searchKeywords" : "",
         "killchain" : "Installation",
         "hasSearch" : "Yes",
         "mitre" : "Lateral Movement",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
         "domain" : "Access",
         "relevance" : "Once an attacker gains access to a network either through a compromised asset or credentials, most will attempt to then move laterally within the network targeting critical infrastructure. As domain controllers provide the physical storage for the Active Directory Domain Services (AD DS) database, in addition to providing the services and data that allow enterprises to effectively manage endpoints (servers and workstations), users, and applications. If privileged access to a domain controller is obtained by a malicious user, that adversary can modify, corrupt, or destroy the AD DS database and, along with all of the systems and accounts that are managed by Active Directory. By monitoring both successful and unsuccessful authentication attempts organizations can identify anomalies such as time of day, frequency and other suspicious patters that may indicate compromised assets or credentials.",
         "includeSSE" : "Yes",
         "name" : "Authentication Against a New Domain Controller",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the user account accessing the specific domain controller. Contact the user and system owner about this action. If it is authorized, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine that lateral movement is not occurring.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of Windows domain controller logon events (Event ID 4776). For this analysis, we are effectively grouping by username and domain controller name, which will give us a row for each username+domaincontrollername combination. We check if the first time that has occurred was in the last day.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "released" : "1.0.0",
         "category" : "Lateral Movement"
      },
      "UC0075" : {
         "alertvolume" : "Other",
         "similarUseCases" : [
            "Basic_Malware_Outbreak",
            "Recurring_Infection_on_Host",
            "high_number_of_infected_hosts",
            "host_with_a_recurring_malware_infection",
            "host_with_multiple_infections",
            "UC0029",
            "UC0028",
            "UC0065"
         ],
         "dashboard" : "PS_Use_Case",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Malware Detonation",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "name" : "Network Malware Detection",
         "includeSSE" : "No",
         "domain" : "Network",
         "mitre" : "",
         "released" : "2.0.0",
         "category" : "Network Attack",
         "help" : "Help not needed -- PS Use Case",
         "description" : "Internal malware detection system such as FireEye devices reporting an attack.",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : ""
      },
      "detection_wmi_process_launch" : {
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0002",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious WMI Use",
         "includeSSE" : "Yes",
         "name" : "Process Execution via WMI",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "incluseSSE" : "No",
         "category" : "Adversary Tactics|",
         "released" : "2.2.0",
         "help" : "Attackers are increasingly abusing Windows Management Infrastructure (WMI) for stealth, persistence, lateral movement, or just to leverage its functionality. This search looks for processes launched via WMI, either remotely or locally, by looking for processes launched by WmiPrvSE.exe, which is the process WMI uses to execute new processes and commands.",
         "description" : "This search looks for processes launched via WMI.",
         "mitre_technique" : "T1047",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective"
      },
      "asset_ownership_unspecified" : {
         "domain" : "Identity",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "Asset Ownership Unspecified",
         "gdprtext" : "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "IAM Analytics|GDPR",
         "mitre_technique" : "",
         "search_name" : "Asset - Asset Ownership Unspecified - Rule",
         "SPLEase" : "Advanced",
         "description" : "Alerts when there are assets that define a specific priority and category but do not have an assigned owner.",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "mitre_notes" : "Cyber hygiene",
         "dashboard" : "ES_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Compliance",
         "highlight" : "No",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Configuration Management",
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "data_source_categories" : "DS015ConfigurationManagement-ET01General"
      },
      "Recurring_Infection_on_Host" : {
         "howToImplement" : "With Symantec Endpoint Protection logs onboard, these searches should work easily. If you have a different Anti-Virus product, they should be very easy to adapt to the field names and sourcetypes for that product -- particularly if you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!).",
         "operationalize" : "When repeated infections on the same host, you should strive to understand how the system is being reinfected. If you can see behavior such as proxy logs indicating suspicious activities, or suspicious emails going through the spam filter, that might be an indication that the user needs some education or that your malware solution needs to be strengthened. If you can't determine the reason for the reinfection, consider the possibility that the host still had an infection from the first occurrence and it just reactivated other functionality that AV caught, particularly if you didn't wipe the host the first time around. If you didn't, the time is now.",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "mitre" : "Initial Access|Execution",
         "knownFP" : "No known false positives at this time.",
         "domain" : "Endpoint",
         "relevance" : "If the same malware is detected repeatedly on a host, it could mean repeated attacks or an incomplete clean. Regardless, it is something that we should detect and remediate.",
         "name" : "Recurring Infection on Host",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Delivery",
         "hasSearch" : "Yes",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1189|T1192|T1193|T1204",
         "description" : "Looks for the same malware occurring multiple times on the same host.",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/recurring_infection_on_host.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Recurring Infection on Host - Demo",
         "similarUseCases" : [
            "Basic_Malware_Outbreak",
            "high_number_of_infected_hosts",
            "host_with_a_recurring_malware_infection",
            "host_with_multiple_infections",
            "UC0029",
            "UC0028",
            "UC0075",
            "UC0065"
         ],
         "alertvolume" : "Low",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS004EndPointAntiMalware-ET01SigDetected",
         "mitre_tactic" : "TA0001|TA0002",
         "examples" : [
            {
               "name" : "Recurring Infection on Host - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Recurring Infection on Host - Live"
            }
         ],
         "journey" : "Stage_1",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring",
         "datasource" : "Anti-Virus",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes"
      },
      "land_speed_privileged" : {
         "description" : "Detecting when the same account is logged into twice in a short period of time but from locations very far away, is key to finding account compromise or account credential sharing for your privileged accounts.",
         "mitre_technique" : "|T1078",
         "SPLEase" : "Advanced",
         "hasSearch" : "Yes",
         "killchain" : "",
         "searchKeywords" : "land speed superman",
         "name" : "Geographically Improbable Access Detected for Privileged Accounts",
         "includeSSE" : "Yes",
         "domain" : "Access",
         "relevance" : "When the same account is logged into in a short time period from distant locations, that can indicate one of two different problems. The first is account compromise -- threat actors who successfully acquire a user's credentials will usually log in from the same general region that the user lives in to reduce suspicion, but they will sometimes make mistakes (or simply be less diligent), and sometimes users will travel to different regions without the threat actor noticing. The other big scenario that this detection can find is intentional account sharing. Suppose an executive who can't be bothered to follow the standard procedure for granting her EA account access, and just shares her password. When that executive travels to distant areas but the EA stays at home, this search will alert.",
         "mitre" : "Credential Access",
         "knownFP" : "There are two big buckets for false positives. One is where the geoip is unreliable -- particularly outside of major economic areas (e.g., US, larger countries in Western Europe), the free MaxMind GeoIP that ships with Splunk Enterprise tends to be less accurate, causing some customers to add the paid version in their Splunk installations. The other big category is where IPs are centralized, such as someone in the US using a Korean VPN service, or using a networking service that originates nation-wide traffic from the same set of IPs (for example, years ago all traffic from a major US cellular carrier originated from the same IP space that was geolocated to Ohio).",
         "released" : "2.2.0",
         "category" : "Insider Threat|Account Sharing",
         "operationalize" : "When this fires, you should reach out to the user involved to see if they're aware of why their account was used in two places. You should also see what actions were taken, particularly if one of the locations was unusual. If the user is not aware of the reason, it's important to also ask if the user is aware of sharing their credentials with anyone else. You can also see what other activities occurred from the same remote IP addresses.",
         "help" : "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Salesforce.com logs, during which someone logs in from opposite ends of the earth. Our live search looks for the same activity across the standard index and sourcetype of SFDC data. For this use case, you can use any kind of data source, including VPN logs and others.",
         "howToImplement" : "First, use the \"Pull List of Privileged Users\" content to generate a list of privileged users (<a href=\"/app/Splunk_Security_Essentials/showcase_simple_search?ml_toolkit.dataset=Pull%20List%20of%20Privileged%20Users%20-%20Demo\" target=\"_blank\">link</a>). Then you just need a log source that provide external IP addresses. If you are using SFDC data, as we are in the live example, it will work easily. Otherwise, any data source that is compliant with the Splunk Common Information Model (so that it contains a src_ip field) should work automatically.",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Authentication|Vendor-Specific Data",
         "usecase" : "Insider Threat",
         "icon" : "Core_Use_Case.png",
         "journey" : "Stage_4",
         "examples" : [
            {
               "name" : "Land Speed Privileged - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Land Speed Privileged - Live",
               "label" : "Live Data"
            }
         ],
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-sfdc-elf|VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0004|TA0003",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Low",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Land Speed Privileged - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/land_speed_privileged.png"
      },
      "unusual_machine_access" : {
         "mitre_technique" : "|T1078",
         "description" : "Detects rare device accesses in Microsoft Windows logs.",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Other",
         "mitre" : "",
         "name" : "Unusual Machine Access",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.0.0",
         "category" : "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
         "usecase" : "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance",
         "icon" : "UBA_Use_Case.png",
         "highlight" : "Yes",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Authentication",
         "app" : "Splunk_User_Behavior_Analytics",
         "journey" : "Stage_6",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "mitre_tactic" : "|TA0001|TA0004",
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case"
      },
      "detection_tor_traffic" : {
         "SPLEase" : "None",
         "search_name" : "ESCU - TOR Traffic - Rule",
         "mitre_technique" : "T1043|T1188|T1079|T1041",
         "description" : "This search looks for network traffic identified as The Onion Router (TOR), a benign anonymity network which can be abused for a variety of nefarious purposes.",
         "searchKeywords" : "",
         "killchain" : "Command and Control",
         "hasSearch" : "No",
         "mitre" : "Command and Control|Exfiltration",
         "domain" : "Network",
         "name" : "TOR Traffic",
         "includeSSE" : "Yes",
         "help" : "The search leverages the Enterprise Security Network_Traffic data model to look for network traffic that has been identified as TOR and marked as 'allowed'.",
         "released" : "2.0.0",
         "category" : "Data Exfiltration",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Insider Threat|Security Monitoring",
         "datasource" : "Network Communication",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "story" : "Ransomware",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS010NetworkCommunication-ET01TrafficAppAware",
         "mitre_tactic" : "TA0011",
         "journey" : "Stage_2",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "similarUseCases" : [
            "sser_tor_traffic"
         ]
      },
      "detection_prohibited_apps_spawning_cmdprompt" : {
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious Command-Line Executions",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "search_name" : "ESCU - Detect Prohibited Applications Spawning cmd.exe - Rule",
         "mitre_technique" : "T1059",
         "SPLEase" : "None",
         "description" : "This search looks for executions of cmd.exe spawned by a process that is often abused by attackers and that does not typically launch cmd.exe.",
         "killchain" : "Exploitation",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "name" : "Detect Prohibited Applications Spawning cmd.exe",
         "includeSSE" : "Yes",
         "help" : "Obtaining access to the Command-Line Interface (CLI) is typically a primary attacker goal. Once an attacker has obtained the ability to execute code on a target system, they will often further manipulate the system via commands passed to the CLI. It is also unusual for many applications to spawn a command shell during normal operation, while it is often observed if an application has been compromised in some way. As such, it is often beneficial to look for cmd.exe being executed by processes that are often targeted for exploitation, or that would not spawn cmd.exe in any other circumstances. A lookup file is provided to easily modify the processes that are being watched for execution of cmd.exe.",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0"
      },
      "detection_samsam_payload_extensions" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "SamSam Ransomware",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "|TA0002",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "help" : "This search looks at file modifications across your hosts and creates notable events when it identifies files with extensions associated with the SamSam ransomware, including `.stubbin`, `.berkshire`, `.satoshi`, `.sophos`, or `.keyxml`. Files with these extensions have been observed in SamSam attacks consisting of payload data or keying material.",
         "released" : "2.2.0",
         "category" : "Malware|",
         "domain" : "Endpoint",
         "incluseSSE" : "No",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "File with Samsam Extension",
         "killchain" : "Installation",
         "hasSearch" : "No",
         "mitre_technique" : "|TA0002",
         "description" : "The search looks for file writes with extensions consistent with a SamSam ransomware attack."
      },
      "AWS_Cloud_Provisioning_Activity_from_Unusual_Country" : {
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0003|TA0004",
         "journey" : "Stage_3",
         "examples" : [
            {
               "name" : "AWS Cloud Provisioning Activity from Unusual Country - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "AWS Cloud Provisioning Activity from Unusual Country - Live",
               "label" : "Live Data"
            }
         ],
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_provisioning_unusual_country.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=AWS Cloud Provisioning Activity from Unusual Country - Demo",
         "relatedUseCases" : [
            "AWS_Instance_Created_by_Unusual_User",
            "AWS_New_API_Call_Per_User",
            "AWS_Unusual_Amount_of_Modifications_to_ACLs"
         ],
         "alertvolume" : "Medium",
         "searchKeywords" : "cloudtrail",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1078",
         "description" : "Looks for AWS Provisioning activities that occur from new IPs, using GeoIP to resolve the Country.",
         "operationalize" : "For organizations that have strict allowed countries for cloud orchestration, you may opt to use Splunk's Adaptive Response Actions to automatically disable an account that is doing provisioning from a new country. More commonly, the concern is account compromise so it is prudent to immediately call the user and find out if they intended to take those actions.",
         "help" : "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, as detailed in How to Implement.",
         "howToImplement" : "Assuming you use the ubiquitous AWS Add-on for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data. If your organization pays for the more accurate version of MaxMind's GeoIP Database (usually only common with organizations that have a strong footprint in small countries), consider adding that into Splunk to provide more accurate country resolution.",
         "released" : "2.0.0",
         "category" : "Account Compromise|IAM Analytics|Account Sharing|SaaS|Insider Threat",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>This use case will fire any time a new Country is seen in the GeoIP database for any kind of provisioning activity. If you typically do all provisioning from tools inside of your country, there should be few false positives. If you are located in countries where the free version of MaxMind GeoIP that ships by default with Splunk has weak resolution (particularly small countries in less economically powerful regions), this may be much less valuable to you.</p>",
         "mitre" : "Credential Access",
         "domain" : "Access",
         "relevance" : "The risk that this detection intends to reduce is the compromise of an AWS environment, where all of a sudden provisioning occurs in countries that have not been seen before (a very rudimentary baseline detection). Assuming that the user is not traveling, and that new orchestration tools are not being used (and admittedly, that the GeoIP is not wrong), this would suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential data leakage, data deletion, or cost run-up.",
         "name" : "AWS Cloud Provisioning Activity from Unusual Country",
         "includeSSE" : "Yes"
      },
      "UC0013" : {
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Detection of change for groups used to control access for sensitive, regulated, or critical infrastructure systems.",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Audit",
         "mitre" : "",
         "name" : "Monitor change for high value groups",
         "includeSSE" : "No",
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Insider Threat|Account Compromise",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring|Insider Threat",
         "highlight" : "No",
         "datasource" : "Audit Trail",
         "displayapp" : "Splunk Professional Services",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case"
      },
      "unauthorized_login_attempt" : {
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_1",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Unauthorized Login Attempt - Demo"
            },
            {
               "name" : "Unauthorized Login Attempt - Live",
               "label" : "Live Data"
            }
         ],
         "mitre_tactic" : "TA0006",
         "data_source_categories" : "DS003Authentication-ET02Failure|VendorSpecific-winsec",
         "usecase" : "Insider Threat",
         "icon" : "Core_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Authentication|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/unauthorized_login_attempt.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Unauthorized Login Attempt - Demo",
         "alertvolume" : "Low",
         "killchain" : "",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1110",
         "SPLEase" : "Medium",
         "description" : "<p>Most login failures are due to failed passwords. Login failure to sensitive systems where the users simply aren't authorized, though, can indicate malicious intent. Detect that.</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of Windows Security logs. For this analysis, we are looking specifically for the event logs that indicate a user authenticated successfully but was not authorized (i.e., correct username and password, but not permitted to log into this system). We're looking for any user with many of these per day, that can indicate attempted access to sensitive resources.</p>",
         "operationalize" : "<p>When this alert fires, investigative steps you could take are to evaluate whether this user has previously had access to the desired resources, look for recent job role changes, and look for recent changes around AD groups. In most organizations, the next escalation step would be to consult the owner of the desired resources, and/or the user's manager, to determine whether this behavior is intended. Keep an eye out for indications of malicious intent alongside potential account compromise.</p>",
         "howToImplement" : "<p>Implementation of this should be easy -- just ensure that you have data being ingested from the Universal Forwarder and the Splunk Technology Add-on present, and all will work automatically.</p>",
         "category" : "Insider Threat",
         "released" : "2.2.0",
         "relevance" : "<p>In most organizations, it's rare for a user to get an unauthorized message, beyond low risk scenarios such as proxy logs. When this is occurring for higher risk activities such as system logins, file share access, etc., and when it occurs persistently for a user, there's usually reason to investigate.</p>",
         "domain" : "Access",
         "knownFP" : "<p>The most likely scenario where this detection indicates a false positive is where the user's access has simply been messed up. There was an AD group change last night, and this user was accidentally removed from the \"dev_system_access\" security group. Beyond that, there's no standard pattern that would be expected for false positives.</p>",
         "mitre" : "Credential Access|Privilege Escalation",
         "includeSSE" : "Yes",
         "name" : "Detect Many Unauthorized Access Attempts"
      },
      "detection_wmi_script_execution" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious WMI Use",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0002",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "help" : "Attackers are increasingly abusing Windows Management Infrastructure for stealth, persistence, lateral movement, or just to leverage its functionality. This search looks for scripts launched via WMI, either remotely or locally, by looking for the execution of scrcons.exe, which is the scripting host used by WMI, similar to wscript or cscript.",
         "released" : "2.2.0",
         "category" : "Adversary Tactics|",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "incluseSSE" : "No",
         "includeSSE" : "Yes",
         "name" : "Script Execution via WMI",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "mitre_technique" : "T1047",
         "description" : "This search looks for scripts launched via WMI."
      },
      "hr_concerns_for_user" : {
         "includeSSE" : "Yes",
         "name" : "HR Complaints for User",
         "mitre" : "",
         "knownFP" : "<p>Not Applicable</p>",
         "domain" : "Audit",
         "relevance" : "<p>For high maturity Insider Threat organizations, accurately predicting the intent of users requires full visibility into the profile of those users. When there are low grade anomalous events for a user that you might not normally take seriously, recent workplace harassment citations should cause you to look closer. Similarly, if a user has filed a complaint about their boss, they're more likely to be disgruntled and those data exfil DLP alerts should be more closely investigated.</p>",
         "released" : "2.2.0",
         "category" : "Insider Threat",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is an anonymized collection of HR Events.</p>",
         "operationalize" : "<p>These complaints should not be directly acted on by InfoSec staff. They're only valuable when combined with other events (for example, someone threatening employees combined with unusual system access can indicate malicious intent).</p>",
         "howToImplement" : "<p>Implementation of this control is typically difficult not for technical reasons but for business reasons. For many organizations, HR events can be the most sensitive data inside of an organization, subject to universal regulation and requiring very limited and controlled access. For this reason, we don't typically see these log sources inside of Splunk, except in the most mature insider programs who have solved the simpler issues and made the case that to adequately protect the organization a limited number of users must have access to this data.</p><p>Because HR systems don't typically provide API access, when this is enabled is typically by configuring the HR system to send data out when an event occurs. The configuration can depend on the system you use, but most systems can BCC a mailbox on HR complaint confirmations, or send out an XML document.</p><p>When ingested into Splunk, at a bare minimum this data will be stored in a separate index to allow for strict access controls. Some teams have mandated a separate instance to ensure that Splunk administrators can't grant themselves access, though this is less common.</p>",
         "description" : "<p>Correlate HR Complaints with other event data to detect malicious insiders sooner.</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "",
         "alertvolume" : "High",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset= - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/hr_concerns_for_user.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Other",
         "highlight" : "No",
         "usecase" : "Insider Threat",
         "icon" : "Core_Use_Case.png",
         "mitre_tactic" : "",
         "examples" : [
            {
               "name" : " - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : " - Live",
               "label" : "Live Data"
            },
            {
               "label" : "Accelerated Data",
               "name" : " - Accelerated"
            }
         ],
         "journey" : "Stage_4",
         "app" : "Splunk_Security_Essentials"
      },
      "new_privileged_user" : {
         "hasSearch" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "Record when a user who hasn't taken privileged actions before suddenly starts.",
         "mitre_technique" : "|T1078|T1136",
         "SPLEase" : "Basic",
         "category" : "Insider Threat|Privilege Escalation",
         "released" : "2.2.0",
         "help" : "<p>This example leverages the Simple Search Assistant. Our demo dataset is a list of anonymized Windows events with the EventCode and the tags (which come from the technology add-ons).</p>",
         "operationalize" : "When this alert fires, you should first analyze whether this particular event is one that you would not expect the user to be able to do with their existing permissions. If that's the case, analyze the groups that the user is a member of, or see if there's a local account with the same username that might be the source of these rights. Evaluate whether this is allowable or not.",
         "howToImplement" : "<p>Implementation of this search depends on one key component -- privileged events. Generating the privileged events is relatively straightforward to get started with as many TAs will define privileged actions by default. You can start by searching out this information with just tag=privileged. Once you have defined privileged events, the First Time Search Assistant makes the rest of the detection very easy to implement.</p>",
         "name" : "New User Taking Privileged Actions",
         "includeSSE" : "Yes",
         "domain" : "Access",
         "relevance" : "Most larger organizations have strict controls to look for users enacting privileged actions. While most (maybe all!) users who suddenly start taking privileged actions will be legitimate, there is always a certain degree of risk associated with a user who suddenly begins exercising privileged rights they've long had, or uses new rights. Combine these events with other risky behavior to detect users who should be analyzed by your Insider or SOC team.",
         "knownFP" : "The #1 scenario when this alerts falsely is when the events themselves are incorrectly marked with tag=privileged. The Windows TA defines what eventtypes (basically, micro-searches that we evaluate every time you click the search button) is privileged in a file called tags.conf. You can always tune this set of tags, though it's probably easier to just add NOT EventCode=XXXX to block out the event IDs that you don't find valuable.",
         "mitre" : "Privilege Escalation",
         "examples" : [
            {
               "name" : "New User Taking Privileged Actions - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "New User Taking Privileged Actions - Live",
               "label" : "Live Data"
            },
            {
               "name" : "New User Taking Privileged Actions - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_2",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-winsec",
         "mitre_tactic" : "TA0004|TA0003",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Authentication|Vendor-Specific Data",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Compliance|Insider Threat",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New User Taking Privileged Actions - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/new_privileged_user.png",
         "alertvolume" : "High"
      },
      "detection_smb_traffic_spike" : {
         "story" : "Ransomware",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "|TA0010",
         "journey" : "Stage_2",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Network Communication",
         "highlight" : "Yes",
         "dashboard" : "ESCU_Use_Case",
         "similarUseCases" : [
            "sser_spike_in_smb_traffic"
         ],
         "alertvolume" : "Medium",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "search_name" : "ESCU - SMB Traffic Spike - Rule",
         "mitre_technique" : "T1043|TA0010",
         "description" : "This search looks for spikes in the number of Server Message Block (SMB) traffic connections.",
         "help" : "Server Message Block (SMB) traffic, a protocol used for Windows file sharing-activity, is often leveraged by attackers. One example of SMB abuse was the WannaCry ransomware, which leveraged a vulnerability in the SMB protocol to propagate to other systems. Attackers have also used SMB for lateral movement with a target environment and to test credentials against target systems. While SMB is highly prevalent in Windows environments, a spike in SMB traffic may still be indicative of this type of malicious activity. This search looks for a traffic spike in SMB traffic from a particular system. If such a spike is detected, you may want to investigate the source and analyze the cause of the abnormal traffic.",
         "category" : "Ransomware",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Network",
         "name" : "SMB Traffic Spike",
         "includeSSE" : "Yes"
      },
      "multiple_box_operations" : {
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "mitre_notes" : "This is too generic to map to a specific technique.",
         "highlight" : "No",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Vendor-Specific Data",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "data_source_categories" : "VendorSpecific-Box",
         "app" : "Splunk_User_Behavior_Analytics",
         "name" : "Multiple Box Operations",
         "includeSSE" : "Yes",
         "domain" : "Other",
         "mitre" : "",
         "released" : "2.2.0",
         "category" : "Endpoint Compromise|Threat Intelligence",
         "help" : "Help not needed -- UBA Use Case",
         "description" : "Detects outliers in the timeseries of Box events per user.",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "dropbox google drive"
      },
      "suspicious_domain_communication" : {
         "app" : "Splunk_User_Behavior_Analytics",
         "mitre_tactic" : "|TA0011",
         "data_source_categories" : "DS005WebProxyRequest-ET01Requested",
         "journey" : "Stage_6",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Insider Threat",
         "datasource" : "Web Proxy",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "dashboard" : "UBA_Use_Case",
         "mitre_notes" : "",
         "alertvolume" : "Other",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre_technique" : "|T1094|T1071|T1095",
         "description" : "Detects covert and malicious communication patterns in network traffic.",
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.0.0",
         "category" : "Command and Control|Endpoint Compromise|Data Exfiltration",
         "mitre" : "",
         "domain" : "Other",
         "includeSSE" : "Yes",
         "name" : "Suspicious Domain Communication"
      },
      "Unusual_AWS_Regions" : {
         "hasSearch" : "Yes",
         "searchKeywords" : "cloudtrail",
         "killchain" : "Actions on Objective",
         "description" : "Looks for activity in AWS Regions that have not been used before across the organization.",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1078",
         "released" : "2.1.0",
         "category" : "Account Compromise|SaaS",
         "operationalize" : "When this alert fires, your first instinct should be to validate whether this is intended activity. Reach out to the account owner or the user who spun up those instances to see if this is the result of the organization expanding into new areas. Also look to see any indications of known AWS malware, such as if hundreds of expensive instance types associated with ethereum mining are spun up.",
         "howToImplement" : "Assuming you use the ubiqutious AWS Add-on for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
         "help" : "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, as detailed in How to Implement.",
         "includeSSE" : "Yes",
         "name" : "Unusual AWS Regions",
         "mitre" : "",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>Beyond that disclaimer, there are no known false positives from this detection.</p>",
         "relevance" : "As a best practice, you should monitor activity across any and all AWS regions. Frequently, organizations focus only on the activity within the set of AWS regions they own because users/administrators look at those consoles more regularly. However, activity in other regions could be malicious activity (bitcoin mining, etc.), or even employees hiding activity where it is often overlooked. In any of these scenarios, changes like this should be monitored for and responded to.",
         "domain" : "Access",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "|TA0003|TA0004",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Unusual AWS Regions - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Unusual AWS Regions - Live"
            }
         ],
         "app" : "Splunk_Security_Essentials",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=Unusual AWS Regions - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/unusual_aws_regions.png",
         "alertvolume" : "Low"
      },
      "multiple_box_login_errors" : {
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "UBA_Use_Case.png",
         "data_source_categories" : "VendorSpecific-Box",
         "mitre_tactic" : "|TA0006",
         "journey" : "Stage_4",
         "app" : "Splunk_User_Behavior_Analytics",
         "name" : "Multiple Box Login Errors",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Other",
         "released" : "2.2.0",
         "category" : "Endpoint Compromise|Threat Intelligence",
         "help" : "Help not needed -- UBA Use Case",
         "description" : "Detects outliers in the timeseries of Box login failures per Box user.",
         "mitre_technique" : "|T1110",
         "hasSearch" : "No",
         "searchKeywords" : "dropbox google drive",
         "killchain" : "None"
      },
      "potential_gap_in_data" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "Detects gaps caused by the failure of the search head. If saved searches do not execute then there may be gaps in summary data.",
         "mitre_technique" : "",
         "search_name" : "Audit - Potential Gap in Data - Rule",
         "SPLEase" : "Medium",
         "released" : "2.0.0",
         "category" : "Operations",
         "help" : "Help not needed -- ES Use Case",
         "name" : "Potential Gap in Data",
         "includeSSE" : "Yes",
         "domain" : "Audit",
         "mitre" : "",
         "journey" : "Stage_1",
         "data_source_categories" : "VendorSpecific-SplunkInternal",
         "mitre_tactic" : "",
         "app" : "Splunk_App_for_Enterprise_Security",
         "highlight" : "No",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Vendor-Specific Data",
         "usecase" : "Security Monitoring|Compliance",
         "icon" : "ES_Use_Case.png",
         "mitre_notes" : "Cyber hygiene for internal Splunk monitoring",
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other"
      },
      "UC0104" : {
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "app" : "Splunk_Professional_Services",
         "datasource" : "IDS or IPS|Host-based IDS",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Host and Network IDS event categories, detect events with a category of 'backdoor' or 'trojan' followed by a signature categorized as 'post exploit' on a given host or network with a given time period.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "name" : "Chained Exploit Followed by Suspicious Events Detected",
         "includeSSE" : "No",
         "mitre" : "",
         "domain" : "Endpoint"
      },
      "sser_monitor_successful_windows_updates" : {
         "mitre_notes" : "Cyber hygiene monitoring",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Windows Successful Updates Install - Demo",
         "alertvolume" : "Very High",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "",
         "data_source_categories" : "DS019PatchManagement-Applied",
         "examples" : [
            {
               "name" : "Windows Successful Updates Install - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Windows Successful Updates Install - Live"
            }
         ],
         "journey" : "Stage_1",
         "usecase" : "Security Monitoring|Compliance",
         "icon" : "Core_Use_Case.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Patch Management",
         "highlight" : "No",
         "help" : "Ransomware often leverages operating system vulnerabilities to infect an endpoint or to spread to other systems. This use case verifies that Windows updates for specific vulnerabilities exploited by the WannaCry ransomware are installed correctly on your Windows endpoints.",
         "operationalize" : "This search will let you know when one of your systems has had an update successfully applied. It will help you understand how long it takes from when a patch is available to when it is applied in your environment.",
         "howToImplement" : "This use case requires a universal forwarder on the Windows endpoints you wish to monitor as well as the Windows add-on configured to send your logs to Splunk. You can also implement this use case using Windows event logs.",
         "category" : "Operations|GDPR",
         "released" : "1.0.0",
         "knownFP" : "None at the moment",
         "mitre" : "",
         "domain" : "Operations",
         "gdprtext" : "<h4>Problem:</h4><p>Similar to “High Number of Hosts Not Updating Malware Signatures,” “Detection of Uncleaned Malware on Endpoint,” and “In-Scope Device with Outdated Anti-Malware Found”, infections can occur or persist if the operating system is not updating with the latest security patches. Even a single host with outdated patch level can indicate a potential infection. </p><p>If that host is tagged under the GDPR category, then immediate remediation is required to address that non-compliant condition.</p><h4>Impact:</h4><p>Unpatched systems are at higher risk of infection than unpatched. For any environments/systems that are involved in processing personal data, this situation can be critical, and especially so in a GDPR context. Article 32 of the GDPR requires that organizations regularly test, assess and evaluate effectiveness of implemented technical and organizational security controls. In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58) -- therefore, showcase that patching was properly managed and continuously monitored becomes an important capability. If the organization faces a personal data breach and individuals are impacted, those individuals affected have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). </p><p>Resolution Path: Generally speaking, it is critical to keep all systems up to date. </p><p>Specific to GDPR, the data mapping exercise from the DPO can inform which systems are in-scope -- that is, those systems that are associated with the GDPR category. From there, identify the in-scope systems needing updates, pinpoint the root issue for updates not occurring, and remediate those hosts by configuring them or the environment appropriately, depending on what the root issue turns out to be. </p>",
         "name" : "Monitor Successful Windows Updates",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "SPLEase" : "Basic",
         "mitre_technique" : "",
         "description" : "<p>Malware often uses operating system vulnerabilities to infect an endpoint or to spread. This example verifies the Windows updates for specific vulnerabilities exploited by the WannaCry ransomware.</p><p><b>Alert Volume:</b> Very High</p>"
      },
      "UC0085" : {
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Web Server",
         "highlight" : "No",
         "usecase" : "Application Security",
         "icon" : "PS_Use_Case.png",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "app" : "Splunk_Professional_Services",
         "includeSSE" : "No",
         "name" : "WAF Logs Show Unexpected Source IP",
         "mitre" : "",
         "domain" : "Network",
         "category" : "Web Attack",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "description" : "Communication to any web application server without filtering by a network web application firewall indicates a security misconfiguration.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None"
      },
      "detection_usb_insertion" : {
         "alertvolume" : "High",
         "dashboard" : "ESCU_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Insider Threat",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response|DLP",
         "displayapp" : "Enterprise Security Content Update",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Data Protection",
         "journey" : "Stage_4",
         "data_source_categories" : "DS009EndPointIntel-ET05ObjectChangeRemovableStorage|DS016DataLossPrevention-ET01Violation",
         "mitre_tactic" : "TA0010|TA0001",
         "domain" : "Endpoint",
         "mitre" : "Exfiltration",
         "includeSSE" : "Yes",
         "name" : "Detect USB device insertion",
         "help" : "USB is a common attack vector for delivering or propagating malicious code, or the exfiltration of data. Your corporation may have a policy of not allowing removable media at all, or may only allow approved media to be used on specific hosts by specific users. By logging USB activity from Windows and other endpoints gathered using the Universal Forwarder, you can gain an understanding of what systems might be vulnerable to attack via removable media, or what users might need additional security training. This search is looking for event_id 4656 for failure and 4663 for successful USB read/write attempts from Windows Security Event logs, which is the event code generated when a files are read from and written to a removable storage device",
         "category" : "Data Exfiltration",
         "released" : "2.0.0",
         "search_name" : "ESCU - Detect USB device insertion - Rule",
         "mitre_technique" : "|T1052|T1091",
         "SPLEase" : "None",
         "description" : "The search is used to detect hosts that generate Windows Event ID 4663 for successful attempts to write to or read from a removable storage and Event ID 4656 for failures, which occurs when a USB drive is plugged in. In this scenario we are querying the Change_Analysis data model to look for Windows Event ID 4656 or 4663 where the priority of the affected host is marked as high in the ES Assets and Identity Framework.",
         "killchain" : "Installation|Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No"
      },
      "detection_aws_activity_from_non_approved_accounts" : {
         "description" : "This search looks for successful CloudTrail activity by user accounts that are not listed in the identity table or <code>aws_service_accounts.csv</code>. It returns event names and count, as well as the first and last time a specific user or service is detected, grouped by users.",
         "mitre_technique" : "",
         "search_name" : "ESCU - Detect AWS API Activities From Unapproved Accounts - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "includeSSE" : "Yes",
         "name" : "Detect AWS API Activities From Unapproved Accounts",
         "mitre" : "Credential Access|Execution",
         "domain" : "Access",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "help" : "In this search, we are looking for successful API calls via CloudTrail. We filter out events triggered by known users listed in the <code>identity_lookup_expanded</code> lookup file and the service accounts. Once filtered out, we output a table with the event names and count, as well as the first and last time a specific user or service is detected.",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Audit Trail|Vendor-Specific Data",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "TA0006|TA0002",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "journey" : "Stage_3",
         "story" : "AWS User Monitoring",
         "app" : "Enterprise_Security_Content_Update",
         "alertvolume" : "Medium",
         "mitre_notes" : "MITRE ATT&CK enterprise does not have good cataloging of cloud based activity. ",
         "dashboard" : "ESCU_Use_Case"
      },
      "detection_emailserver_high_volume_outbound_traffic_to_hosts" : {
         "mitre" : "Collection",
         "domain" : "Network",
         "includeSSE" : "Yes",
         "name" : "Email servers sending high volume traffic to hosts",
         "help" : "This search may look complex, but it's a neat representation of how statistics can help you understand your dataset to bubble up events that are not normal compared to its behavior. The search consists of three parts. The first part of the SPL fetches the data you want to work on. In this search, we calculate the sum of bytes sent and bytes_out from systems categorized as email_server to each host. We then calculate the average and standard deviation for the bytes sent to all the hosts combined and on a per-host basis. Then we set threshold values to deviation_threshold and minimum_data_samples using eval statements. The \"deviation_threshold\" field is a multiplying factor to control how much variation you're willing to tolerate. The \"minimum_data_samples\" field is the minimum number of connections of data samples required for the statistic to be valid.  We then check for byte transfers that are statistically significantly higher than normal. The search then gives IP address of the host, the time of the increased byte transfer, how much data was transferred, and the average amount of data transfer the email server normally sends to all hosts and to this specific host. Finally, it includes the number of standard deviations away the byte count was from these averages.",
         "released" : "2.2.0",
         "category" : "Adversary Tactics",
         "search_name" : "ESCU - Email servers sending high volume traffic to hosts - Rule",
         "mitre_technique" : "T1114|T1043",
         "description" : "This search looks for an increase of data transfers from your email server to your clients. This could be indicative of a malicious actor collecting data using your email server.",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Network Communication",
         "highlight" : "No",
         "story" : "Collection and Staging",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "TA0009",
         "journey" : "Stage_1"
      },
      "detection_add_to_untrust_cert_store" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low",
         "story" : "Disabling Security Tools",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "mitre_tactic" : "TA0005",
         "journey" : "Stage_3",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "help" : "Attackers will often attempt to disable security tools in order to evade detection. It is also possible for end users to attempt to disable anti-virus or other security tools to circumvent restrictions they encounter while trying to execute other programs. One way malware may accomplish this is by adding the legitimate certificate used to sign the security software to the untrusted certificate store. This will cause the system to no longer trust the software signed with this certificate and disallow it from executing. This search simply looks for the execution of <b>certutil.exe</b> with the parameters <code>-addcert</code> and <code>disallowed</code>, which add a certification to the \"untrusted\" certificate store.",
         "category" : "Adversary Tactics",
         "released" : "2.2.0",
         "mitre" : "Defense Evasion",
         "domain" : "Endpoint",
         "name" : "Attempt To Add Certificate To Untrusted Store",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Installation|Actions on Objective",
         "hasSearch" : "No",
         "mitre_technique" : "T1089",
         "search_name" : "ESCU - Attempt To Add Certificate To Untrusted Store - Rule",
         "description" : "Attempt to add a certificate to the untrusted certificate store"
      },
      "New_Domain" : {
         "description" : "Detects when users browse to domains never before seen in your organization.",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1041|T1048|T1071",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "includeSSE" : "Yes",
         "name" : "Connection to New Domain",
         "knownFP" : "This search will inherently be very noisy. As a percentage of total domains, in most organizations new domains are very small. If you sent all of these events to the analysts though, it would be overwhelming. As a result, there are no known false positives per say, but value of any given alert is so small that you want to treat these alerts differently from most correlation searches. These are mostly appropriate just for contextual data, or to correlate with other indicators.",
         "mitre" : "Exfiltration|Command and Control",
         "domain" : "Threat",
         "relevance" : "Savvy Threat Hunters always know when users browse to new domains. This can be relevant in a variety of scenario, but the primary is that when your system connects to a command and control server, or to a staging server containing malware, those are usually on unusual domains. If you believe that a host is infected, checking to see whether it hit new domains is a great indicator to check. For more information on this detection in general, check out the great blog post specifically about this detection by Splunk's own Andrew Dauria (<a href=\"https://www.splunk.com/blog/2018/01/17/finding-new-evil-detecting-new-domains-with-splunk.html\" target=\"_blank\">link</a>).",
         "released" : "2.1.0",
         "category" : "Command and Control|Data Exfiltration",
         "operationalize" : "These events are generally best to look at as contextual data for another event, for example uncleaned malware, new services, or unusual logins. The easiest way to accomplish this is to just record the events in a summary index, and then include searching that index as a part of your investigative actions. Enterprise Security customers can do this easily with the Risk Framework, which is effectively that -- create a risk indicator adaptive response action when saving this search, and it will then adjust the risk score of the assets involved, and show up in investigator workbench when you analyze an asset. Ultimately, to analyze the efficacy of any given alert here, we recommend looking up the domains in an Open Source Intelligence source like <a href=\"http://www.virustotal.com\" target=\"_blank\">VirusTotal</a>, <a href=\"https://www.threatcrowd.org/\" target=\"_blank\">ThreatCrowd</a>, etc.",
         "howToImplement" : "Implementing this search is relatively straightforward, as it expects Common Information Model compliant data. Just ingest your proxy data (or other web browsing visibility, such as stream:http or bro), and make sure there is a uri field. The only other step is to make sure that you have the URL Toolbox app installed, which allows us to parse out the domains. When scaling this search to greater volumes of data (or more frequent runs), leverage acceleration capabilities. ",
         "help" : "This example leverages the First Seen Assistant. Our example dataset is a collection of anonymized Proxy logs, where browses to a new website. Our live search looks for the same behavior, as detailed in How to Implement.",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Web Proxy",
         "highlight" : "Yes",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "mitre_tactic" : "TA0010|TA0011",
         "data_source_categories" : "DS005WebProxyRequest-ET01Requested",
         "examples" : [
            {
               "name" : "New Domain - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "New Domain - Live"
            },
            {
               "name" : "New Domain - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_2",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Very High",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Domain - Demo",
         "relatedUseCases" : [
            "showcase_first_seen_domain_controller",
            "showcase_new_ad_domain"
         ]
      },
      "UC0098" : {
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Web Proxy",
         "highlight" : "No",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Excessive proxy blocks can be a good indicator of a potential automated beacon or malware phone home. ",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Network",
         "name" : "Excessive Proxy Denies by Single Host",
         "includeSSE" : "No",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Endpoint Compromise|Insider Threat|Data Exfiltration",
         "released" : "2.0.0"
      },
      "user_login_local_credentials" : {
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is an anonymized collection of Windows Authentication logs. For this analysis, we are looking at what domains we expect to see in our authentication logs, and alert on anything unexpected.</p>",
         "operationalize" : "<p>Determine whether this user is authorized to log in with local credentials, and whether the configuration of the local account complies with company policies around password expiration, complexity, and etc. Verify whether this is a service account that should be added to the tuning whitelist moving forward.</p>",
         "howToImplement" : "<p>Implementing this search is as tricky as your environment is complex. For smaller shops with minimal complexity, run a Splunk search to look at the expected domains, and add them to your explicit whitelist: <pre>index=* daysago=7 source=win*security | top Account_Domain limit=0</pre>. In more complex environments (such as with many subsidiaries, or services routinely logging in with local accounts), you may wish to run this over a long period of time and create a lookup to tune out your noise. Create the lookup with <pre>index=* daysago=60 source=win*security | top Account_Domain limit=0 | fields Account_Domain | outputlookup allowable_account_domains.csv</pre>Then in your correlation search, access that lookup by replacing the existing list of account domains so that it reads:<pre>index=* source=win*security tag=authentication action=success Logon_Type=2 OR Logon_Type=10 OR Logon_Type=11 Logon Type NOT ( [ | inputlookup allowable_account_domains.csv | table Account_Domain ] )</pre></p>",
         "category" : "Insider Threat|Privilege Escalation|Endpoint Compromise|Account Compromise",
         "released" : "2.2.0",
         "knownFP" : "Many service accounts will log in with local domains as a matter of normal activities, and computer accounts may also show up. It's best to consider this alert as a contextual alert rather than a material alert that you would send to the SOC.",
         "mitre" : "Credential Access|Privilege Escalation",
         "domain" : "Endpoint",
         "relevance" : "<p>Local credentials enable a user (or attacker) to bypass some auditing controls, and persist access effectively. There are many different approaches to this problem, including logging the creation of local accounts.</p>",
         "includeSSE" : "Yes",
         "name" : "User Login with Local Credentials",
         "searchKeywords" : "",
         "killchain" : "",
         "hasSearch" : "Yes",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1078|T1098",
         "description" : "<p>Categorically, most interactive logins should use domain credentials. Detect when a new user logs on with local credentials that bypass most centralized logging and policy systems, but not Splunk!</p>",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/user_login_local_credentials.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Login With Local Credentials - Demo",
         "alertvolume" : "High",
         "relatedUseCase" : [
            "showcase_new_local_admin_account",
            "showcase_new_ad_domain"
         ],
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0004|TA0001|TA0006",
         "data_source_categories" : "VendorSpecific-winsec",
         "journey" : "Stage_1",
         "examples" : [
            {
               "name" : "Login With Local Credentials - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Login With Local Credentials - Live"
            }
         ],
         "usecase" : "Insider Threat|Security Monitoring",
         "icon" : "Core_Use_Case.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "Yes"
      },
      "UC0010" : {
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "app" : "Splunk_Professional_Services",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Identify users gaining access via an unapproved or unknown access control. This could indicate malicious activity or an internal control failure.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "category" : "Account Compromise|Compliance|Unauthorized Software",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "includeSSE" : "No",
         "name" : "Detect unauthorized use of remote access technologies",
         "mitre" : "",
         "domain" : "Access"
      },
      "detection_long_dns_text_response" : {
         "relatedUseCases" : [
            "sser_tor_traffic",
            "Large_Web_Upload",
            "showcase_huge_volume_dns_volume"
         ],
         "similarUseCases" : [
            "showcase_huge_volume_dns_volume",
            "showcase_huge_volume_dns_requests"
         ],
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "journey" : "Stage_3",
         "data_source_categories" : "DS002DNS-ET01Query",
         "mitre_tactic" : "TA0011|TA0010",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious DNS Traffic",
         "highlight" : "Yes",
         "datasource" : "DNS",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "category" : "Command and Control",
         "released" : "2.0.0",
         "help" : "This search uses the Network_Resolution data model and gathers all the answers to DNS queries for TXT records. The query then looks at the answer section and calculates the length of the answer. The search will then return information for those responses that exceed 100 characters in length.",
         "includeSSE" : "Yes",
         "name" : "Detect Long DNS TXT Record Response",
         "domain" : "Network",
         "mitre" : "Command and Control|Exfiltration",
         "hasSearch" : "No",
         "killchain" : "Command and Control",
         "searchKeywords" : "",
         "description" : "This search is used to detect attempts to use DNS tunneling, by calculating the length of responses to DNS TXT queries. Endpoints using DNS as a method of transmission for data exfiltration, command and control, or evasion of security controls can often be detected by noting unusually large volumes of DNS traffic.",
         "search_name" : "ESCU - Detect Long DNS TXT Record Response - Rule",
         "mitre_technique" : "T1043",
         "SPLEase" : "None"
      },
      "web_uploads_to_noncorporate_sites_by_users" : {
         "description" : "Alerts on high volume web uploads by a user to non-corporate domains.",
         "mitre_technique" : "|T1048|T1102",
         "search_name" : "Identity - Web Uploads to Non-corporate Domains - Rule",
         "SPLEase" : "Advanced",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Web Uploads to Non-corporate Sites by Users",
         "gdprtext" : "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
         "domain" : "Identity",
         "mitre" : "",
         "released" : "2.0.0",
         "category" : "Data Exfiltration|Insider Threat|GDPR",
         "help" : "Help not needed -- ES Use Case",
         "highlight" : "No",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Web Proxy",
         "usecase" : "Compliance|Insider Threat|Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_2",
         "mitre_tactic" : "|TA0010|TA0011|TA0005",
         "data_source_categories" : "DS005WebProxyRequest-ET01Requested",
         "app" : "Splunk_App_for_Enterprise_Security",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case"
      },
      "showcase_huge_volume_dns_volume" : {
         "includeSSE" : "Yes",
         "name" : "Sources Sending a High Volume of DNS Traffic",
         "knownFP" : "<p>False positives for this search should be rare for hosts with static IPs. In one testing environment, a curiously configured free-standing IOT webcam was the only host that hit, and was easy to filter out.</p><p>If you have a small number of DHCP hosts that routinely send a large volume of DNS (first off, why?) you may need to filter out those destinations to reduce noise.</p>",
         "mitre" : "Exfiltration|Command and Control",
         "relevance" : "DNS Exfiltration is a sophisticated, but increasingly common technique used by malware authors, as well as adversaries inside of a network to exfiltrate data. The technique is becoming popular due to organizations increased monitoring of data exfiltration, but limiting their monitoring to common protocols, yet failing to monitor DNS as an exfiltration vector. There are several methods to exfiltrate data via DNS, however one way to monitor activity is to gauge the total bytes transferred and looking for anomalies and deviations from normal traffic levels.",
         "domain" : "Network",
         "released" : "1.0.0",
         "category" : "Data Exfiltration",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the other systems that the alerting system is communicating with. Capture the time, applications, destination systems, ports, byte count and other pertinent information. Contact the system owner of this action. If systems being communicated to are internal, contact the owner(s) of those systems as well. If it is authorized, make a note that this is authorized and by whom. If not, additional investigation is warranted to determine if DNS is being used as a covert channel to exfiltrate data.</p>",
         "howToImplement" : "This search is intended to be an easy-to-implement one, as firewall data is usually the first to be Common Information Model compliant, and the fields are very easy to understand. To implement in your environment, first you should specify the correct index and sourcetype for your firewall data (we've included many different options in the search string, but it's not best practice to keep them). Then make sure that the standard fields (src_ip, dest_port, bytes_*) match. You might need to filter out particularly high volume sources (particularly: DNS servers). With that, you should be good to go.",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of firewall logs (with DNS app detection) from the last day or so. In it, we track per hour how much DNS traffic are sent per source IP (you should exclude actual DNS servers from this analysis). We then look to see if it is dramatically higher than the history for that source IP, but also dramatically higher than the organization overall, so that we can to some extent account for DHCP ranges. You may need to tune this for just servers, if this produces too much noise for your environment, or build two separate searches for user-subnet and server-subnet ranges, so that the organization-wide average can be separate.</p>",
         "description" : "<p>A common method of data exfiltration is to send out a huge volume (in bytes) of DNS or ping requests, embedding data into the payload. This is often not logged.</p><p><b>Alert Volume:</b> Low</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1048|T1071|T1041",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Command and Control|Actions on Objective",
         "alertvolume" : "Low",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Huge Volume of DNS Traffic - Demo",
         "similarUseCases" : [
            "showcase_huge_volume_dns_requests",
            "detection_long_dns_text_response"
         ],
         "relatedUseCases" : [
            "sser_tor_traffic",
            "Large_Web_Upload",
            "detection_long_dns_text_response"
         ],
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "usecase" : "Insider Threat",
         "icon" : "Core_Use_Case.png",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware",
         "mitre_tactic" : "TA0010|TA0011",
         "journey" : "Stage_1",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Huge Volume of DNS Traffic - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Huge Volume of DNS Traffic - Live"
            },
            {
               "label" : "Accelerated Data",
               "name" : "Huge Volume of DNS Traffic - Accelerated"
            }
         ],
         "app" : "Splunk_Security_Essentials"
      },
      "prohibited_process_detected" : {
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Endpoint Detection and Response",
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0004|TA0003",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "domain" : "Endpoint",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "Prohibited Process Detected",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise|Unauthorized Software",
         "mitre_technique" : "|T1050",
         "search_name" : "Endpoint - Prohibited Process Detection - Rule",
         "SPLEase" : "Medium",
         "description" : "Alerts when a service in the prohibited process list is detected.",
         "searchKeywords" : "",
         "hasSearch" : "No"
      },
      "detection_shim_database_installation" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0003",
         "journey" : "Stage_3",
         "story" : "Windows Persistence Techniques",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "This search looks for the execution of sdbinst.exe with command-line arguments of -q and -p.  The -q option performs a silent installation with no visible window, status, or warning information.  The -p option allows the shim database to contain patches.  It will return the count, the first time, and the last time these command-line arguments were seen on each endpoint and by each user.",
         "includeSSE" : "Yes",
         "name" : "Shim Database Installation With Suspicious Parameters",
         "mitre" : "Persistence",
         "domain" : "Endpoint",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "This search detects the process execution and arguments required to silently create a shim database.  The sdbinst.exe application is used to install shim database files (.sdb). A shim is a small library which transparently intercepts an API, changes the parameters passed, handles the operation itself, or redirects the operation elsewhere.",
         "SPLEase" : "None",
         "search_name" : "ESCU - Shim Database Installation With Suspicious Parameters - Rule",
         "mitre_technique" : "T1138"
      },
      "user_separation_events" : {
         "alertvolume" : "High",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset= - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/user_separation_events.png",
         "datasource" : "Other",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "examples" : [
            {
               "name" : " - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : " - Live"
            },
            {
               "name" : " - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "app" : "Splunk_Security_Essentials",
         "includeSSE" : "Yes",
         "name" : "User Experiencing Separation Event",
         "mitre" : "",
         "knownFP" : "<p>Not Applicable</p>",
         "relevance" : "<p>Most employees leaving jobs will take <b>some</b> data with them. Whether it's highly sensitive secrets, all the projects they worked on for their portfolio, or just their address list already synced to iCloud will vary based on their disposition and the nature of the separation. When a separation event occurs, look for behavior in the recent few weeks and months to see if there seems to be any major exfiltration concerns (or other anomalous activities) to detect malicious insiders.</p>",
         "domain" : "Audit",
         "category" : "Insider Threat",
         "released" : "2.2.0",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is an anonymized collection of HR Separation events.</p>",
         "operationalize" : "<p>When a user leaving the company decides to exfiltrate data, it will usually occur when they start looking for a job, or when they feel like they have found a job that will be high likelihood. It will most often occur at least several days, if not months, before they actually give notice. Similar behaviors can be see for involuntary separations, where an employee on a performance improvement plan may decide to exfiltrate data because they feel wronged, or they see the end coming.</p>",
         "howToImplement" : "<p>Because HR systems don't typically provide API access, when this is enabled is typically by configuring the HR system to send data out when an event occurs. The configuration can depend on the system you use, but most systems will send a confirmation email that can be BCC'd to a mailbox owned by the Security Team, or send out an XML document. For those organizations that opt to configure the email receipt, most teams will ingest that data into Splunk via the <a href=\"https://splunkbase.splunk.com/app/3200/\" target=\"_blank\">TA-mailclient app</a>. When ingested into Splunk, this data will be stored in a separate index to allow for strict access controls.</p>",
         "description" : "<p>When an HR Separation event (e.g., terminations) occurs, analyze past behavior to look for signs of malicious intent or data exfiltration.</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : ""
      },
      "sser_monitor_unsuccessful_backups" : {
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "",
         "data_source_categories" : "DS027EndpointBackup-ET01General",
         "journey" : "Stage_1",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Unsuccessful Backups - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Unsuccessful Backups - Live"
            }
         ],
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Backup",
         "highlight" : "No",
         "mitre_notes" : "Cyber hygiene monitoring",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Unsuccessful Backups - Demo",
         "alertvolume" : "Low",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "SPLEase" : "Basic",
         "mitre_technique" : "",
         "description" : "<p>With good backups, a ransomware attack goes from unrecoverable losses to a manageable nuisance. This shows how you can analyze failed backups.</p><p><b>Alert Volume:</b> Low</p>",
         "operationalize" : "When this search fires, you will to investigate why backups from these hosts have been failing.",
         "help" : "When you maintain sufficient backups outside your local network, you reduce the impact of a ransomware attack from unrecoverable losses to a manageable nuisance. Organizations must track their backup posture as a part of their overall corporate data availability and resiliency plan. This means knowing that routine backups are taking place and notifying the appropriate personnel when they are not. This use case helps Splunk customers manage and verify that data resiliency processes are running, specifically looking for indications of failed backups.",
         "howToImplement" : "Because there are so many different strategies for backups and data resiliency, this search is provided primarily as an example. In order to implement this use case, you need to index data from the backup logs on your endpoints, or from a central server responsible for performing the backups. In this case, we used netbackup as an example. You can modify this search according to your specific backup solution and strategy.",
         "category" : "Operations",
         "released" : "1.0.0",
         "mitre" : "",
         "knownFP" : "None at the moment",
         "domain" : "Operations",
         "name" : "Monitor Unsuccessful Backups",
         "includeSSE" : "Yes"
      },
      "Basic_Malware_Outbreak" : {
         "relevance" : "When the same malware occurs on multiple systems, you may be on the brink of a major incident as has been seen frequently with worms, ransomware, and broad phishing campaigns. Find out about these before they become a big deal!",
         "knownFP" : "No known false positives at this time.",
         "mitre" : "Initial Access|Execution|Privilege Escalation",
         "name" : "Basic Malware Outbreak",
         "howToImplement" : "With Symantec Endpoint Protection logs onboard, these searches should work easily. If you have a different Anti-Virus product, they should be very easy to adapt to the field names and sourcetypes for that product -- particularly if you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!).",
         "operationalize" : "When you see the same malware occurring on multiple systems, the most important thing to understand is how the malware is spreading, so that you can stop the spread. For example, WannaCry spreading via unpatched SMB vulnerabilities would require a network or patching response, a phishing campaign would require that you remove those messages from mailboxes and perform filtering, a drive by download response would require an entirely different set of actions. Additionally, perform all standard malware incident response actions, such as updating definitions, reimaging systems, etc.",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "SPLEase" : "Basic",
         "killchain" : "Delivery",
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/basic_malware_outbreak.png",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Anti-Virus",
         "examples" : [
            {
               "name" : "Basic Malware Outbreak - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Basic Malware Outbreak - Live",
               "label" : "Live Data"
            }
         ],
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
         "mitre_technique" : "|T1189|T1193|T1192|T1204|T1068",
         "description" : "Looks for the same malware occurring on multiple systems in a short period of time.",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "relatedUseCases" : [
            "showcase_first_usb",
            "unusual_usb_activity",
            "outbreak_detected",
            "UC0029"
         ],
         "similarUseCases" : [
            "Recurring_Infection_on_Host",
            "high_number_of_infected_hosts",
            "host_with_a_recurring_malware_infection",
            "host_with_multiple_infections",
            "UC0029",
            "UC0028",
            "UC0075",
            "UC0065"
         ],
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Basic Malware Outbreak - Demo",
         "usecase" : "Security Monitoring",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_1",
         "mitre_tactic" : "TA0001|TA0002|TA0004",
         "data_source_categories" : "DS004EndPointAntiMalware-ET01SigDetected"
      },
      "UC0074" : {
         "help" : "Help not needed -- PS Use Case",
         "category" : "Network Attack",
         "released" : "2.0.0",
         "domain" : "Network",
         "mitre" : "",
         "includeSSE" : "No",
         "name" : "Network Intrusion Internal Network",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "IDS/IPS detecting or blocking an attack based on a known signature.",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_2",
         "mitre_tactic" : "",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "highlight" : "No",
         "datasource" : "IDS or IPS",
         "displayapp" : "Splunk Professional Services"
      },
      "detection_psexec_accepteula" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "mitre_tactic" : "TA0002",
         "journey" : "Stage_3",
         "story" : "DHS Report TA18-074A",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "released" : "2.2.0",
         "category" : "Malware",
         "help" : "In this search, we are looking for the PsExec process with <code>accepteula</code> on the command line.",
         "name" : "Detect PsExec With accepteula Flag",
         "includeSSE" : "Yes",
         "mitre" : "Execution",
         "domain" : "Endpoint",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "This search looks for events where <code>PsExec.exe</code> is run with the <code>accepteula</code> flag in the command line. PsExec is a built-in Windows utility that enables you to execute processes on other systems. It is fully interactive for console applications. This tool is widely used for launching interactive command prompts on remote systems. Threat actors leverage this extensively for executing code on compromised systems. If an attacker is running PsExec for the first time, they will be prompted to accept the end-user license agreement (EULA), which can be passed as the argument <code>accepteula</code> within the command line.",
         "search_name" : "ESCU - Detect PsExec With accepteula Flag - Rule",
         "mitre_technique" : "T1059"
      },
      "UC0110" : {
         "mitre_technique" : "",
         "SPLEase" : "Medium",
         "description" : "GDPR requires an audit trail for all activities, which means we should be receiving events constantly. Find GDPR-tagged systems that are no longer reporting events but should be.",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "domain" : "Access",
         "relevance" : "GDPR requires that you collect the full audit trail of data processing activities and involved systems. If you're breached - Article 33 requires you to inform the authorities including details about the nature of the breach such as how many individuals have been affected. The same requirement is in Article 34 for when your organization has to identify which individuals are affected. If you do not have the logs and can't scope it down, you have to assume the worst case scenario: that all the data was affected. In addition: article 32 requires that you implement proper security controls and test their effectiveness. If you stop seeing logs for a host, then you will not be able to prove the status of the applied security controls on their machine, in case of damage claims (82) or privacy audits (58). Penultimately: if you lack host logs, you can't prove which records have been processed, such as proving that you delete a record according an individual's delete request (Article 17) or proving that you complied with a processing restriction requested by an individual (Article 18 and Article 21). Finally: if a host does not report it's event data – a processor can't prove that only authorized individuals have accessed the data.",
         "knownFP" : "The only known situation is where the host goes offline, but you are still tracking it as being required and in scope.",
         "mitre" : "",
         "name" : "Expected Host Not Reporting - in Category",
         "includeSSE" : "Yes",
         "gdprtext" : "<h4>Problem:</h4><p>Many compliance and regulatory frameworks contain clauses specifying requirements for central logging of event data, as well as retention periods and use of that data to assist in detecting data breaches and investigation and handling of threats. These regulations also specify that a mechanism exist to notify when critical systems stop forwarding event data. For example, tracking of “initialization, stopping, or pausing of audit logs”. This is directly related to the fact that commonly, the intent behind disruption to event data forwarding is malicious, e.g. an attempt to evade a preventive measure or to avoid detection. </p><h4>Impact:</h4><p>The GDPR requires that organizations collect the full audit trail of data processing activities of involved systems and applications. This can impact the organization via a wide array of GDPR articles. If breached, Article 33 requires organizations to inform the authorities, including details about the nature of the breach, such as how many individuals have been affected. The same requirement is in Article 34 for when organizations must identify which individuals are affected, in order to notify them if there is a high risk related to their individual data. If organizations do not store the requisite logs and are therefore not able to proper scope the impact, data privacy officers will need to assume the worst case scenario: all personal data that was stored or processed in the breached environment or accessible by the breached user was affected. In addition, Article 32 requires implementation of proper security controls, and for organizations to monitor, test, and demonstrate their effectiveness. If an organization experiences that logging stops for a particular host or set of hosts, then the organization will not be able to prove the status and effectiveness of the applied security controls on those systems, in the event of damage claims (Article 82) or privacy audits (Article 58). If the organization lacks host logs and corresponding application logs, they will not be able to prove which records have been processed, such as proving that a record was deleted according to an individual's delete request (Article 17) or proving compliance with a processing restriction requested by an individual (Article 18 and Article 21). If a host does not report event data, a processor cannot prove that only authorized individuals have accessed the data (Article 28).</p><h4>Resolution Path:</h4><p>Identify all GDPR-relevant IT assets from the data mapping exercise conducted by the Data Privacy Officer’s team -- that is, all IT assets that are relevant to the full audit trail of data processing activities. This includes not only data stores and repositories that house sensitive PD / PII, but also any technologies that are involved in the processing, storage, transmission, receipt, rendering, encrypt/decrypt, relaying, and any other function that involves handling that data in any capacity. Ensure that those assets are configured properly to report logging activity to an appropriate central repository. Monitor for changes in logging status, adjust for known outages, and prioritize incident response for any failures to report by hosts that are not scheduled for downtime.</p>",
         "operationalize" : "When this alert fires, the first task will be to see if the host is still alive. If it is, you will need to see if Splunk is still running, or if there are other interruptions to logging. Stopped logging services can indicate an intrusion, so keep an eye out for any indications of malicious behavior.",
         "howToImplement" : "First, use your data mapping results to build a lookup that associates systems to their GDPR category. All that is required for this search is to have a valid GDPR lookup, and then any logs in Splunk.",
         "help" : "This example leverages the Simple Search assistant. Our example dataset is the result of the live search (querying basic logs in Splunk), after a host goes offline.",
         "category" : "GDPR",
         "released" : "2.0.0",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Compliance",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_4",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Expected Host GDPR - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Expected Host GDPR - Live"
            }
         ],
         "mitre_tactic" : "",
         "data_source_categories" : "VendorSpecific-AnySplunk",
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_expected_host.png",
         "mitre_notes" : "GDPR related, not ATT&CK",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Expected Host GDPR - Demo"
      },
      "detection_spectre_meltdown_vulnerabilities" : {
         "datasource" : "Vulnerability Detection",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "",
         "data_source_categories" : "DS018VulnerabilityDetection-ET01SigDetected",
         "journey" : "Stage_4",
         "story" : "Spectre And Meltdown Vulnerabilities",
         "app" : "Enterprise_Security_Content_Update",
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case",
         "description" : "The search is used to detect systems that are still vulnerable to the Spectre and Meltdown vulnerabilities.",
         "mitre_technique" : "",
         "search_name" : "ESCU - Spectre and Meltdown Vulnerable Systems - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "",
         "name" : "Spectre and Meltdown Vulnerable Systems",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Endpoint",
         "released" : "2.2.0",
         "category" : "Vulnerability",
         "help" : "This search looks for the three CVEs associated with the Spectre and Meltdown vulnerabilities."
      },
      "showcase_huge_volume_dns_requests" : {
         "searchKeywords" : "",
         "killchain" : "Command and Control|Actions on Objective",
         "hasSearch" : "Yes",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1041|T1043|T1071",
         "description" : "<p>A common method for Data Exfiltration is to send out many DNS or Ping requests, embedding data into the payload. This is often not logged.</p><p><b>Alert Volume:</b> Low</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the other systems that the alerting system is communicating with. Capture the time, applications, destination systems, ports, byte count and other pertinent information. Contact the system owner of this action. If systems being communicated to are internal, contact the owner(s) of those systems as well. If it is authorized, document that this is authorized and by whom. If not, additional investigation is warranted to determine if DNS is being used as a covert channel to exfiltrate data.</p>",
         "howToImplement" : "This search is intended to be an easy-to-implement one, as firewall data is usually the first to be Common Information Model compliant, and the fields are very easy to understand. To implement in your environment, first you should specify the correct index and sourcetype for your firewall data (we've included many different options in the search string, but it's not best practice to keep them). Then make sure that the standard fields (src_ip, dest_port, bytes_*) match. You might need to filter out particularly high volume sources (particularly: DNS servers). With that, you should be good to go.",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of firewall logs (with DNS app detection) from the last day or so. In it, we track per hour how many DNS requests are sent per source IP (you should exclude actual DNS servers from this analysis). We then look to see if it is dramatically higher than the history for that source IP, but also dramatically higher than the organization overall, so that we can to some extent account for DHCP ranges. You may need to tune this for just servers, if this produces too much noise for your environment, or build two separate searches for user-subnet and server-subnet ranges, so that the organization-wide average can be separate.</p>",
         "released" : "1.0.0",
         "category" : "Data Exfiltration|Endpoint Compromise",
         "mitre" : "Exfiltration|Command and Control",
         "knownFP" : "<p>False positives for this search should be rare for hosts with static IPs. In one testing environment, a curiously configured free-standing IOT webcam was the only host that hit, and was easy to filter out.</p><p>If you have a small number of DHCP hosts that routinely send a large volume of DNS (first off, why?) you may need to filter out those destinations to reduce noise.</p>",
         "domain" : "Network",
         "relevance" : "Similar to monitoring high volumes of data being transferred via DNS, organizations should also monitor for higher volume of DNS transactions, as some advanced malware will not only transfer data via DNS, but also issue and respond to commands via DNS tunneling. It is important to note that you should monitor both volume and frequency of DNS requests, and not rely on detecting specific strings in the data transferred as the data is often encrypted in transit. To test your DNS tunneling detection capabilities you can use tools such as dnscat2 (https://github.com/iagox86/dnscat2).",
         "name" : "Sources Sending Many DNS Requests",
         "includeSSE" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware",
         "mitre_tactic" : "TA0010|TA0011",
         "examples" : [
            {
               "name" : "Huge Volume of DNS Requests - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Huge Volume of DNS Requests - Live"
            },
            {
               "label" : "Accelerated Data",
               "name" : "Huge Volume of DNS Requests - Accelerated"
            }
         ],
         "journey" : "Stage_1",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Huge Volume of DNS Requests - Demo",
         "similarUseCases" : [
            "showcase_huge_volume_dns_volume",
            "detection_long_dns_text_response"
         ],
         "alertvolume" : "Low"
      },
      "UC0036" : {
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "journey" : "Stage_2",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "highlight" : "No",
         "datasource" : "Authentication",
         "displayapp" : "Splunk Professional Services",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "released" : "2.0.0",
         "category" : "Account Compromise",
         "help" : "Help not needed -- PS Use Case",
         "includeSSE" : "No",
         "name" : "Compromised account access testing (Critical/Sensitive Resource)",
         "domain" : "Access",
         "mitre" : "",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Following a successful authentication, an attacker will attempt to determine what resources may be accessed without causing host intrusion or DLP technologies to detect activity. Commonly the attacker will enumerate and browse to shares, access email, access web applications, or connect to databases yet not perform any or minimal activity. Typically Critical and Sensitive systems (during routine use) would not log access denied events.",
         "mitre_technique" : "",
         "SPLEase" : "None"
      },
      "basic_brute_force" : {
         "mitre" : "Credential Access",
         "knownFP" : "The only known scenario where this search could generate false positives is if you have a single source (for example, a web app) that centralizes the authentication for many people. In that scenario, you might need to adjust thresholds for that source, or exclude it and build a separate similar search just using the logs from that host.",
         "relevance" : "Discovering real credentials is a key component for any attacker. While there are many approaches for doing that, a time honored way is to find weak passwords by just trying hundreds of common passwords. Particularly as most environments use Active Directory as their central storage respository for credentials, looking for brute force activity in Windows Security logs should be a component of any security strategy.",
         "domain" : "Access",
         "name" : "Basic Brute Force Detection",
         "includeSSE" : "Yes",
         "operationalize" : "When this search fires, the immediate concern is that the brute force search was successful. See if it is coming from a host that typically logs in with that account to make sure it is not just coincidental, and then reset the password for any compromised accounts and look for any other places where that username was used.",
         "help" : "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Windows Authentication logs, during which someone attempts a brute force against a series of usernames. Our live search looks for Windows Authentication activity across any index in the standard sourcetype.",
         "howToImplement" : "If you have followed the data onboarding guides in this app, this search will work immediately for you. You should generally specify the index where you are storing Windows Security logs (e.g., index=oswinsec), and if you use a mechanism other than the Splunk Universal Forwarder to onboard that data, you should verify the sourcetype and fields that are used. The rest is simple!",
         "category" : "Account Compromise|Scanning",
         "released" : "2.0.0",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1110",
         "description" : "Uses a simple threshold for Windows Security Logs to alert if there are a large number of failed logins, and at least one successful login from the same source.",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/basic_brute_force.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Basic Brute Force - Demo",
         "similarUseCases" : [
            "brute_force_access_behavior_detected",
            "brute_force_access_behavior_detected_over_one_day",
            "excessive_failed_logins",
            "UC0099",
            "UC0108",
            "UC0109"
         ],
         "relatedUseCases" : [
            "Basic_Scanning",
            "detection_excessive_user_account_lockouts",
            "showcase_many_hosts",
            "detection_excessive_lockouts_from_endpoint"
         ],
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0006",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Basic Brute Force - Demo"
            },
            {
               "name" : "Basic Brute Force - Live",
               "label" : "Live Data"
            },
            {
               "name" : "Basic Brute Force - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_1"
      },
      "unusual_geolocation_of_communication_destination" : {
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Insider Threat",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "app" : "Splunk_User_Behavior_Analytics",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "|TA0011|TA0010",
         "journey" : "Stage_4",
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "mitre_technique" : "|T1071|T1095|T1094|T1048|T1041",
         "description" : "Detects network events with rare destination IP geolocation.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Other",
         "name" : "Unusual Geolocation of Communication Destination",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- UBA Use Case",
         "category" : "Lateral Movement|Account Compromise|Data Exfiltration",
         "released" : "2.0.0"
      },
      "detection_batch_file_write_system32" : {
         "story" : "SamSam Ransomware",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "|TA0002",
         "journey" : "Stage_3",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low",
         "killchain" : "Delivery",
         "hasSearch" : "No",
         "mitre_technique" : "|T1064",
         "description" : "The search looks for a batch file (.bat) written to the Windows system directory tree.",
         "help" : "This search looks at file modifications across your hosts, as well as for evidence of batch files being written to paths that include \"system32.\" This activity is consistent with some SamSam attacks and is, in general, suspicious.",
         "released" : "2.2.0",
         "category" : "Malware|",
         "incluseSSE" : "No",
         "mitre" : "",
         "domain" : "Endpoint",
         "name" : "Batch File Write to System32",
         "includeSSE" : "Yes"
      },
      "detection_path_interception_program.exe" : {
         "category" : "Adversary Tactics",
         "released" : "2.2.0",
         "help" : "This search queries the Endpoint file-system data model node to list out all the values of destination machines, as well as the values of file hashes and file paths that have the file \"program.exe\" in the C: drive. Path interception occurs when an executable is placed in a specific path so that it is executed by an application instead of by the intended target. In this case, applications vulnerable to path interception (because of unquoted service paths with spaces in Windows registry) allow attackers to execute maliciously crafted program.exes.",
         "includeSSE" : "Yes",
         "name" : "Detect Path Interception By Creation Of program.exe",
         "domain" : "Endpoint",
         "mitre" : "Privilege Escalation|Persistence",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "The search is looking for the creation of program.exe in the C: drive.  The creation of this file in that location may be driven by a motive to perform path interception.",
         "mitre_technique" : "",
         "search_name" : "ESCU - Detect Path Interception By Creation Of program.exe - Rule",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "TA0004|TA0003",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Windows Persistence Techniques",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png"
      },
      "detection_ec2_instance_started_with_previously_unseen_instance_type" : {
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS Cryptomining",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "description" : "This search looks for EC2 instances being created with previously unseen instance types.",
         "mitre_technique" : "",
         "search_name" : "ESCU - EC2 Instance Started With Previously Unseen Instance Type - Rule",
         "hasSearch" : "No",
         "killchain" : "",
         "searchKeywords" : "",
         "name" : "EC2 Instance Started With Previously Unseen Instance Type",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "",
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS",
         "help" : "The subsearch returns the instance types of all successful EC2 instance launches within the last hour and then appends the historical data in the lookup file to those results.  It then recalculates the earliest seen time field for each instance type and returns only those instance types that has first been seen in the past hour.  This is combined with the main search to return the time, user, and instance id of those systems."
      },
      "Multiple_Infections_on_Host" : {
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1189|T1193|T1192|T1204",
         "description" : "Finds hosts that have logged multiple different infections in a short period of time.",
         "searchKeywords" : "",
         "killchain" : "Delivery",
         "hasSearch" : "Yes",
         "mitre" : "Initial Access|Execution",
         "knownFP" : "No known false positives.",
         "relevance" : "Viruses happen, but multiple viruses at once are a greater concern, as it could indicate an exploit kit that tries several techniques where some might succeed, or just a host with multiple unrelated viruses. Those hosts should be prioritized and investigated immediately to see what else might not have been caught.",
         "domain" : "Endpoint",
         "name" : "Multiple Infections on Host",
         "includeSSE" : "Yes",
         "howToImplement" : "With Symantec logs onboard, these searches should work easily. If you have a different Anti-Virus product, they should be very easy to adapt to the field names and sourcetypes for that product -- particularly if you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!).",
         "operationalize" : "When multiple infections occur to the same host, your response plan should be the same as any malware event, just with greater urgency.",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Anti-Virus",
         "highlight" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0001|TA0002",
         "data_source_categories" : "DS004EndPointAntiMalware-ET01SigDetected",
         "journey" : "Stage_1",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Multiple Infections on Host - Demo"
            },
            {
               "name" : "Multiple Infections on Host - Live",
               "label" : "Live Data"
            }
         ],
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/multiple_infections_on_host.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Multiple Infections on Host - Demo"
      },
      "UC0099" : {
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring|Application Security",
         "highlight" : "No",
         "datasource" : "Web Server",
         "displayapp" : "Splunk Professional Services",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "alertvolume" : "Other",
         "similarUseCases" : [
            "basic_brute_force",
            "brute_force_access_behavior_detected",
            "brute_force_access_behavior_detected_over_one_day",
            "excessive_failed_logins",
            "UC0108",
            "UC0109"
         ],
         "dashboard" : "PS_Use_Case",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Detect excessive number of http status messages indicating error (400/500 errors), followed by an http status of 200 by src and uri. Can be a high indicator of unauthorized access or attempt to execute malicious commands.",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Network",
         "mitre" : "",
         "includeSSE" : "No",
         "name" : "HTTP Brute Force Activity Detected",
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Web Attack|Scanning"
      },
      "detection_rare_executables_on_endpoint" : {
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0002",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Unusual Processes",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "hasSearch" : "No",
         "killchain" : "Installation|Command and Control|Actions on Objective",
         "searchKeywords" : "",
         "description" : "This search will return a table of rare processes, the names of the systems running them, and the users who initiated each process.",
         "mitre_technique" : "|TA0002",
         "search_name" : "ESCU - Detect Rare Executables - Rule",
         "SPLEase" : "None",
         "released" : "2.0.0",
         "category" : "Unauthorized Software",
         "help" : "This search first executes the subsearch and counts all of your processes to determine the 10 most rare (the limit set is 10). It then filters out whitelisted processes and outputs the first and last time a rare process was encountered, the destination where the process is running, the count of occurrences, and the users who initiated the processes.",
         "name" : "Detect Rare Executables",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Execution"
      },
      "substantial_increase_in_port_activity" : {
         "alertvolume" : "Other",
         "mitre_notes" : "",
         "dashboard" : "ES_Use_Case",
         "usecase" : "Insider Threat|Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Network Communication",
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_2",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "|TA0011",
         "domain" : "Network",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "Substantial Increase In Port Activity",
         "help" : "Help not needed -- ES Use Case",
         "category" : "Data Exfiltration",
         "released" : "2.0.0",
         "mitre_technique" : "|T1065",
         "search_name" : "Network - Substantial Increase in Port Activity (By Destination) - Rule",
         "SPLEase" : "Accelerated",
         "description" : "Alerts when a statistically significant increase in events on a given port is observed.",
         "searchKeywords" : "",
         "hasSearch" : "No"
      },
      "potential_webshell_activity" : {
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre_technique" : "|T1100",
         "description" : "Detects web shell activity by looking at accesses to internal Web servers (by external IPs only).",
         "help" : "Help not needed -- UBA Use Case",
         "category" : "Web Attack",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Other",
         "includeSSE" : "Yes",
         "name" : "Potential Webshell Activity",
         "app" : "Splunk_User_Behavior_Analytics",
         "data_source_categories" : "DS014WebServer-ET01Access",
         "mitre_tactic" : "|TA0003",
         "journey" : "Stage_4",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Application Security",
         "datasource" : "Web Server",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other"
      },
      "showcase_network_dc_dest" : {
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the other systems that the alerting system is communicating with. Capture the time, applications, destination systems, ports, byte count and other pertinent information. Contact the system owner and user if the logs have the appropriate fidelity of this action. If systems being communicated to are internal, contact the owner(s) of those systems as well. If it is authorized, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine why additional systems are being communicated with.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our demo dataset is an anonymized set of firewall logs. For this analysis, we are tracking the total number of unique destinations the source IP has reached out to per day 'dc(dest) by src _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average. Note that this use case is only reliable for servers -- users will move around too much due to DHCP and it won't be reliable. Look to a more advanced product, such as Splunk UBA.</p>",
         "released" : "1.0.0",
         "category" : "Scanning|Endpoint Compromise",
         "domain" : "Network",
         "relevance" : "The first phase of the Lockheed Martin Kill Chain is reconnaissance, which can include initial scanning of a target network to map out assets, as well as vulnerabilities for potential entry points using known exploits. It is important to note that this type of activity can happen both on the perimeter as well as inside of a network once an initial foothold has been made. Monitoring for this type of activity can help identify precursors to an attack as well as be an indicator that assets within an organization, or credentials have been compromised.",
         "mitre" : "Discovery",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information . If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p> ",
         "includeSSE" : "Yes",
         "name" : "Hosts Sending To More Destinations Than Normal",
         "killchain" : "Reconnaissance",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1018|T1046",
         "SPLEase" : "Basic",
         "description" : "<p>This will typically detect scanning activity, along with lateral movement activity.</p><p><b>Alert Volume:</b> Low</p>",
         "similarUseCases" : [
            "Basic_Scanning",
            "vulnerability_scanner_detected_by_events",
            "vulnerability_scanner_detected_by_targets"
         ],
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Distinct Hosts Communicated With Per Day - Demo",
         "alertvolume" : "Low",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "Distinct Hosts Communicated With Per Day - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Distinct Hosts Communicated With Per Day - Live",
               "label" : "Live Data"
            },
            {
               "label" : "Accelerated Data",
               "name" : "Distinct Hosts Communicated With Per Day - Accelerated"
            }
         ],
         "journey" : "Stage_1",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "TA0007",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "highlight" : "No",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Security Essentials"
      },
      "machine_generated_beacon" : {
         "mitre_tactic" : "|TA0011",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic|DS005WebProxyRequest-ET01Requested",
         "journey" : "Stage_6",
         "app" : "Splunk_User_Behavior_Analytics",
         "datasource" : "Network Communication|Web Proxy",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "mitre_notes" : "",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Correlates beaconing activity with global information in the enterprise to identify suspicious beaconing activity.",
         "mitre_technique" : "|T1094|T1071|T1095",
         "category" : "Command and Control|Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- UBA Use Case",
         "includeSSE" : "Yes",
         "name" : "Machine Generated Beacon",
         "mitre" : "",
         "domain" : "Other"
      },
      "access_inscope_resources" : {
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "",
         "description" : "Visibility into who is accessing in-scope resources is key to your GDPR efforts. Splunk allows easy analysis of that information.",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Firewall logs (onboarded in accordance with our Data Onboarding Guides), during which someone uses Workday. Our live search looks for the same behavior using the standardized sourcetypes for Palo Alto Networks or the Common Information Model, and you can look for any destination where you have sensitive data including your cloud providers, databases, and more.",
         "domain" : "Network",
         "includeSSE" : "Yes",
         "gdprtext" : "<h4>Impact:</h4><p>Along with authorization and legitimate reason for use, accessing resources requires an audit trail that helps identify whether a user accessed a critical asset, and whether that user’s activity during the login session included viewing sensitive data.</p><p>Within a GDPR context, in-scope applications will store and process personal data. Organizations must ensure that access to those applications is not only authorized and motivated by a legitimate reason to access / handle / process the associated personal data, but also maintain a record of which users accessed those in-scope applications, and whether personal data was viewed. Maintaining such an audit trail is an industry best practice and can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58) – in such a scenario, it is critical to be able to show evidence of the actual scope of impact from any successful attempt(s) to access or handle personal data. If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). Capability to demonstrate that best practice was adhered to – that is, that an audit trail was recorded of any given user’s login activity to an in-scope application, and whether they viewed personal data – can help mitigate potential impact to the organization.</p>",
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_1",
         "mitre_tactic" : "",
         "data_source_categories" : "DS005WebProxyRequest-ET01RequestedWebAppAware",
         "usecase" : "Compliance",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "similarUseCases" : [
            "access_inscope_resources_unencrypted"
         ],
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Access to Inscope Resources GDPR - Demo",
         "mitre_notes" : "Cyber hygiene to keep data segregated",
         "SPLEase" : "Basic",
         "howToImplement" : "Implementation of this capability will vary from system to sytem. Tracking access via firewall connections is a popular approach, though you could also use application logs which would provide more granular access. Splunk recommends working with you auditor, and Splunk Professional Services for any complicated situations.",
         "operationalize" : "This search is typically used to track access, rather than something that would be sent directly to anyone to review.",
         "category" : "GDPR",
         "released" : "2.1.0",
         "knownFP" : "No known false positives at this time.",
         "mitre" : "",
         "name" : "Access to In-scope Resources",
         "examples" : [
            {
               "name" : "Access to Inscope Resources GDPR - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Access to Inscope Resources GDPR - Live",
               "label" : "Live Data"
            }
         ],
         "icon" : "Core_Use_Case.png",
         "datasource" : "Web Proxy",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/access_to_in_scope_resources.png",
         "visualizations" : [
            {
               "panel" : "row1cell2",
               "vizParameters" : {
                  "resizable" : true
               },
               "type" : "viz",
               "title" : "Access Types by Users",
               "dashboard" : "General Windows and Linux Posture",
               "vizType" : "TableElement",
               "search" : "| `Load_Sample_Log_Data(Sample Firewall Data)` | search app=workday* | chart count over user by app",
               "header" : "Broken"
            }
         ],
         "alertvolume" : "Low"
      },
      "UC0051" : {
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Insider Threat",
         "domain" : "Access",
         "mitre" : "",
         "name" : "Excessive physical access failures to CIP assets",
         "includeSSE" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "A user with continuous physical access failures could be someone searching for a physical vulnerability within the organization.  When this occurs in an area that is protecting CIP assets, it is something that should be followed up on immediately. ",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "usecase" : "Insider Threat",
         "icon" : "PS_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Physical Security",
         "displayapp" : "Splunk Professional Services"
      },
      "UC0030" : {
         "SPLEase" : "Basic",
         "howToImplement" : "With Anti-Malware logs onboard, these searches should work easily, particularly if you use a Splunk Add-on that maps the logs to the Common Information Model (search on Splunkbase!).",
         "operationalize" : "When this occurs, you should begin a standard incident response process on this host.",
         "released" : "2.0.0",
         "category" : "GDPR|Endpoint Compromise",
         "mitre" : "",
         "knownFP" : "No known false positives at this time.",
         "relevance" : "For all the environments, uncleaned malware means that there is still malware located in your environment. For environments that are handling GDPR, article 32 requires that you regularly test, assess and evaluate the effectiveness of your implemented technical and organizational security controls. If the Authority executes their powers and your Organization is in the scope of a Privacy Audit you need to demonstrate compliance (Article 58). Also in case you face a breach and individuals are impacted they have the right to compensation of the damage - if an organization can prove that they have done everything appropriate to the risk and deployed proper countermeasures, they shouldn't be liable (Article 82). Clearing out viruses can be considered in most cases as appropriate and your organization should be able to prove compliance.",
         "name" : "Endpoint Uncleaned Malware Detection",
         "examples" : [
            {
               "name" : "Endpoint Uncleaned Malware - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Endpoint Uncleaned Malware - Live"
            }
         ],
         "icon" : "Core_Use_Case.png",
         "datasource" : "Anti-Virus",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/endpoint_uncleaned_malware.png",
         "alertvolume" : "Low",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1204|T1189|T1193|T1192",
         "description" : "Detect a system with a malware detection that was not properly cleaned, as they carry a high risk of damage or disclosure of data.",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which a virus is not cleaned. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
         "domain" : "Access",
         "gdprtext" : "<h4>Problem</h4><p>Despite initial detection from traditional anti-malware tools, malware often persists undetected on endpoints. This can occur when malware uses evasive techniques to spread to other endpoints without triggering an alert, or if an infection or re-infection occurs due to incomplete remediation or a response that does not address the root of the infection.</p><h4>Impact</h4><p>Uncleaned malware puts digital systems at risk. For any environments/systems that are involved in processing personal data, this situation can be critical, and especially so in a GDPR context. <b>Article 32</b> of the GDPR requires that organizations regularly test, assess and evaluate effectiveness of implemented technical and organizational security controls. In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (<b>Article 58</b>). If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (<b>Article 82</b>). </p><h4>Resolution Path</h4><p>Removing malware infections that antivirus and other legacy endpoint protection software cannot remove (whether due to file permissions or other configurations that prevents easy quarantine or cleaning) can be considered in many cases appropriate, and helps to demonstrate compliance</p>.",
         "includeSSE" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS004EndPointAntiMalware-ET01SigDetected",
         "mitre_tactic" : "|TA0002|TA0001",
         "journey" : "Stage_1",
         "usecase" : "Security Monitoring|Compliance",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Endpoint Uncleaned Malware - Demo",
         "similarUseCases" : [
            "Outdated_Malware_Definitions",
            "high_number_of_hosts_not_updating_malware_signatures",
            ""
         ],
         "relatedUseCases" : [
            "Large_Web_Upload",
            "showcase_huge_volume_dns_volume",
            "detection_long_dns_text_response",
            "detection_malicious_powershell_process_obfuscation_techniques",
            "sser_tor_traffic"
         ]
      },
      "land_speed_violation" : {
         "datasource" : "Authentication",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Security Monitoring",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "mitre_tactic" : "|TA0001|TA0003",
         "journey" : "Stage_4",
         "app" : "Splunk_User_Behavior_Analytics",
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "description" : "Raises anomalies when accounts login over VPN from multiple locations within a short time.",
         "mitre_technique" : "|T1078",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "includeSSE" : "Yes",
         "name" : "Land Speed Violation",
         "mitre" : "",
         "domain" : "Other",
         "released" : "2.0.0",
         "category" : "Lateral Movement|Account Compromise|Account Sharing",
         "help" : "Help not needed -- UBA Use Case"
      },
      "detection_hosts_receiving_high_volume_network_traffic_from_email_servers" : {
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Network Communication",
         "displayapp" : "Enterprise Security Content Update",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Collection and Staging",
         "journey" : "Stage_1",
         "mitre_tactic" : "TA0009",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "domain" : "Network",
         "mitre" : "Collection",
         "includeSSE" : "Yes",
         "name" : "Hosts receiving high volume of network traffic from email server",
         "help" : "This search may look complex, but it's a neat representation of how statistics can help you understand your dataset to bubble up events that are not normal compared to its behavior. The search consists of three parts. The first part of the SPL fetches the data you want to work on. In this search, we calculate the sum of bytes sent and bytes_out from systems categorized as email_server to each host. We then calculate the average and standard deviation for the bytes sent to all the hosts combined and on a per-host basis. Then we set threshold values to deviation_threshold and minimum_data_samples using eval statements. The \"deviation_threshold\" field is a multiplying factor to control how much variation you're willing to tolerate. The \"minimum_data_samples\" field is the minimum number of connections of data samples required for the statistic to be valid.  We then check for byte transfers that are statistically significantly higher than normal. The search then gives IP address of the host, the time of the increased byte transfer, how much data was transferred, and the average amount of data transfer the email server normally sends to all hosts and to this specific host. Finally, it includes the number of standard deviations away the byte count was from these averages.",
         "released" : "2.2.0",
         "category" : "Adversary Tactics",
         "search_name" : "ESCU - Hosts receiving high volume of network traffic from email server - Rule",
         "mitre_technique" : "T1043",
         "description" : "This search looks for an increase of data transfers from your email server to your clients. This could be indicative of a malicious actor collecting data using your email server.",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No"
      },
      "detection_short_lived_accounts" : {
         "killchain" : "",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "T1078",
         "search_name" : "ESCU - Short Lived Windows Accounts - Rule",
         "description" : "This search detects accounts that were created and deleted in a short time period.",
         "help" : "This search looks for Windows Event Logs 4720 (account creation) and 4726 (account deletion) and determines if they happen for the same user within 4 hours of each other.  It will report the user and machine that reported the events and the time it first and last saw this activity.",
         "released" : "2.2.0",
         "category" : "Best Practices",
         "domain" : "Access",
         "mitre" : "",
         "name" : "Short Lived Windows Accounts",
         "includeSSE" : "Yes",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Account Monitoring and Controls",
         "journey" : "Stage_1",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "showcase_new_ad_domain" : {
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of Windows logon events from a domain controller. For this analysis, we are looking for the earliest time for a domain name. We check if the first time that domain was seen was in the last day.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the account name associated with the new domain. Determine at what time the event occurred and from what system the login attempt occurred from. Contact the user and system owner(s) to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine is a pass the hash attack has been attempted and generated this new domain in the event log.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "category" : "Lateral Movement",
         "released" : "1.0.0",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This search is designed to find older versions of Mimikatz (or other tools with similar techniques), and is not known to have any other false positives.</p>",
         "mitre" : "Lateral Movement",
         "domain" : "Access",
         "relevance" : "<p>In Windows logs, the domain name is often reported when it's not explicitly required for the authentication. Under normal operation, the domain name reported will be totally normal, but when someone is intentionally modifiying authentication (such as with Pass the Hash), you can see incorrect, or empty domains. Pass the Hash is used by attackers to move laterally within the organization, connecting to new servers. While not all Pass the Hash techniques will demonstrate this vulnerability, tracking new domains in your Windows logs is very valuable.</p>",
         "name" : "New AD Domain Detected",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Installation",
         "hasSearch" : "Yes",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1075",
         "description" : "<p>New AD domain names in your normal domain controller logs are a symptom of many Pass the Hash tools. While some of the latest don't produce these artifacts, this remains a very valuable detection mechanism.</p><p><b>Alert Volume:</b> Low</p>",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Domain Name Detected - Demo",
         "relatedUseCases" : [
            "showcase_first_seen_domain_controller",
            "user_login_local_credentials",
            "New_Domain"
         ],
         "alertvolume" : "Low",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0008",
         "journey" : "Stage_1",
         "examples" : [
            {
               "name" : "New Domain Name Detected - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "New Domain Name Detected - Live"
            }
         ],
         "usecase" : "Advanced Threat Detection|Compliance",
         "icon" : "Core_Use_Case.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No"
      },
      "UC0088" : {
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "app" : "Splunk_Professional_Services",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Authentication",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "PS_Use_Case.png",
         "category" : "Account Sharing",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "name" : "User account sharing detection by source device ownership",
         "includeSSE" : "No",
         "mitre" : "",
         "domain" : "Access",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Detection of logon device by asset name (may require resolution from IP) when logon user does not match the owner and the number of unique owned devices is greater than two in the prior 24 hours.",
         "SPLEase" : "None",
         "mitre_technique" : ""
      },
      "UC0031" : {
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Accounts designated for use by services and batch process should start a limited set of child processes. Creation of new child processes other than the process name defined in the service or batch definition may indicate compromise.",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "category" : "Account Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "name" : "Service Account Starting Unexpected Processes",
         "includeSSE" : "No",
         "domain" : "Endpoint",
         "mitre" : "",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Splunk Professional Services",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other"
      },
      "detection_suspicious_file_writes" : {
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Hidden Cobra Malware",
         "name" : "Suspicious File Write",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "",
         "category" : "Malware",
         "released" : "2.2.0",
         "help" : "This search looks at files being created or modified in the Endpoint file-system data model. The names of those files are checked against an included lookup file, which contains the names of files associated with malware or attack activity. The search returns any files with matching names, along with a note (also specified in the lookup file) that gives or points to more information about the files.",
         "description" : "The search looks for files created with names that have been linked to malicious activity.",
         "mitre_technique" : "",
         "search_name" : "ESCU - Suspicious File Write - Rule",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : ""
      },
      "UC0072" : {
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Detection of an endpoint utilizing DNS as a method of proxying by querying for wpad.registrationdomain. Search for reply NXDOMAIN replies for A/AAA queries for wpad (bare host) and wpad.* where the domain portion is not a company owned domain.",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Network",
         "mitre" : "",
         "includeSSE" : "No",
         "name" : "Detection of unauthorized using DNS resolution for WPAD",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Operations|Network Attack",
         "released" : "2.0.0",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "highlight" : "No",
         "datasource" : "DNS",
         "displayapp" : "Splunk Professional Services",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case"
      },
      "detection_single_letter_executables" : {
         "includeSSE" : "Yes",
         "name" : "Single Letter Process On Endpoint",
         "mitre" : "Execution",
         "domain" : "Endpoint",
         "category" : "Malware",
         "released" : "2.2.0",
         "help" : "This search returns all the processes for each endpoint and user and filters out any process that isn't 5 characters long and ends with .exe.",
         "description" : "This search looks for process names that consist only of a single letter.",
         "search_name" : "ESCU - Single Letter Process On Endpoint - Rule",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "journey" : "Stage_3",
         "story" : "DHS Report TA18-074A",
         "app" : "Enterprise_Security_Content_Update"
      },
      "UC0107" : {
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_4",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Activity Expired Identity GDPR - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Activity Expired Identity GDPR - Live"
            }
         ],
         "mitre_tactic" : "TA0004|TA0003",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-winsec",
         "usecase" : "Compliance",
         "icon" : "Core_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Authentication|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_activity_from_expired_account.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Activity Expired Identity GDPR - Demo",
         "alertvolume" : "Low",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1078",
         "SPLEase" : "Medium",
         "description" : "The GDPR requires that only authorized individuals access personal data. Alert when the account of a past employee is used to log into GDPR-tagged systems",
         "help" : "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Windows Authentication logs, during which someone attempts a brute force against a series of usernames. Our live search looks for Windows Authentication activity across any index in the standard sourcetype.",
         "operationalize" : "The first thing to understand after this alert fires is whether this was some continuation of normal system operations (e.g., the desktop under their desk was still logged in, or iPhone account still active) versus a deliberate action. Obviously success or failure also carries weight. Finally, particularly for sysadmin type employees in less structured organizations, it's important to make sure that there are no services or scheduled jobs running under that account where disabling the account outright might impact operations.",
         "howToImplement" : "If you have followed the data onboarding guides in this app, this search will work immediately for you. You should generally specify the index where you are storing Windows Security logs (e.g., index=oswinsec), and if you use a mechanism other than the Splunk Universal Forwarder to onboard that data, you should verify the sourcetype and fields that are used. The rest is simple!",
         "released" : "2.0.0",
         "category" : "GDPR",
         "domain" : "Access",
         "knownFP" : "If you are still using an account after the user is disabled, you will see alerts (e.g., if you provide the manager with access to log in as the user).",
         "mitre" : "Credential Access|Privilege Escalation",
         "name" : "Activity from Expired User Identity - on Category",
         "includeSSE" : "Yes",
         "gdprtext" : "<h4>Impact:</h4><p>Detecting and proving that only individuals who are authorized to access, handle, and process personal data is an industry best practice and can be considered an effective security control, as required by Article 32. Demonstrating that any unauthorized attempts -- both failed and successful -- from past employees or employees whose authorization has expired -- as well as demonstration that any non-compliant conditions resulting in unauthorized use are properly scoped, investigated, and remediated properly, is required to prove compliance for data privacy audits from authorities (Article 58) or to counteract any compensation claims (Article 82). Additionally, data processors working on behalf of a controller within the organization need to ensure, per Article 28, that only authorized individuals have access to personal data.</p>"
      },
      "user_login_unauthorized_geo" : {
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1078",
         "description" : "<p>For regulated environments, detect users logging into servers where they're not permitted.</p>",
         "operationalize" : "<p>When this alert fires, your first step should be to validate whether this user should be allowed to log into the server in question (i.e., if it's a question of out of date or inaccurate lookups). Next, validate whether there is a permissions issue that should have prevented the login, and whether the login was with malicious intent or merely an accident.</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of Windows Authentication logs. For this analysis, we are combining the authentication logs with a lookup table that indicates what country the server is a part of and what resources a user is permitted to access, so that we can detect users who are logged into servers in countries they're not permitted to (e.g., a US user logging into a Germany server).</p>",
         "howToImplement" : "<p>This search is easy to implement technically, though difficult for business purposes. Building a reliable list of which servers are in which zones, and which users are permitted to log into which zones can be a project that takes weeks or months to complete, and never completes with complete accuracy (though the importance of absolute accuracy is up to the interpretation of your legal advisor). Once you have two lookups, servers_to_geos and users_authorized_geos, the search implementation should proceed smoothly.</p>",
         "category" : "Compliance",
         "released" : "2.2.0",
         "mitre" : "Credential Access|Privilege Escalation|Initial Access",
         "knownFP" : "<p>Not Applicable</p>",
         "relevance" : "<p>For organizations that face strong regulations, you may need to restrict access to servers in specific geographies (particularly, Germany tends to have strict laws). If your legal team has indicated that you need to restrict access based on the types of data that you have, Splunk makes it easy to detect unauthorized logins.</p>",
         "domain" : "Access",
         "name" : "User Login to Unauthorized Geo",
         "includeSSE" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0001",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-aws-cloudtrail",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "User Login Unauthorized Geo - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "User Login Unauthorized Geo - Live"
            },
            {
               "name" : "User Login Unauthorized Geo - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_4",
         "usecase" : "Compliance",
         "icon" : "Core_Use_Case.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Authentication|Vendor-Specific Data",
         "highlight" : "No",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/user_login_unauthorized_geo.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=User Login Unauthorized Geo - Demo",
         "alertvolume" : "Medium"
      },
      "user_many_dlp_events" : {
         "mitre_tactic" : "|TA0010",
         "data_source_categories" : "DS016DataLossPrevention-ET01Violation",
         "examples" : [
            {
               "name" : "Many DLP Alerts for User - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Many DLP Alerts for User - Live",
               "label" : "Live Data"
            },
            {
               "name" : "Many DLP Alerts for User - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_3",
         "app" : "Splunk_Security_Essentials",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "DLP",
         "highlight" : "Yes",
         "usecase" : "Insider Threat",
         "icon" : "Core_Use_Case.png",
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Many DLP Alerts for User - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/user_many_dlp_events.png",
         "alertvolume" : "Medium",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "<p>Detect users that have many DLP events in a short period of time.</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "|TA0010",
         "category" : "Insider Threat",
         "released" : "2.2.0",
         "operationalize" : "<p>Respond to the underlying events.</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of DLP Events. For this analysis, we are looking for a large number of DLP Events based on a specific threshold.</p>",
         "howToImplement" : "<p>Ensure that your DLP events are ingested with the Common Information Model, and tune the threshold to the degree you desire.</p>",
         "name" : "User with Many DLP Events",
         "includeSSE" : "Yes",
         "knownFP" : "<p>DLP systems in most organizations will generate many false positives (or at least, lots of noise). The goal of this search is to take users that have many different DLP events on a given day and escalate the priority of those events. That means that inherently there will still be false positives from this search based on the underlying policy. Tune your DLP system or adjust the threshold to control the noise from this search.</p>",
         "mitre" : "Exfiltration|Credential Access",
         "domain" : "Threat",
         "relevance" : "<p>DLP events track meaningful risks to your organization, but unfortunately in most environments the volume of DLP events creates so much noise that valid events are disregarded. While you should absolutely be correlating DLP events with other security events, you may also wish to surface users that have a high number of DLP events in a short term to prioritize investigation into those events.</p>"
      },
      "detection_remote_desktop_network_traffic" : {
         "help" : "This search finds systems that do not commonly communicate use remote desktop.  It does this by filtering out all systems that have the \"common_rdp_source\" or \"common_rdp_destination\" category applied to that system.  Categories are applied to systems using the Assets and Identity framework.",
         "category" : "Lateral Movement",
         "released" : "2.0.0",
         "domain" : "Network",
         "mitre" : "Lateral Movement",
         "includeSSE" : "Yes",
         "name" : "Remote Desktop Network Traffic",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "T1076|T1043",
         "search_name" : "ESCU - Remote Desktop Network Traffic - Rule",
         "SPLEase" : "None",
         "description" : "This search looks for network traffic on TCP/3389, the default port used by remote desktop. While remote desktop traffic is not uncommon on a network, it is usually associated with known hosts. This search allows for whitelisting both source and destination hosts to remove them from the output of the search so you can focus on the uncommon uses of remote desktop on your network.",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Hidden Cobra Malware",
         "journey" : "Stage_2",
         "mitre_tactic" : "TA0008",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Network Communication"
      },
      "unusual_vpn_login_geolocation" : {
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Security Monitoring",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Authentication",
         "highlight" : "No",
         "app" : "Splunk_User_Behavior_Analytics",
         "mitre_tactic" : "|TA0001",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "journey" : "Stage_4",
         "mitre" : "",
         "domain" : "Other",
         "name" : "Unusual VPN Login Geolocation",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.0.0",
         "category" : "Lateral Movement|Account Compromise|Account Sharing",
         "mitre_technique" : "|T1078",
         "description" : "Detects rare authentication locations in VPN data using geolocation.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No"
      },
      "expected_host_not_reporting" : {
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other",
         "data_source_categories" : "VendorSpecific-AnySplunk",
         "mitre_tactic" : "|TA0005",
         "journey" : "Stage_4",
         "app" : "Splunk_App_for_Enterprise_Security",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "Yes",
         "usecase" : "Security Monitoring|Compliance",
         "icon" : "ES_Use_Case.png",
         "category" : "Operations|GDPR",
         "released" : "2.0.0",
         "help" : "Help not needed -- ES Use Case",
         "gdprtext" : "<h4>Problem:</h4><p>Many compliance and regulatory frameworks contain clauses specifying requirements for central logging of event data, as well as retention periods and use of that data to assist in detecting data breaches and investigation and handling of threats. These regulations also specify that a mechanism exist to notify when critical systems stop forwarding event data. For example, tracking of “initialization, stopping, or pausing of audit logs”. This is directly related to the fact that commonly, the intent behind disruption to event data forwarding is malicious, e.g. an attempt to evade a preventive measure or to avoid detection. </p><h4>Impact:</h4><p>The GDPR requires that organizations collect the full audit trail of data processing activities of involved systems and applications. This can impact the organization via a wide array of GDPR articles. If breached, Article 33 requires organizations to inform the authorities, including details about the nature of the breach, such as how many individuals have been affected. The same requirement is in Article 34 for when organizations must identify which individuals are affected, in order to notify them if there is a high risk related to their individual data. If organizations do not store the requisite logs and are therefore not able to proper scope the impact, data privacy officers will need to assume the worst case scenario: all personal data that was stored or processed in the breached environment or accessible by the breached user was affected. In addition, Article 32 requires implementation of proper security controls, and for organizations to monitor, test, and demonstrate their effectiveness. If an organization experiences that logging stops for a particular host or set of hosts, then the organization will not be able to prove the status and effectiveness of the applied security controls on those systems, in the event of damage claims (Article 82) or privacy audits (Article 58). If the organization lacks host logs and corresponding application logs, they will not be able to prove which records have been processed, such as proving that a record was deleted according to an individual's delete request (Article 17) or proving compliance with a processing restriction requested by an individual (Article 18 and Article 21). If a host does not report event data, a processor cannot prove that only authorized individuals have accessed the data (Article 28).</p><h4>Resolution Path:</h4><p>Identify all GDPR-relevant IT assets from the data mapping exercise conducted by the Data Privacy Officer’s team -- that is, all IT assets that are relevant to the full audit trail of data processing activities. This includes not only data stores and repositories that house sensitive PD / PII, but also any technologies that are involved in the processing, storage, transmission, receipt, rendering, encrypt/decrypt, relaying, and any other function that involves handling that data in any capacity. Ensure that those assets are configured properly to report logging activity to an appropriate central repository. Monitor for changes in logging status, adjust for known outages, and prioritize incident response for any failures to report by hosts that are not scheduled for downtime.</p>",
         "name" : "Expected Host Not Reporting",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Audit",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "Discovers hosts that are longer reporting events but should be submitting log events. This rule is used to monitor hosts that you know should be providing a constant stream of logs in order to determine why the host has failed to provide log data.",
         "SPLEase" : "Accelerated",
         "mitre_technique" : "|T1089",
         "search_name" : "Audit - Expected Host Not Reporting - Rule"
      },
      "detection_acl_with_open_ports" : {
         "includeSSE" : "Yes",
         "name" : "AWS Network Access Control List Created with All Open Ports",
         "domain" : "Network",
         "mitre" : "Persistence",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "help" : "A network access control list (ACL) is a layer of security for your VPC that acts as a firewall for controlling traffic in and out of one or more subnets. Network ACLs with all open ports have a larger attack surface. This search looks for events within your CloudTrail logs to check if there were any Network ACLs created with ports ranging from 1024 to 65525. This search will create a table comprised of AWS account id, src, user and all parameters of the request made by the user and the server response.",
         "description" : "The search looks for CloudTrail events to detect if any network ACLs were created with all the ports open to a specified CIDR.",
         "search_name" : "ESCU - AWS Network Access Control List Created with All Open Ports - Rule",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0003",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS Network ACL Activity"
      },
      "UC0006" : {
         "usecase" : "Advanced Threat Detection",
         "icon" : "PS_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Audit Trail",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_2",
         "mitre_tactic" : "",
         "alertvolume" : "Other",
         "relatedUseCases" : [
            "showcase_new_local_admin_account",
            "sser_windows_event_log_clearing_events"
         ],
         "dashboard" : "PS_Use_Case",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Manually clearing the security event log on a windows system is a violation of policy and could indicate an attempt to cover malicious actions.",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Endpoint",
         "mitre" : "",
         "includeSSE" : "No",
         "name" : "Windows security event log purged",
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise"
      },
      "showcase_hosts_with_many_timestamps" : {
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Systems with Timestamps Far Into the Future - Live",
         "alertvolume" : "Low",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "Systems with Timestamps Far Into the Future - Live",
               "label" : "Live Data (Auto Accelerated)"
            }
         ],
         "journey" : "Stage_1",
         "mitre_tactic" : "TA0005",
         "data_source_categories" : "VendorSpecific-AnySplunk",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "help" : "<p>This example leverages the Simple Search assistant. Here we are looking through all Splunk logs for hosts that begin sending logs at very different timestamps. The goal is to detect an attacker who suddenly sets the year to 2020 or some point in the future to evade detection. We use the tstats command here, because we are only looking at indexed field, and it is super fast for those use cases. If we find a broad range of time for any host, the search surfaces it. We use 21 years into the future for the time range, because that is the maximum time range you can put into a Splunk search. We're looking for a range of more than one hour, just to make sure we're above chance.</p>",
         "operationalize" : "<p>When timestamps are detected as being incorrect, it should be noted which system's timestamps are off and when it started. Notification of the system owner needs to be made to correct this condition, but additional investigation may be required to determine if this was an accidental or malicious configuration change and by whom.</p>",
         "howToImplement" : "This search should work universally on all Splunk environments, since it uses Splunk internal fields.",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "relevance" : "Splunk uses the timestamps in the logs generated on an endpoint in order to log an accurate time when an event actually happened. This is why having all of the systems reporting into Splunk leverage an authoritative time source, like NTP, is so important. Attackers may realize that your correlation rules are based on time boundaries, e.g. 'search the last five minutes of data' but if a system is logging time 'in the future’ then your correlation rules may not trip when suspicious behavior is logged. It is important to find the systems with inaccurate system times and fix them.",
         "domain" : "Endpoint",
         "knownFP" : "This should not fire often -- the idea is it should only fire when the system time changes, which should not happen often. The only known false positives are hosts that are sending data with multiple timestamps simultaneously, which is usually an instance of an incorrect _time extraction (which should be fixed) or a data source with known lag (which should be filtered out).",
         "mitre" : "Defense Evasion",
         "name" : "Hosts with Varied and Future Timestamps",
         "includeSSE" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1099",
         "SPLEase" : "Advanced",
         "description" : "<p>One technique for foiling correlation searches is to alter the system time. This search will detect this scenario.</p><p><b>Alert Volume:</b> Low (and should be fixed)</p>"
      },
      "UC0028" : {
         "domain" : "Endpoint",
         "mitre" : "",
         "name" : "Endpoint Multiple infections over short time",
         "includeSSE" : "No",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Multiple infections detected on the same endpoint in a short period of time could indicate the presence of an undetected loader malware component (apt).",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "similarUseCases" : [
            "Basic_Malware_Outbreak",
            "Recurring_Infection_on_Host",
            "high_number_of_infected_hosts",
            "host_with_a_recurring_malware_infection",
            "host_with_multiple_infections",
            "UC0029",
            "UC0075",
            "UC0065"
         ],
         "dashboard" : "PS_Use_Case",
         "usecase" : "Advanced Threat Detection",
         "icon" : "PS_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Anti-Virus",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_3",
         "mitre_tactic" : ""
      },
      "detection_email_files_not_in_outlook_directory" : {
         "name" : "Email files written outside of the Outlook directory",
         "includeSSE" : "Yes",
         "mitre" : "Collection",
         "domain" : "Endpoint",
         "released" : "2.2.0",
         "category" : "Adversary Tactics",
         "help" : "In this search, we are looking for activities consistent with an adversary collecting email data from local machines. The search will detect email files (files with .pst or .ost extensions) created in directories other than the standard Outlook directory (c:\\users\\username\\My Documents\\Outlook Files\\.",
         "description" : "The search looks at the change-analysis data model and detects email files created outside the normal Outlook directory.",
         "search_name" : "ESCU - Email files written outside of the Outlook directory - Rule",
         "mitre_technique" : "T1114",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "TA0009",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "journey" : "Stage_3",
         "story" : "Collection and Staging",
         "app" : "Enterprise_Security_Content_Update"
      },
      "detection_suspicious_write_to_sysvol" : {
         "released" : "2.2.0",
         "category" : "Adversary Tactics",
         "help" : "This search uses data on file writes captured via Sysmon to watch for writes to the \"System Volume Information\" folder by processes other than the system process. The search looks for event code 11 in the Sysmon events, which indicates a file-creation event. It then looks for a file created with a path that includes \"System Volume Information\" and a process ID (PID) other than 4. PID 4 is assigned to the System process on Windows systems. Excluding these writes allows us to filter out legitimate activity. It will report the system where the activity occurred, the path to which the file was written, the process responsible for the write, and the times it first and last saw this activity.",
         "includeSSE" : "Yes",
         "name" : "Suspicious writes to System Volume Information",
         "domain" : "Endpoint",
         "mitre" : "Collection",
         "hasSearch" : "No",
         "killchain" : "",
         "searchKeywords" : "",
         "description" : "This search detects writes to the 'System Volume Information' folder by something other than the System process.",
         "search_name" : "ESCU - Suspicious writes to System Volume Information - Rule",
         "mitre_technique" : "T1074",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "TA0009",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Collection and Staging",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png"
      },
      "detection_disable_remote_uac" : {
         "description" : "The search looks for modifications to registry keys that control the enforcement of Windows User Account Control (UAC).",
         "mitre_technique" : "T1112",
         "search_name" : "ESCU - Disabling Remote User Account Control - Rule",
         "SPLEase" : "None",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "name" : "Disabling Remote User Account Control",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "This search checks to see if the registry key SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy was modified.  This registry key can be used to disable remote User Account Control.  The search returns the count, the first time activity was seen, last time activity was seen, the registry path that was modified, the host where the modification took place and the user that performed the modification.",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "TA0005",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious Windows Registry Activities",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case"
      },
      "brute_force_access_behavior_detected" : {
         "help" : "Help not needed -- ES Use Case",
         "category" : "Lateral Movement|IAM Analytics",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Access",
         "name" : "Brute Force Access Behavior Detected",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "SPLEase" : "Advanced",
         "search_name" : "Access - Brute Force Access Behavior Detected - Rule",
         "mitre_technique" : "|T1110",
         "description" : "Detects excessive number of failed login attempts along with a successful attempt (this could indicate a successful brute force attack)",
         "dashboard" : "ES_Use_Case",
         "similarUseCases" : [
            "basic_brute_force",
            "brute_force_access_behavior_detected_over_one_day",
            "excessive_failed_logins",
            "UC0099",
            "UC0108",
            "UC0109"
         ],
         "alertvolume" : "Other",
         "app" : "Splunk_App_for_Enterprise_Security",
         "mitre_tactic" : "|TA0006",
         "data_source_categories" : "DS003Authentication-ET01Success|DS003Authentication-ET02Failure",
         "journey" : "Stage_2",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Authentication",
         "highlight" : "Yes"
      },
      "showcase_remote_powershell_launches" : {
         "domain" : "Endpoint",
         "relevance" : "Remote execution of PowerShell is something that should rarely occur if at all within an network, and if it does should be associated with known executables or users. Therefore, unique instances of user and host combinations should be monitored and alerted upon for further investigation by security teams. This type of activity could be an indicator of compromised assets, user credentials, or a potential insider threat scenario.",
         "mitre" : "Lateral Movement",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This type of event should only occur for remote management, or potentially some systems management tools. It would be recommended to filter out the users who typically perform these actions (or alternatively you could alter the search to look for user + sourcetype instead of user + host, so that you will be alerted the first time a user takes this action, instead of the first time a user takes it on a particular host).</p>",
         "includeSSE" : "Yes",
         "name" : "Remote PowerShell Launches",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688) filtered for the Image and ParentImage that show up when Powershell is remotely triggered. We check the first time that's occurred per host, and then alert if that was in the last day.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the user and system responsible for initiating this behavior. Determine the time of the event and what process and associated parent processes where triggered. Contact the user and system owner to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "released" : "1.0.0",
         "category" : "Lateral Movement",
         "mitre_technique" : "|T1021",
         "SPLEase" : "Medium",
         "description" : "<p>It's unusual for new users to remotely launch PowerShell on another system. This will track the first time per  user + host combination that powershel is remotely started.</p><p><b>Alert Volume:</b> Low (for most companies)</p>",
         "killchain" : "Installation",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "alertvolume" : "Low",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=Remote Powershell Launches - Demo",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_1",
         "examples" : [
            {
               "name" : "Remote Powershell Launches - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Remote Powershell Launches - Live"
            }
         ],
         "mitre_tactic" : "TA0008",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec"
      },
      "UC0019" : {
         "usecase" : "Security Monitoring|Insider Threat",
         "icon" : "PS_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Authentication|HR System",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "A user on leave, vacation, sabbatical, or other types of leave should not access business systems.  This could indicate malicious activity by the employee or a compromised account.",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Access",
         "mitre" : "",
         "name" : "User authenticated to routine business systems while on extended absence",
         "includeSSE" : "No",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Account Compromise|Insider Threat|Account Sharing",
         "released" : "2.0.0"
      },
      "detection_wmi_temp_event_subscription" : {
         "mitre" : "Execution|Persistence",
         "incluseSSE" : "No",
         "domain" : "Endpoint",
         "name" : "WMI Temporary Event Subscription",
         "includeSSE" : "Yes",
         "help" : "Attackers are increasingly abusing Windows Management Infrastructure (WMI) for stealth, persistence, lateral movement, or just to leverage its functionality. This search looks for the creation of a WMI temporary event subscription by watching for Windows event ID 5860.",
         "category" : "Adversary Tactics|",
         "released" : "2.2.0",
         "mitre_technique" : "T1047|T1084",
         "description" : "This search looks for the creation of WMI temporary event subscriptions.",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "story" : "Suspicious WMI Use",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0002|TA0003",
         "data_source_categories" : "VendorSpecific-winsec",
         "journey" : "Stage_1"
      },
      "unusual_network_activity" : {
         "domain" : "Other",
         "mitre" : "",
         "name" : "Unusual Network Activity",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- UBA Use Case",
         "category" : "Lateral Movement|Insider Threat|Account Compromise|Data Exfiltration",
         "released" : "2.0.0",
         "mitre_technique" : "|T1024|T1094|T1065",
         "description" : "Detects events that have rare combination of port/application in firewall data.",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "mitre_notes" : "",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat|Security Monitoring|Insider Threat",
         "highlight" : "Yes",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk User Behavior Analytics",
         "app" : "Splunk_User_Behavior_Analytics",
         "journey" : "Stage_4",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware|DS010NetworkCommunication-ET03UserAware",
         "mitre_tactic" : "|TA0011"
      },
      "suspicious_network_exploration" : {
         "app" : "Splunk_User_Behavior_Analytics",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0001",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat|Security Monitoring",
         "highlight" : "Yes",
         "datasource" : "Authentication",
         "displayapp" : "Splunk User Behavior Analytics",
         "relatedUseCases" : [
            "detection_registry_persistence",
            "sser_fake_windows_processes",
            "detection_malicious_powershell_process_obfuscation_techniques"
         ],
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "|T1078",
         "description" : "Detects users systematically increasing the number of devices that they access over time.",
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.0.0",
         "category" : "Lateral Movement|Insider Threat|Account Compromise",
         "domain" : "Other",
         "mitre" : "",
         "name" : "Suspicious Network Exploration",
         "includeSSE" : "Yes"
      },
      "detection_suspicious_email_attachments" : {
         "dashboard" : "ESCU_Use_Case",
         "relatedUseCases" : [
            "detection_email_attachments_with_spaces",
            "showcase_external_emails_with_internal_domain",
            "showcase_spike_in_outgoing_email",
            "high_volume_email_activity_to_noncorporate_domains_by_user",
            "UC0004"
         ],
         "alertvolume" : "Low",
         "story" : "Suspicious Emails",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0001|TA0002",
         "data_source_categories" : "DS001MAIL-ET02Receive|DS001MAIL-ET03Send",
         "journey" : "Stage_3",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "datasource" : "Email",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "help" : "This search looks at any email messages with attachments and checks the file names of those attachments against an included lookup file to see if it has a suspicious file extension.",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "mitre" : "Execution|Defense Evasion",
         "domain" : "Network",
         "includeSSE" : "Yes",
         "name" : "Suspicious Email Attachment Extensions",
         "searchKeywords" : "",
         "killchain" : "Delivery",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "search_name" : "ESCU - Suspicious Email Attachment Extensions - Rule",
         "mitre_technique" : "|T1193|T1203",
         "description" : "This search looks for emails that have attachments with suspicious file extensions."
      },
      "detection_local_admin_account_creation" : {
         "mitre" : "Defense Evasion|Persistence",
         "domain" : "Access",
         "includeSSE" : "Yes",
         "name" : "Detect New Local Admin account",
         "help" : "This search looks for Windows Event Code 4720 (account creation) and 4732 (account added to a security-enabled local group), where the group name is \"Administrators\", and determines whether they are generated for the same user's Security ID within three hours of each other.  It will return the user account that was added, the Security ID, the group name to which the user was added, the account name of the user who initiated the action, and the subsequent message returned.",
         "category" : "Malware",
         "released" : "2.2.0",
         "mitre_technique" : "T1078",
         "search_name" : "ESCU - Detect New Local Admin account - Rule",
         "description" : "This search looks for newly created accounts that have been elevated to local administrators.",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective|Command and Control",
         "hasSearch" : "No",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "story" : "DHS Report TA18-074A",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0005|TA0003",
         "data_source_categories" : "VendorSpecific-winsec",
         "journey" : "Stage_1"
      },
      "UC0079" : {
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Insider Threat|Lateral Movement|Account Compromise",
         "mitre" : "",
         "domain" : "Access",
         "name" : "Privileged Identity accessing New or Rare Sensitive Resource",
         "includeSSE" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Use of an identity identified as privileged to access a system for the first time within a rolling time period will trigger a notable event for review of access reason.",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Insider Threat",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Authentication",
         "highlight" : "No"
      },
      "UC0046" : {
         "released" : "2.0.0",
         "category" : "Operations",
         "help" : "Help not needed -- PS Use Case",
         "name" : "Endpoint failure to sync time",
         "includeSSE" : "No",
         "domain" : "Endpoint",
         "mitre" : "",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Failure to synchronize time will impact the usefulness of security log data from the endpoint, and potentially prevent valid authentication.",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "journey" : "Stage_2",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Audit Trail",
         "usecase" : "Security Monitoring",
         "icon" : "PS_Use_Case.png"
      },
      "UC0009" : {
         "released" : "2.0.0",
         "category" : "Account Compromise|IAM Analytics",
         "help" : "Help not needed -- PS Use Case",
         "includeSSE" : "No",
         "name" : "Authenticated communication from a risky source network",
         "mitre" : "",
         "domain" : "Access",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "An Internet facing authentication system has allowed authenticated access from a risky source network.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "app" : "Splunk_Professional_Services",
         "datasource" : "Authentication",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance"
      },
      "same_error_on_many_servers_detected" : {
         "includeSSE" : "Yes",
         "name" : "Same Error On Many Servers Detected",
         "mitre" : "",
         "domain" : "Threat",
         "category" : "Endpoint Compromise|Operations|Lateral Movement",
         "released" : "2.0.0",
         "help" : "Help not needed -- ES Use Case",
         "description" : "Alerts when multiple systems are exhibiting the same errors",
         "SPLEase" : "Basic",
         "mitre_technique" : "",
         "search_name" : "Threat - Same Error On Many Systems - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "alertvolume" : "Other",
         "mitre_notes" : "Too broad - cyber hygiene",
         "dashboard" : "ES_Use_Case",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "data_source_categories" : "VendorSpecific-AnySplunk",
         "mitre_tactic" : "",
         "journey" : "Stage_2",
         "app" : "Splunk_App_for_Enterprise_Security"
      },
      "unauthorized_web_browsing" : {
         "usecase" : "Insider Threat",
         "icon" : "Core_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Web Proxy",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "Unauthorized Web Browsing - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Unauthorized Web Browsing - Live",
               "label" : "Live Data"
            },
            {
               "name" : "Unauthorized Web Browsing - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_1",
         "data_source_categories" : "DS005WebProxyRequest-ET01Requested",
         "mitre_tactic" : "TA0010|TA0011",
         "alertvolume" : "Medium",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/unauthorized_web_browsing.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Unauthorized Web Browsing - Demo",
         "mitre_technique" : "|T1048|T1071|T1102",
         "SPLEase" : "Medium",
         "description" : "<p>Detect users who are persistently attempting to violate your proxy policy.</p>",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "domain" : "Network",
         "relevance" : "<p>Users persistently violating acceptable use policies are risky in a number of different ways. In low grade situations, it may make sense to have HR follow up with that user. In high grade situations, it may indicate the need for an explicit intervention as the user may be a flight risk (or harbor malicious intent). In widespread scenarios, it may indicate a workplace problem that needs to be remediated. Regardless, things are blocked in your proxy for good reason -- you should track violations of those rules.</p>",
         "mitre" : "Exfiltration",
         "knownFP" : "<p></p>",
         "name" : "Web Browsing to Unauthorized Sites",
         "includeSSE" : "Yes",
         "implementationNotes_Internal" : "Validate in Splunk data by looking at whether we should look at dc(ut_domain) or bucket _time span=10m dc(_time) instead of just a straight count.",
         "howToImplement" : "<p>There are two primary triggers for this search -- one is the categories being excluded, and the other is the number of denies that you want to trigger on. There is no standard best practice for either of these, so you can adjust these values to be whatever makes sense for your organization. The most common way we hear of this detection being described is to target suspicious internal users, so most organizations will adjust the filters to look for Acceptable Use Policy violations (e.g., browsing gambling sites) as opposed to denies that are tied to security hygiene (e.g., phishing). That said, you could absolutely implement it in both directions if you so desired. The threshold for triggering would likely be different between those categories though, as a human will likely quit relatively early when they see deny messages versus a script that gets timeouts instead of a big error message.</p><p><b>If this searches creates too many false positives in your environment</b>, it may be because some of your users just generate a very large number of proxy denies on a regular basis. The first bet for dealing with this would be basic tuning of the categories you alert on. If that is not sufficient, you can instead implement this as a per-user time series detection. Look for the # of unauthorized detections per day per user, and then alert when any user exceeds their baseline. You can base this on any of the time series detections in Splunk Security Essentials -- a common and easy one would be to look at <a href=\"/app/Splunk_Security_Essentials/showcase_standard_deviation?ml_toolkit.dataset=Increase in Interactive Logons - Demo\" target=\"_blank\">Increase in Interactive Logons</a> (just swap out the field names and base dataset and implementation will be easy). There's one important adjustment you would need in order to make that work for you though -- because most users don't see proxy denies often, most of your users will end up with very low averages and low standard deviations. To guard against this, in addition to tracking that the most recent # of denies per day is more than 3 (or 6, or whatever) stdev above the average, you should also make sure that the most recent # is more than 5 (or 10, or whatever). That way you don't accidentally alert on a user that just had one deny (no matter how anomalous a deny is for that user).</p>",
         "operationalize" : "<p>When this alert fires, look at the sites where it triggered, and importantly the # of different sites. The primary goal is to determine whether there is a persistent desire to violate policy (or any other malicious intent) or whether someone went to one site where there were 15 different requests in a short period.</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of Palo Alto Networks proxy logs. For this analysis, we are looking for any user who has a high number of denied proxy requests, excluding advertising and phishing categories.</p>",
         "released" : "2.2.0",
         "category" : "Insider Threat"
      },
      "detection_prohibited_software_on_endpoint" : {
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0002",
         "journey" : "Stage_4",
         "story" : "Monitor for Unauthorized Software",
         "app" : "Enterprise_Security_Content_Update",
         "name" : "Prohibited Software On Endpoint",
         "includeSSE" : "Yes",
         "mitre" : "Execution",
         "domain" : "Endpoint",
         "released" : "2.0.0",
         "category" : "Unauthorized Software",
         "help" : "This search returns the number of times, as well as the first and last time, every process has run for each endpoint and user. It then displays only those processes that you have marked as \"prohibited\" in the Enterprise Security \"Interesting Processes\" table.",
         "description" : "This search looks for applications on the endpoint that you have marked as prohibited.",
         "SPLEase" : "None",
         "mitre_technique" : "|T1072",
         "search_name" : "ESCU - Prohibited Software On Endpoint - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Installation|Command and Control|Actions on Objective"
      },
      "AWS_Unusual_Amount_of_Modifications_to_ACLs" : {
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0003|TA0004",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "AWS Unusual Amount of Modifications to ACLs - Demo"
            },
            {
               "name" : "AWS Unusual Amount of Modifications to ACLs - Live",
               "label" : "Live Data"
            }
         ],
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_acl_modification.png",
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=AWS Unusual Amount of Modifications to ACLs - Demo",
         "relatedUseCases" : [
            "AWS_Cloud_Provisioning_Activity_from_Unusual_Country",
            "AWS_Instance_Created_by_Unusual_User",
            "AWS_New_API_Call_Per_User"
         ],
         "alertvolume" : "Low",
         "searchKeywords" : "cloudtrail",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1078",
         "description" : "Looks for a large number of Security Group ACL changes in a short period of time for a user.",
         "operationalize" : "When this alert fires, you should call the user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred. In particular, look to see what the ACL changes were, to see what new access has been allowed. Check your VPC Flow logs to see if data was sent over those newly allowed connections.",
         "howToImplement" : "Assuming you use the ubiqutious AWS Add-on for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
         "help" : "This example leverages the Detect Spikes search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, as detailed in How to Implement.",
         "category" : "Account Compromise|IAM Analytics|Data Exfiltration|Network Attack|SaaS",
         "released" : "2.0.0",
         "mitre" : "Persistence|Credential Access",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts. If your orchestration tools will perform these actions, and they aren't a part of the baseline (or they're very rare in the baseline), those could create false positives. You might opt to whitelist those tools, or alternatively to make a part of the response verifying in your change management whether those tools were scheduled.</p>",
         "domain" : "Access",
         "relevance" : "The risk that this detection intends to reduce is the compromise of an AWS environment, where all of a sudden Security Group (Firewall) ACLs that have existed to protect an environment are thrown open, allowing either outside connections in, allowing data exfiltration, or allowing lateral movement from one group to another.",
         "includeSSE" : "Yes",
         "name" : "AWS Unusual Amount of Modifications to ACLs"
      },
      "sser_fake_windows_processes" : {
         "released" : "1.0.0",
         "category" : "Endpoint Compromise",
         "howToImplement" : "This use case requires one of two options. Option one consists of having Sysmon installed on the endpoints you wish to monitor and the Sysmon add-on installed on both the Splunk forwarders and search heads. Or option two, to have your AD Administrator turn on Process Tracking in your Windows Audit logs (<a href=\"https://technet.microsoft.com/en-us/library/cc976411.aspx\" class=\"external\">docs</a>).",
         "operationalize" : "When this search fires, you will want to start your incident response process and investigate the actions taken by this process.",
         "help" : "This use case looks for system processes that normally run out of Windows\\System32 or Windows\\SysWOW64, but are running from some other location. This can indicate a malicious process that is trying to hide as a legitimate process. Ransomware often spawns processes that use a legitimate process name as a disguise.",
         "includeSSE" : "Yes",
         "name" : "Fake Windows Processes",
         "knownFP" : "None at the moment",
         "mitre" : "Defense Evasion",
         "domain" : "Endpoint",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Installation",
         "description" : "<p>This example finds processes normally run from Windows\\System32 or Windows\\SysWOW64, running from some other location. This can indicate a malicious process trying to hide as a legitimate process.</p><p><b>Alert Volume:</b> Low</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1036",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Fake Windows Processes - Demo",
         "relatedUseCases" : [
            "detection_registry_persistence",
            "detection_malicious_powershell_process_obfuscation_techniques",
            "suspicious_network_exploration"
         ],
         "alertvolume" : "Low",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "mitre_tactic" : "TA0005",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Fake Windows Processes - Demo"
            },
            {
               "name" : "Fake Windows Processes - Live",
               "label" : "Live Data"
            }
         ],
         "app" : "Splunk_Security_Essentials",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "highlight" : "Yes",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection"
      },
      "detection_malicious_powershell_process_execpolicy" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "mitre_tactic" : "TA0002",
         "journey" : "Stage_3",
         "story" : "DHS Report TA18-074A",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "category" : "Malware",
         "released" : "2.2.0",
         "help" : "This search looks for PowerShell processes that were launched using a parameter designed to bypass the local PowerShell execution policy. By default, the policy is set to \"Restricted,\" which disables the execution of PowerShell scripts. In environments that make heavy use of PowerShell, the policy can be set to allow only scripts signed by a trusted publisher. Malicious PowerShell use almost always includes the parameter <code>-ExecutionPolicy bypass</code>. PowerShell is very liberal when it comes to interpreting command-line parameters passed to it. For example, the parameter we look for, <code>-ExecutionPolicy</code>, can be abbreviated to <code>-Execution</code>, <code>-Exec</code>, or even <code>-ex</code>. As such, we look for <code>* -ex*</code>, which should catch all variations of this parameter, followed by the keyword <code>bypass</code>. This search will return the host, the user the process ran under, the process and its command-line arguments, the number of times it has seen this process, and the first and last times it saw this process.",
         "name" : "Malicious PowerShell Process - Execution Policy Bypass",
         "includeSSE" : "Yes",
         "mitre" : "Execution",
         "domain" : "Endpoint",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Command and Control|Actions on Objective",
         "description" : "This search looks for PowerShell processes started with parameters used to bypass the local execution policy for scripts. These parameters are often observed in attacks leveraging PowerShell scripts as they override the default PowerShell execution policy.",
         "mitre_technique" : "T1086|T1064",
         "search_name" : "ESCU - Malicious PowerShell Process - Execution Policy Bypass - Rule"
      },
      "detection_powershell_read_from_lsass" : {
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Credential Dumping",
         "journey" : "Stage_1",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0006",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "search_name" : "ESCU - Detect Mimikatz Via PowerShell And EventCode 4663 - Rule",
         "mitre_technique" : "T1003",
         "description" : "This search looks for PowerShell reading lsass memory consistent with credential dumping.",
         "help" : "This search looks for Windows Event Code(signature_id) 4663 (object access), where the process performing the access is PowerShell.exe, the target process of the access is lsass.exe, and the access mask is given as 0x10. This is consistent with the use of PowerShell to execute Mimikatz using sekurlsa::logonpasswords. It will return the host where the activity occurred, the process and associated id, the enabled privilege, and the message in the event.",
         "category" : "Adversary Tactics",
         "released" : "2.2.0",
         "domain" : "Access",
         "mitre" : "Credential Access",
         "includeSSE" : "Yes",
         "name" : "Detect Mimikatz Via PowerShell And EventCode 4663"
      },
      "suspicious_data_movement" : {
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "mitre_tactic" : "|TA0008|TA0009|TA0010",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "journey" : "Stage_6",
         "app" : "Splunk_User_Behavior_Analytics",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Network Communication",
         "highlight" : "Yes",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "icon" : "UBA_Use_Case.png",
         "category" : "Lateral Movement|Endpoint Compromise|Data Exfiltration",
         "released" : "2.0.0",
         "help" : "Help not needed -- UBA Use Case",
         "includeSSE" : "Yes",
         "name" : "Suspicious Data Movement",
         "mitre" : "",
         "domain" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Analyzes different types of data transfers per device and per account, both LAN and WAN, to identify unusual data movements. For example, the model monitors both inter firewall-zones LAN transfers and transfers to different countries and marks transfers that deviate from baseline.",
         "mitre_technique" : "|T1105|T1213|T1039|T1041|T1048"
      },
      "detection_spike_aws_api_call_per_account" : {
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS User Monitoring",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0006|TA0002",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "mitre_notes" : "MITRE ATT&CK enterprise does not have good cataloging of cloud based activity.",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "search_name" : "ESCU - Detect Spike in AWS API Activity - Rule",
         "description" : "This search will detect users creating spikes of API activity in your AWS environment.  It will also update the cache file that factors in the latest data.",
         "help" : "This search and its corresponding subsearch run through a series of steps, as per the following: <ol><li>Retrieves all the AWS CloudTrail log entries that have recorded AWS API calls.</li><li>Kicks off a subsearch that retrieves the same data and pulls out the ARN into a more friendly format.</li><li>Counts the number of API calls per ARN.</li><li>Loads the cache file that contains the number of data points, the count from the latest hour, the API call average, and the standard deviation for each ARN.</li><li>Drops the count from the latest hour, since it is not necessary, and merges the rest of the data with the results of the stats command. </li><li>Renames <code>apiCalls</code> as <code>latestCount</code>.</li><li>Calculates the new average value for each ARN with the latest count, weighting the past much more heavily than the current hour. It does the same for the standard deviation--weighting the past more heavily than the current.</li><li>Updates the cache file with the latest results.</li><li>Sets the minimum threshold for the number of data points and sets the number of standard deviations away from the mean it must be to be considered a spike.</li><li>Makes a determination regarding whether or not the current count is a spike by checking to see if the minimum data-point threshold has been met and the count is a sufficient number of standard deviations away from the average.</li><li>Filters out anything that it determines is not a spike and returns the list of ARNs to the main search. </li></ol>The main search subsequently gets the names of all the API calls, the number of unique API calls, and the total number of API calls for each of these ARNs. Finally, it looks up the average and standard deviation and returns both the average and the number of standard deviations the spike is from the average.",
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS",
         "domain" : "Network",
         "mitre" : "Credential Access|Execution",
         "includeSSE" : "Yes",
         "name" : "Detect Spike in AWS API Activity"
      },
      "multiple_box_logins" : {
         "mitre_tactic" : "",
         "data_source_categories" : "VendorSpecific-Box",
         "journey" : "Stage_4",
         "app" : "Splunk_User_Behavior_Analytics",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "UBA_Use_Case.png",
         "mitre_notes" : "This is too generic to map to a specific technique. ",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "dropbox google drive",
         "killchain" : "None",
         "description" : "Detects outliers in the timeseries of Box login successes per Box user.",
         "mitre_technique" : "",
         "released" : "2.2.0",
         "category" : "Endpoint Compromise|Threat Intelligence",
         "help" : "Help not needed -- UBA Use Case",
         "includeSSE" : "Yes",
         "name" : "Multiple Box Logins",
         "mitre" : "",
         "domain" : "Other"
      },
      "detection_aws_cloud_provisioning_from_previously_unseen_country" : {
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS Suspicious Provisioning Activities",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "hasSearch" : "No",
         "killchain" : "",
         "searchKeywords" : "",
         "description" : "This search looks for AWS provisioning activities from previously unseen countries. Provisioning activities are defined broadly as any event that begins with \"Run\" or \"Create.\" ",
         "mitre_technique" : "",
         "search_name" : "ESCU - AWS Cloud Provisioning From Previously Unseen Country - Rule",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "help" : "The subsearch returns all events with event names that start with \"Run\" or \"Create,\" and then does a <code>GeoIP</code> lookup on the IP address that initiated the action within the last hour. It appends the historical data to those results in the lookup file. Next, it recalculates the <code>firstTime</code> and <code>lastTime</code> field for each country, region, city, and IP address and outputs this data to the lookup file to update the local cache. It then calculates the <code>firstTime</code> and <code>lastTime</code> for each country. It returns only those events from countries that have first been seen in the past hour. This is combined with the main search to return the time, user, IP address, city, event name, and error code from the action.",
         "name" : "AWS Cloud Provisioning From Previously Unseen Country",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : ""
      },
      "showcase_git_downloads" : {
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Web Server",
         "highlight" : "No",
         "usecase" : "Insider Threat|Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "data_source_categories" : "DS014WebServer-ET03SourceCode",
         "mitre_tactic" : "TA0009",
         "examples" : [
            {
               "name" : "Git File Views or Downloads Per Day - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Git File Views or Downloads Per Day - Live",
               "label" : "Live Data"
            },
            {
               "name" : "Git File Views or Downloads Per Day - Accelerated",
               "label" : "Accelerated with Data Models"
            }
         ],
         "journey" : "Stage_3",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "High",
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Git File Views or Downloads Per Day - Demo",
         "description" : "<p>Find users who have downloaded more files from git than normal.</p><p><b>Alert Volume:</b> High</p>",
         "SPLEase" : "Hard",
         "mitre_technique" : "|T1213",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "name" : "Increase in Source Code (Git) Downloads",
         "includeSSE" : "Yes",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>This search will have a high number of noise based on the bursty nature of source code access. When someone first clones a repository, they will go off the map. This search provides contextual data to record when these big bursts of activity occur.</p>",
         "mitre" : "Collection",
         "domain" : "Data",
         "relevance" : "Similar to some of the other examples, like <a href=\"/app/Splunk_Security_Essentials/showcase_standard_deviation?ml_toolkit.dataset=Pages%20Printed%20Per%20User%20Per%20Day%20-%20Demo\">Increase in Pages Printed</a>, the behavior of users with access to sensitive intellectual property like source code should be monitored for patterns of data exfiltration. Developers are always going to interact with source code repositories like Git, but if their accesses increase in a statistically significant manner this may represent the exfiltration of source code. It is particularly interesting to correlate this behavior to a watchlist which may contain the user IDs of personnel that are considered higher risk: contractors, new employees, employees that never go on vacation, employees with access to particularly sensitive source code.",
         "category" : "Data Exfiltration",
         "released" : "1.0.0",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our demo dataset is an anonymized collection of source code checkout logs from a git server. For this analysis, we are tracking the total number of files the user has downloaded per day 'count by user _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and validate the user account accessing the specific repos. Contact the user and their manager to determine if it is authorized, and make a note if it is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as repositories hold sensitive source code.</p><p><i>Note</i>: We include an accelerated version to show how this would work, but there is no data model for this out of the box, so you would need to build one yourself.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>"
      },
      "UC0065" : {
         "name" : "Malware detected compliance asset",
         "includeSSE" : "No",
         "mitre" : "",
         "domain" : "Endpoint",
         "category" : "Compliance|Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "description" : "Malware detection on an asset designated as compliance such as PCI, CIP or HIPPA requires review even when automatic cleaning has occurred.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "similarUseCases" : [
            "Basic_Malware_Outbreak",
            "Recurring_Infection_on_Host",
            "high_number_of_infected_hosts",
            "host_with_a_recurring_malware_infection",
            "host_with_multiple_infections",
            "UC0029",
            "UC0028",
            "UC0075"
         ],
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Anti-Virus",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Compliance",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "app" : "Splunk_Professional_Services"
      },
      "UC0007" : {
         "icon" : "PS_Use_Case.png",
         "usecase" : "Compliance",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Authentication",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Logon event properties could indicate account misuse, or as an indication of compromise. Compare the identified purpose of the account with the context of the logon to determine its authority.",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Access",
         "mitre" : "",
         "name" : "Account logon successful method outside of policy",
         "includeSSE" : "No",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Compliance",
         "released" : "2.0.0"
      },
      "detection_uncommon_processes" : {
         "search_name" : "ESCU - Uncommon Processes On Endpoint - Rule",
         "mitre_technique" : "T1015|TA0002",
         "SPLEase" : "None",
         "description" : "This search looks for applications on the endpoint that you have marked as prohibited.",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "includeSSE" : "Yes",
         "name" : "Uncommon Processes On Endpoint",
         "help" : "This search returns the number of times, as well as the first and last time, it has seen every process run for each endpoint and user, and then displays only those processes that you have marked as prohibited in the Enterprise Security 'interesting processes' table.",
         "category" : "Unauthorized Software",
         "released" : "2.0.0",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Unusual Processes",
         "journey" : "Stage_4",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "mitre_tactic" : "TA0002",
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case"
      },
      "account_deleted" : {
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "datasource" : "Audit Trail",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "No",
         "app" : "Splunk_App_for_Enterprise_Security",
         "data_source_categories" : "DS006UserActivity-ET05Delete",
         "mitre_tactic" : "|TA0005",
         "journey" : "Stage_2",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1070",
         "search_name" : "Access - Account Deleted - Rule",
         "description" : "Detects user and computer account deletion",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Access",
         "includeSSE" : "Yes",
         "name" : "Account Deleted",
         "help" : "Help not needed -- ES Use Case",
         "category" : "Lateral Movement",
         "released" : "2.0.0"
      },
      "showcase_new_runas" : {
         "mitre" : "Privilege Escalation",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts or systems), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
         "relevance" : "Privileged escalation on a Windows endpoint is often done via scheduled tasks, the at command, or RunAs. Since malware often requires elevated privileges to install or to perform certain actions, any unusual occurrence of the 4648 event should be tracked. 4648 will always precede a 4624 event assuming that the escalation is successful. Sometimes you will see ‘consent.exe’ in the process name for the 4648 event - this is the UAC pop-up dialog.",
         "domain" : "Access",
         "name" : "New RunAs Host / Privileged Account Combination",
         "includeSSE" : "Yes",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the creation, as well as the user account and system, credentials that were used, process executed and other pertinent information. Contact the owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch with explicit credentials events (Windows Event ID 4648). We check the first time that's occurred per username, per host, and then alert if that was in the last day.</p>",
         "released" : "1.0.0",
         "category" : "Account Compromise",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1053|T1078",
         "description" : "<p>Privilege escalation (either via RunAs or Scheduled Tasks) create Windows Security EventID 4648 events. This search will find new usernames / host combinations, which will track privilege escalation.</p><p><b>Alert Volume:</b> Medium</p>",
         "searchKeywords" : "",
         "killchain" : "Installation",
         "hasSearch" : "Yes",
         "alertvolume" : "Medium",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New RunAs - Demo",
         "usecase" : "Security Monitoring",
         "icon" : "Core_Use_Case.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0004",
         "data_source_categories" : "VendorSpecific-winsec",
         "examples" : [
            {
               "name" : "New RunAs - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "New RunAs - Live"
            }
         ],
         "journey" : "Stage_1"
      },
      "detection_process_with_spaces_before_extension" : {
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "search_name" : "ESCU - Execution of File With Spaces Before Extension - Rule",
         "mitre_technique" : "T1042|T1151",
         "description" : "This search looks for processes launched from files with at least five spaces in the name before the extension. This is typically done to obfuscate the file extension by pushing it outside of the default view.",
         "help" : "This search uses the endpoint data model to look for process names with at least five spaces between the file name and its extension.",
         "released" : "2.2.0",
         "category" : "Malware",
         "domain" : "Endpoint",
         "mitre" : "Execution|Persistence",
         "name" : "Execution of File With Spaces Before Extension",
         "includeSSE" : "Yes",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Windows File Extension and Association Abuse",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0002|TA0003",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "excessive_dns_failures" : {
         "description" : "Alerts when a host receives many DNS failures in a short span",
         "mitre_technique" : "|T1071|T1049",
         "search_name" : "Network - Excessive DNS Failures - Rule",
         "SPLEase" : "Accelerated",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Excessive DNS Failures",
         "domain" : "Network",
         "mitre" : "",
         "category" : "Command and Control|Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- ES Use Case",
         "highlight" : "No",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "DNS",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_3",
         "mitre_tactic" : "|TA0011|TA0007",
         "data_source_categories" : "DS002DNS-ET01Query",
         "app" : "Splunk_App_for_Enterprise_Security",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case"
      },
      "detection_malicious_powershell_process_obfuscation_techniques" : {
         "killchain" : "Command and Control|Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "T1086|T1027",
         "search_name" : "ESCU - Malicious PowerShell Process With Obfuscation Techniques - Rule",
         "SPLEase" : "None",
         "description" : "This search looks for PowerShell processes launched with arguments that have characters indicative of obfuscation on the command-line.",
         "help" : "This search looks for PowerShell processes that are passing command-line arguments with unusual characters (backticks and carets) that are PowerShell specific escape characters. Attackers use this obfuscation technique since it does not affect the functionality of PowerShell and it will bypass standard security controls that look for straight up malicious strings and commands. The search counts the occurrence of these obfuscation characters and lists out destination IPs running these PowerShell commands.",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "name" : "Malicious PowerShell Process With Obfuscation Techniques",
         "includeSSE" : "Yes",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Malicious PowerShell",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0002|TA0005",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "Yes",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "relatedUseCases" : [
            "detection_registry_persistence",
            "sser_fake_windows_processes",
            "suspicious_network_exploration"
         ],
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "high_number_of_infected_hosts" : {
         "domain" : "Endpoint",
         "mitre" : "",
         "name" : "High Number Of Infected Hosts",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "search_name" : "Endpoint - High Number Of Infected Hosts - Rule",
         "mitre_technique" : "",
         "SPLEase" : "Accelerated",
         "description" : "Alerts when a high total number of infected hosts is discovered.",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "similarUseCases" : [
            "Basic_Malware_Outbreak",
            "Recurring_Infection_on_Host",
            "host_with_a_recurring_malware_infection",
            "host_with_multiple_infections",
            "UC0029",
            "UC0028",
            "UC0075",
            "UC0065"
         ],
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : "Not an attacker technique",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "highlight" : "Yes",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Anti-Virus",
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_2",
         "mitre_tactic" : "",
         "data_source_categories" : "DS004EndPointAntiMalware-ET01SigDetected"
      },
      "detection_process_with_double_extension" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0002|TA0003",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Windows File Extension and Association Abuse",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "category" : "Malware",
         "released" : "2.2.0",
         "help" : "This search uses the \"Application State\" data model to look for process names with specific combinations of double extensions. Relatively straightforward, the search looks for strings in the \"process\" field that match what you're looking for.",
         "name" : "Execution of File with Multiple Extensions",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Execution|Persistence",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "This search looks for processes launched from files that have double extensions in the file name. This is typically done to obscure the \"real\" file extension and make it appear as though the file being accessed is a data file, as opposed to executable content.",
         "mitre_technique" : "T1042",
         "search_name" : "ESCU - Execution of File with Multiple Extensions - Rule"
      },
      "detection_change_file_association" : {
         "name" : "Suspicious Changes to File Associations",
         "includeSSE" : "Yes",
         "mitre" : "Persistence",
         "domain" : "Endpoint",
         "released" : "2.2.0",
         "category" : "Malware",
         "help" : "This search looks for changes made to the registry that control Windows file associations. It is typical for users to change the file association to open certain types of files with specific applications. However, when these changes are legitimately performed, they are typically done via the processes explorer.exe or openwith.exe. The search first executes the subsearch that looks at the Registry node, which specifies setting a value in the registry and creates a table of process_id and dest. It then uses those arguments to find out what process and parent process were responsible for making those registry changes.",
         "description" : "This search looks for changes to registry values that control Windows file associations, executed by a process that is not typical for legitimate, routine changes to this area.",
         "mitre_technique" : "T1042",
         "search_name" : "ESCU - Suspicious Changes to File Associations - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "TA0003",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch",
         "journey" : "Stage_3",
         "story" : "Windows File Extension and Association Abuse",
         "app" : "Enterprise_Security_Content_Update"
      },
      "period_with_unusual_ad_activity_sequences" : {
         "hasSearch" : "No",
         "searchKeywords" : "markov markovchain chain",
         "killchain" : "None",
         "description" : "Correlates the rate of subtle changes in Active Directory behavior for each account. The correlation happens with: (a) each account's historic profile, and (b) with the activity of other accounts in the enterprise.",
         "mitre_technique" : "|T1078",
         "released" : "2.0.0",
         "category" : "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
         "help" : "Help not needed -- UBA Use Case",
         "name" : "Period with Unusual Windows Security Event Sequences",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Other",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "|TA0003|TA0004|TA0001",
         "journey" : "Stage_6",
         "app" : "Splunk_User_Behavior_Analytics",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "Yes",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other"
      },
      "detection_dragonfly_schtasks" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "This search looks for flags passed to schtasks.exe on the command-line that indicate a task name associated with the Dragonfly threat actor was created or deleted.",
         "mitre_technique" : "T1053",
         "search_name" : "ESCU - Scheduled Task Name Used by Dragonfly Threat Actors - Rule",
         "released" : "2.2.0",
         "category" : "Malware",
         "help" : "The search looks for execution of schtasks.exe with parameters that indicate that a specific task \"reset,\" whose name is associated with the Dragonfly threat actor--has been created or deleted. Schtasks.exe is a native Windows program that is used to schedule tasks on local or remote systems. Attackers often leverage this capability to schedule the execution of commands or establish persistence.",
         "includeSSE" : "Yes",
         "name" : "Scheduled Task Name Used by Dragonfly Threat Actors",
         "mitre" : "Execution",
         "domain" : "Endpoint",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "mitre_tactic" : "TA0002",
         "journey" : "Stage_3",
         "story" : "DHS Report TA18-074A",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "UC0100" : {
         "includeSSE" : "No",
         "name" : "Newly Seen File Successfully Executed by Web Application",
         "mitre" : "",
         "domain" : "Network",
         "category" : "Web Attack",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "description" : "Host and Network IDS event categories, detect events with a category of 'backdoor' or 'trojan' followed by a signature categorized as 'post exploit' on a given host or network within a given time period.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "datasource" : "Web Server",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Application Security",
         "mitre_tactic" : "",
         "journey" : "Stage_2",
         "app" : "Splunk_Professional_Services"
      },
      "detection_overwrite_accessibility_binaries" : {
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "mitre_technique" : "|T1015",
         "search_name" : "ESCU - Overwriting Accessibility Binaries - Rule",
         "description" : "Microsoft Windows contains accessibility features that can be launched with a key combination before a user has logged in. An adversary can modify or replace these programs so they can get a command prompt or backdoor without logging in to the system. This search looks for modifications to these binaries.",
         "help" : "This search returns all the different accessibility binaries that have been modified for each Windows host.",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "mitre" : "Persistence",
         "domain" : "Endpoint",
         "name" : "Overwriting Accessibility Binaries",
         "includeSSE" : "Yes",
         "story" : "Windows Privilege Escalation",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0003|TA0004",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "journey" : "Stage_3",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "highlight" : "No",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low"
      },
      "showcase_spike_in_outgoing_email" : {
         "name" : "User with Increase in Outgoing Email",
         "includeSSE" : "Yes",
         "mitre" : "Exfiltration",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
         "domain" : "Network",
         "category" : "Data Exfiltration|Endpoint Compromise|SaaS",
         "released" : "1.2.0",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the event, the sender, recipient, subject or the mail and attachments, if any. Contact the sender. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of email logs centered around a particular user for a month.</p>",
         "description" : "<p>Both to detect data exfiltration and compromised account, we can analyze users that are sending out dramatically more data than normal. This search looks per source email address for big increases in volume.</p><p><b>Alert Volume:</b> Low</p>",
         "SPLEase" : "Hard",
         "mitre_technique" : "|T1048",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "alertvolume" : "Low",
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Spike in Email from Address - Demo",
         "relatedUseCases" : [
            "detection_email_attachments_with_spaces",
            "showcase_external_emails_with_internal_domain",
            "high_volume_email_activity_to_noncorporate_domains_by_user",
            "detection_suspicious_email_attachments",
            "UC0004"
         ],
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/user_increase_outgoing_email.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Email",
         "highlight" : "Yes",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "icon" : "Core_Use_Case.png",
         "mitre_tactic" : "TA0010",
         "data_source_categories" : "DS001MAIL-ET03Send",
         "examples" : [
            {
               "name" : "Spike in Email from Address - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Spike in Email from Address - Live"
            }
         ],
         "journey" : "Stage_3",
         "app" : "Splunk_Security_Essentials"
      },
      "watchlisted_event_observed" : {
         "alertvolume" : "Other",
         "mitre_notes" : "too broad",
         "dashboard" : "ES_Use_Case",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk App for Enterprise Security",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Other",
         "journey" : "Stage_4",
         "data_source_categories" : "VendorSpecific-AnySplunk",
         "mitre_tactic" : "",
         "app" : "Splunk_App_for_Enterprise_Security",
         "name" : "Watchlisted Event Observed",
         "includeSSE" : "Yes",
         "domain" : "Threat",
         "mitre" : "",
         "released" : "2.0.0",
         "category" : "Other",
         "help" : "Help not needed -- ES Use Case",
         "description" : "Alerts when an event is discovered including text has been identified as important. This rule triggers whenever an event is discovered with the tag of &quot;watchlist&quot;.",
         "mitre_technique" : "",
         "search_name" : "Threat - Watchlisted Events - Rule",
         "SPLEase" : "Advanced",
         "hasSearch" : "No",
         "searchKeywords" : ""
      },
      "substantial_increase_in_events" : {
         "includeSSE" : "Yes",
         "name" : "Substantial Increase In Events",
         "domain" : "Network",
         "mitre" : "",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise|Operations",
         "help" : "Help not needed -- ES Use Case",
         "description" : "Alerts when a statistically significant increase in a particular event is observed.",
         "mitre_technique" : "",
         "SPLEase" : "Accelerated",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "alertvolume" : "Other",
         "mitre_notes" : "Not an attacker technique",
         "dashboard" : "ES_Use_Case",
         "highlight" : "No",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Vendor-Specific Data",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_2",
         "mitre_tactic" : "",
         "data_source_categories" : "VendorSpecific-AnySplunk",
         "app" : "Splunk_App_for_Enterprise_Security"
      },
      "risky_events_from_privileged_users" : {
         "knownFP" : "This search can inherently generate false positives because it opens the door to alerting users to low confidence events that occur to privileged users. You will need to tune the underlying search, or potentially filter for a certain risk score to manage these false positives.",
         "mitre" : "",
         "relevance" : "There are many searches that you would not normally want to analyze... except when they occur to your most privileged users. A high entropy process starting in a weird location is probably software installation that only really matters when combined with other events, but it's best to double check when it's occurring on the laptop belonging to the CEO's Executive Assistant. By combining a list of risky events (generated through the Enterprise Security risk framework, or your own version thereof) with a list of privileged users, you can easily prioritize those events.",
         "domain" : "Threat",
         "name" : "Risky Events from Privileged Users",
         "includeSSE" : "Yes",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of events from the risk index of a demo environment for Splunk Enterprise Security. The risk index provides a way to track \"risky\" events that aren't necessarily significant enough to send to a SOC analyst (along with aggregating the overall volume of events for a given user). Our live search looks for the same behavior using the standard sourcetypes. See How to Implement if you do not use Enterprise Security.",
         "operationalize" : "See the response guidance for the underlying searches that generate the original events.",
         "howToImplement" : "<p>Implementation of this search depends on two key components -- a list of risky events, and a list of privileged users.</p><p>You can use almost anything to generate a list of risky events -- in fact that's the desired intent for most medium-or-higher alert volume searches in Splunk Security Essentials! Most customers who go down this path will use the Enterprise Security Risk Framework to aggregate these events, though you can also 'roll your own' risk framework with Summary Indexing.</p><p>Generating a list of risky users is complicated -- that's why one of the most detailed examples in Splunk Security Essentials takes this on! Check it out! (<a href=\"/app/Splunk_Security_Essentials/showcase_simple_search?ml_toolkit.dataset=Pull%20List%20of%20Privileged%20Users%20-%20Demo\" target=\"_blank\">link</a>).</p><p>Once you have these components, implementation of this detection is straightforward.</p>",
         "released" : "2.2.0",
         "category" : "Insider Threat|IAM Analytics",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1078",
         "description" : "When something generally risky occurs to your most privileged users, you likely should respond more quickly. Fortunately, this is easy to do.",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/risky_events_from_privileged_users.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Risky Events from Privileged Users - Demo",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat|Security Monitoring",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Ticketing System",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "|TA0003|TA0004",
         "data_source_categories" : "DS013TicketManagement-ET02LowLevelEvents",
         "journey" : "Stage_4",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Risky Events from Privileged Users - Demo"
            },
            {
               "name" : "Risky Events from Privileged Users - Live",
               "label" : "Live Data"
            }
         ]
      },
      "threat_activity_detected" : {
         "SPLEase" : "Advanced",
         "mitre_technique" : "|T1071|T1094",
         "search_name" : "Threat - Threat List Activity - Rule",
         "description" : "Alerts when any activity matching threat intelligence is detected.",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Threat",
         "gdprtext" : "<h4>Problem:</h4><p>Threat activity can indicate a high-priority risk. As an example, compromised hosts may be attempting to communicate with malicious command and control servers. Threat activity detected can represent a range of potential security issues that may be unpredictable and difficult to know how to handle – in the above example, it may not be clear whether the communication is simply beaconing or sensitive data is being exfiltrated.</p><h4>Impact:</h4><p>Early detection of threat activity is critical to effective and timely response. This is a security best practice.</p><p>Specific to the GDPR, organizations must collect the full audit trail of data processing activities of involved systems and applications, and document, investigate, and report any data breach. Threat activity indicates a potential breach and therefore high-risk situation for personal data. Detection and awareness of threat activity is critical to respond in a timely manner, within the 72-hr deadline of GDPR, as well as to maintain compliance requirements of GDPR. If detection indicates a condition of high risk and non-compliance, then it needs to be documented, remediated, and potentially investigated and reported. Lacking the ability to detect personal data can impact the organization via a wide array of GDPR articles, including Article 15 (individuals have the right to ask an organization where their data is stored); proving that only authorized individuals have accessed personal data (Article 28), and documenting and reporting unauthorized access to the data privacy authorities; regularly testing, assessing and evaluating effectiveness of implemented technical and organizational security controls (Article 32); and demonstrating compliance within the scope of a privacy audit (Article 58); maintaining a record of processing activities (Article 30); ensuring legitimate access and lawful intended use and processing (Article 6); verifying and proving erasure of data (Article 17); restricting the processing of personal data to a limited set of reasons (Article 18 and Article 21); compliance to right of access requirements including by contractors or sub-processors (Article 15); compliance to subject rights regarding automated decision making processes (Article 22); </p><p>If the organization faces a personal data breach, potential impact includes reporting within the 72-hr deadline with full context of what happened within the incident, as well as proving to individuals demanding compensation that the organizations has understood and addressed the risk appropriately and deployed proper countermeasures (Article 82); and Article 33 requires organizations to inform the authorities, including details about the nature of the breach -- the same requirement exists within Article 34, that organizations must identify which individuals are affected.</p>",
         "name" : "Threat Activity Detected",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Threat Intelligence|GDPR",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "datasource" : "Email|DNS|Web Proxy|Endpoint Detection and Response|Network Communication|Malware Detonation",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "Yes",
         "app" : "Splunk_App_for_Enterprise_Security",
         "mitre_tactic" : "|TA0011",
         "data_source_categories" : "DS001MAIL-ET02Receive|DS002DNS-ET01QueryRequest|DS005WebProxyRequest-ET01Requested|DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS009EndPointIntel-ET04ProcessLaunchWithHash|DS010NetworkCommunication-ET01Traffic|DS011MalwareDetonation-ET01Detection",
         "journey" : "Stage_4",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : ""
      },
      "UC0092" : {
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Network Communication|Host-based IDS",
         "highlight" : "No",
         "usecase" : "Application Security",
         "icon" : "PS_Use_Case.png",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "app" : "Splunk_Professional_Services",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "description" : "Using web application access logs for assets deemed high/critical or with the governance attributed ensure the source IP address is one of the approved NLB or WAF devices. If WAF devices are placed in front of NLB devices ensure the first &quot;x-forwardedfor&quot; entry is the address of the WAF.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "includeSSE" : "No",
         "name" : "Exception to Approved Flow for Web Applications",
         "mitre" : "",
         "domain" : "Network",
         "released" : "2.0.0",
         "category" : "Web Attack",
         "help" : "Help not needed -- PS Use Case"
      },
      "detection_aws_cloud_provisioning_from_previously_unseen_region" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "",
         "description" : "This search looks for AWS provisioning activities from previously unseen regions. Region in this context is similar to a state in the United States. Provisioning activities are defined broadly as any event that begins with \"Run\" or \"Create.\"",
         "mitre_technique" : "",
         "search_name" : "ESCU - AWS Cloud Provisioning From Previously Unseen Region - Rule",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "help" : "The subsearch returns all events with event names that start with \"Run\" or \"Create,\" and then does a <code>GeoIP</code> lookup on the IP address that initiated the action within the last hour. It appends the historical data to those results in the lookup file. Next, it recalculates the <code>firstTime</code> and <code>lastTime</code> field for each country, region, city, and IP address and outputs this data to the lookup file to update the local cache. It then calculates the <code>firstTime</code> and <code>lastTime</code> for each city. It returns only those events from regions that have first been seen in the past hour. This is combined with the main search to return the time, user, IP address, city, event name, and error code from the action.",
         "name" : "AWS Cloud Provisioning From Previously Unseen Region",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Endpoint",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "story" : "AWS Suspicious Provisioning Activities",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "detection_powershell_get_sedebug" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0006",
         "journey" : "Stage_1",
         "story" : "Credential Dumping",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "released" : "2.2.0",
         "category" : "Adversary Tactics",
         "help" : "This search looks for Windows Event Code(signature_id) 4703 (token right adjusted), where the process requesting the token change is PowerShell.exe and the requested privilege is \"SeDebugPrivilege\". This is consistent with the use of PowerShell to execute Mimikatz using sekurlsa::logonpasswords. It will return the host where the activity occurred, the process and associated id, the enabled privilege, and the message in the event.",
         "name" : "Detect Mimikatz Via PowerShell And EventCode 4703",
         "includeSSE" : "Yes",
         "mitre" : "Credential Access",
         "domain" : "Access",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "This search looks for PowerShell requesting privileges consistent with credential dumping.",
         "search_name" : "ESCU - Detect Mimikatz Via PowerShell And EventCode 4703 - Rule",
         "mitre_technique" : "T1003"
      },
      "UC0004" : {
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "datasource" : "Email",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "relatedUseCases" : [
            "detection_email_attachments_with_spaces",
            "showcase_external_emails_with_internal_domain",
            "showcase_spike_in_outgoing_email",
            "high_volume_email_activity_to_noncorporate_domains_by_user",
            "detection_suspicious_email_attachments"
         ],
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Excessive email generation by authorized users could indicate the presence of malware designed to send spam, or abuse company resources. An application owner, or admin could also be attempting to solve a business problem outside of company policy. This use case focuses on email that is generated from endpoint networks. Operating systems should also be considered since servers can use user credentials to send messages; when this is allowed, false positives could be generated.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Network",
         "name" : "Excessive number of emails sent from internal user",
         "includeSSE" : "No",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Data Exfiltration|Lateral Movement|Endpoint Compromise",
         "released" : "2.0.0"
      },
      "activity_from_expired_user_identity" : {
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "|T1078",
         "search_name" : "Identity - Activity from Expired User Identity - Rule",
         "SPLEase" : "Medium",
         "description" : "Alerts when an event is discovered from a user associated with identity that is now expired (that is, the end date of the identity has been passed).",
         "help" : "Help not needed -- ES Use Case",
         "category" : "Insider Threat",
         "released" : "2.0.0",
         "domain" : "Identity",
         "mitre" : "",
         "name" : "Activity from Expired User Identity",
         "includeSSE" : "Yes",
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_2",
         "mitre_tactic" : "|TA0001|TA0003",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "usecase" : "Insider Threat|Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "highlight" : "Yes",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Authentication",
         "similarUseCases" : [
            "UC0014",
            "Basic_Expired_Account"
         ],
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other"
      },
      "AWS_Instance_Created_by_Unusual_User" : {
         "released" : "2.0.0",
         "category" : "Account Compromise|IAM Analytics|SaaS",
         "operationalize" : "When this alert fires, call the user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred.",
         "howToImplement" : "Assuming you use the ubiquitous AWS Add-on for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
         "help" : "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, as detailed in How to Implement.",
         "name" : "AWS Instance Created by Unusual User",
         "includeSSE" : "Yes",
         "relevance" : "The risk that this detection intends to reduce is the compromise of an AWS environment, where all of a sudden instance creation occurs from a user that isn't known to provision accounts. Assuming that the user has not changed roles, and that new orchestration tools are not being used, this would suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential cost run-up or other activities.",
         "domain" : "Access",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>For this use case, you probably don't care every time a new user starts creating instances in a large environment, but you may care when they change resources in sensitive VPCs. Smaller organizations with a limited number of admins would likely care the minute that a new account is created. For all organizations, having this data around for context or to aggregate risk is extremely useful!",
         "mitre" : "Credential Access",
         "hasSearch" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "cloudtrail",
         "description" : "Detects the first time a user creates a new instance.",
         "mitre_technique" : "|T1078",
         "SPLEase" : "Medium",
         "relatedUseCases" : [
            "AWS_Cloud_Provisioning_Activity_from_Unusual_Country",
            "AWS_New_API_Call_Per_User",
            "AWS_Unusual_Amount_of_Modifications_to_ACLs"
         ],
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=AWS Instance Created by Unusual User - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_instance_created_unusual_user.png",
         "alertvolume" : "Medium",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "AWS Instance Created by Unusual User - Demo"
            },
            {
               "name" : "AWS Instance Created by Unusual User - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0003|TA0004",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "Yes",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection"
      },
      "abnormally_high_number_of_endpoint_changes_by_user" : {
         "includeSSE" : "Yes",
         "name" : "Abnormally High Number of Endpoint Changes By User",
         "mitre" : "",
         "domain" : "Endpoint",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise|Ransomware",
         "help" : "Help not needed -- ES Use Case",
         "description" : "Detects an abnormally high number of endpoint changes by user account, as they relate to restarts, audits, filesystem, user, and registry modifications.",
         "SPLEase" : "Accelerated",
         "search_name" : "Change - Abnormally High Number of Endpoint Changes By User - Rule",
         "mitre_technique" : "|T1031|T1112|T1222",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "|TA0003|TA0005",
         "journey" : "Stage_3",
         "app" : "Splunk_App_for_Enterprise_Security"
      },
      "UC0012" : {
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Insider Threat",
         "datasource" : "HR System",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "mitre" : "",
         "domain" : "Access",
         "includeSSE" : "No",
         "name" : "Increase Risk Score of Employees before Adverse Separation",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Insider Threat",
         "released" : "2.0.0",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Increase the risk score of users who have indication of adverse separation.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No"
      },
      "detection_splunk_information_disclosure" : {
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Splunk Enterprise Vulnerability CVE-2018-11409",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0005|TA0002",
         "data_source_categories" : "VendorSpecific-SplunkInternal",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "killchain" : "Delivery",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "|T1072|T1211",
         "search_name" : "ESCU - Splunk Enterprise Information Disclosure - Rule",
         "description" : "This search allows you to look for evidence of exploitation for CVE-2018-11409, a Splunk Enterprise Information Disclosure Bug.",
         "help" : "This search searches Splunk's internal logs for evidence of CVE-2018-11409 exploitation attempts.",
         "released" : "2.2.0",
         "category" : "Vulnerability",
         "domain" : "Network",
         "mitre" : "Defense Evasion",
         "includeSSE" : "Yes",
         "name" : "Splunk Enterprise Information Disclosure"
      },
      "detection_brand_abuse_email" : {
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Email",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "data_source_categories" : "DS001MAIL-ET02Receive",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Brand Monitoring",
         "alertvolume" : "Low",
         "mitre_notes" : "Need to think about this one",
         "dashboard" : "ESCU_Use_Case",
         "description" : "This search looks for emails claiming to be sent from a domain similar to one that you want to have monitored for abuse.",
         "mitre_technique" : "",
         "search_name" : "ESCU - Monitor Email For Brand Abuse - Rule",
         "SPLEase" : "None",
         "hasSearch" : "No",
         "killchain" : "Delivery",
         "searchKeywords" : "",
         "name" : "Monitor Email For Brand Abuse",
         "includeSSE" : "Yes",
         "domain" : "Network",
         "mitre" : "",
         "category" : "Operations",
         "released" : "2.0.0",
         "help" : "This search looks at the sender address in email headers, and identifies those with a sender address using a domain name that matches the list of permutations generated for the domain you want to monitor."
      },
      "showcase_new_suspicious_exe_launch_for_user" : {
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the event, executable, its associated path, the system, user and other pertinent information. Contact the owner of the systems. If it is authorized, document that this is authorized and by whom. If not, the user credentials have been used by another party and additional investigation.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688) filtered for suspicious filenames (from a lookup called tools.csv). We check the first time that's occurred per path, per user, and then alert if that was in the last day.</p>",
         "includeSSE" : "Yes",
         "name" : "New Suspicious Executable Launch for User",
         "mitre" : "Discovery|Lateral Movement|Execution",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>There are no known false positives for this search apart from some custom-designed scripts and the occasional sysadmin familiar with it. Both of these should be very easy to filter out.</p>",
         "domain" : "Endpoint",
         "relevance" : "There are certain executables launched on endpoints that generally mean that someone, or something, is up to no good. For this example, we have provided a lookup file ‘tools.csv’ that among other things identifies binaries by executable name as being used for discovery or attack purposes. It may be perfectly normal for one or more of these executables to launch on a given endpoint, but if one of these executables is seen where it hasn’t been seen before, this can be considered an alert-able condition.",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Exploitation",
         "description" : "<p>Some files rarely get used by legitimate activities, such as at.exe. This search will detect those executables being launched, regardless of the circumstance. (<a href=\"https://car.mitre.org/wiki/CAR-2013-05-004\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "|TA0002|T1059",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=Suspicious Command Launch - Demo",
         "alertvolume" : "Low",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Suspicious Command Launch - Demo"
            },
            {
               "name" : "Suspicious Command Launch - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "app" : "Splunk_Security_Essentials",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png"
      },
      "UC0016" : {
         "description" : "Batch, Windows Services, App Pools, and specially constructed Windows shells can access network resources. A small number of technical solutions will require this type of behavior, however, after excluding a white list of hosts or shares (such as sysvol or netlogon), such access attempts (success or fail) could indicate the presence of malware or attempts to elevate access.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "name" : "Computer Accounts Accessing Network Resources",
         "includeSSE" : "No",
         "mitre" : "",
         "domain" : "Access",
         "released" : "2.0.0",
         "category" : "Lateral Movement|Endpoint Compromise",
         "help" : "Help not needed -- PS Use Case",
         "datasource" : "Authentication",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "app" : "Splunk_Professional_Services",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case"
      },
      "showcase_new_sfdc_event_type" : {
         "name" : "New High Risk Event Types for Salesforce.com User",
         "includeSSE" : "Yes",
         "gdprtext" : "<h4>Impact:</h4><p>First-time seen events, specifically high-risk types, can indicate unauthorized, non-compliant, and potentially malicious behavior. </p><p>Specific to GDPR, detecting first-time occurrences of high-risk behavior and proving that individuals within the organization are not abusing or misusing legitimate access to assets that store and process personal data is an industry best practice and can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). </p>",
         "domain" : "Data",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
         "mitre" : "Collection",
         "released" : "1.4.0",
         "category" : "Data Exfiltration|GDPR|SaaS",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, application and number of rows exported or viewed. If possible, determine the system the user is using and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "help" : "<p>This is the generic search builder for First Seen Detection. Our dataset is an anonymized data collection from an actual customer environment.</p>",
         "description" : "<p>Salesforce.com supports a variety of different event types in their event logs. This search detects users who suddenly query event types associated with data exfiltration</p><p><b>Alert Volume:</b> Medium</p>",
         "mitre_technique" : "|TA0010|T1102",
         "SPLEase" : "Medium",
         "hasSearch" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "salesforce sfdc",
         "alertvolume" : "Medium",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Risky Event Types Per User - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_new_event_type.png",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Compliance|Insider Threat",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "New Risky Event Types Per User - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "New Risky Event Types Per User - Live"
            }
         ],
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-sfdc-elf",
         "mitre_tactic" : "TA0010|TA0011",
         "app" : "Splunk_Security_Essentials"
      },
      "detection_excessive_lockouts_from_endpoint" : {
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Authentication",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "journey" : "Stage_1",
         "mitre_tactic" : "|TA0006",
         "data_source_categories" : "DS003Authentication-ET02Failure",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Account Monitoring and Controls",
         "alertvolume" : "High",
         "relatedUseCases" : [
            "basic_brute_force",
            "Basic_Scanning",
            "detection_excessive_user_account_lockouts",
            "showcase_many_hosts"
         ],
         "similarUseCases" : [
            "detection_excessive_user_account_lockouts"
         ],
         "dashboard" : "ESCU_Use_Case",
         "description" : "This search identifies endpoints that have caused a relatively high number of account lockouts in a short period.",
         "mitre_technique" : "T1078|T1110",
         "search_name" : "ESCU - Detect Excessive Account Lockouts From Endpoint - Rule",
         "SPLEase" : "None",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Detect Excessive Account Lockouts From Endpoint",
         "domain" : "Access",
         "mitre" : "",
         "category" : "Account Compromise",
         "released" : "2.0.0",
         "help" : "This search queries the `Change.All_Changes` datamodel under the nodename is `Account_Management` , where the result is \"lockout\", which indicates that an account has been locked out. It then counts the number of times an endpoint has caused an account lockout within a four hour window and displays those hosts with a count greater than or equal to five."
      },
      "showcase_series_discovery_tools_hashes" : {
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "mitre_tactic" : "TA0007",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "examples" : [
            {
               "name" : "Series of Discovery Hashes - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Series of Discovery Hashes - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Low",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Series of Discovery Hashes - Demo",
         "description" : "<p>It's uncommon to see many discovery tools launched on an endpoint, except in specific situations. This search will identify tools by file hash, and look for several in quick succession. (<a href=\"https://car.mitre.org/wiki/CAR-2016-03-001\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low (unless your company specifically does this)</p>",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1087|T1069|T1016|T1082|T1033|T1057|T1007",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Exploitation",
         "includeSSE" : "Yes",
         "name" : "Concentration of Discovery Tools by SHA1 Hash",
         "mitre" : "Discovery",
         "knownFP" : "<p>The most likely source of false positives for this script would be normal admin activity, particularly if you have login scripts (or periodic scripts) that enumerate information about hosts, they could show up here. The easy way to filter out these situations is to look at that scripted fingerprint and filter that out. For example, using <span class=\"code\">| where</span> (which has eval-style syntax different from <span class=\"code\">| search</span>) you could filter out <span class=\"code\">| where mvcount(sha1)=4 AND sha1=\"430AA43010EEF3CD43ED445777F3D5CCF6BC4C27\" AND sha1=\"4445BC58D64BCE3322F80690AF5405876D01C0AC\" AND sha1=\"9A544E2094273741AA2D3E7EA0AF303AF2B587EA\" AND sha1=\"EA18043FEDAF888F04C07F71F2006F3F479C0B41\"</span>.</p>",
         "domain" : "Endpoint",
         "relevance" : "Building on the two examples of surfacing concentrations of hacker or discovery tools via filename, a more accurate method for doing this is to use the SHA1 cryptographic hashes for these tools, because tools can always be renamed before executing. By correlating the process hashes being executed on endpoints with a list of 'known discovery tool executable hashes' we can detect this suspicious activity.",
         "category" : "Scanning|Endpoint Compromise",
         "released" : "1.0.0",
         "howToImplement" : "The hardest part of implementing this correctly, once you have EDR logs ingested, will be to make sure that the fields correctly set. (Why EDR? The boundary between EDR logs and Windows Security Logs for <b>most</b> Splunk customers is that Windows Process Launch Logs won't contain hashes, or the right variety of hashes, but EDR tools including the free Sysmon tool will.)<ul><li>In the live version, we start with index=* which is bad Splunk form (but makes it a little bit easier to get started). You should make sure that you specify the index where your EDR logs live (index=epintel if you follow our best practices, and the documentation in this app).</li><li>The next field you have to worry about is the sourcetype, which should be pretty standard.</li><li>The EventCode field is the second to last field you have to think about, which if you use our <a href=\"https://splunkbase.splunk.com/app/1914/\">Splunk Add-on for Sysmon</a> on your Search Head, will also work automatically for you (again, docs are key!)</li><li>Finally, Sysmon will return multiple different hashes. In order for the hashes to show up correctly in the table, make sure that you have a field named sha1 (or change the search to match what you see in the events).</ul><p>Once you have the search itself running, then you need only schedule it (click \"Schedule Alert\") and have Splunk email you, create a ticket in Enterprise Security or Service Now, or take some other action for you.",
         "operationalize" : "<p>This alert is intended to corroborate other suspicious actions in most environments, rather than being a major flag on its own. You might send this alert to your alert manager as a low or information alert so that you can search for the asset and find it later. More advanced organizations might send this alert into the ES Risk Framework (so that you can aggregate low level risk elements) or to Splunk UBA (so that the threat models can incorporate this event into their calculations).</p>",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launch logs (Event ID 4688), where we have hashing turned on (look for tools like WLS, or Sysmon to help here). It then filters for a set of filenames that are known to be discovery related (from a lookup called tools.csv) and uses the transaction command to group them by time. If there's a single transaction with many events, it surfaces those.</p>"
      },
      "showcase_spike_in_password_reset_emails" : {
         "hasSearch" : "Yes",
         "killchain" : "Delivery",
         "searchKeywords" : "",
         "description" : "<p>Sending password reset emails is a common phishing technique. Protect your users by identifying spikes in the number of suspicious emails entering your environment.</p><p><b>Alert Volume:</b> Very Low</p>",
         "mitre_technique" : "|T1192",
         "SPLEase" : "Hard",
         "category" : "Account Compromise|SaaS",
         "released" : "1.2.0",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the event, the sender, recipient, subject or the mail and attachments, if any. Contact the sender. If it is authorized behavior, make a document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of email logs centered around a particular user for a month.</p>",
         "includeSSE" : "Yes",
         "name" : "Spike in Password Reset Emails",
         "domain" : "Network",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
         "mitre" : "Initial Access",
         "examples" : [
            {
               "name" : "Spike in Password Reset Emails - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Spike in Password Reset Emails - Live"
            },
            {
               "label" : "Accelerated Data",
               "name" : "Spike in Password Reset Emails - Accelerated"
            }
         ],
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0001",
         "data_source_categories" : "DS001MAIL-ET02Receive",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Email",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring",
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Spike in Password Reset Emails - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/spike_password_reset_emails.png",
         "alertvolume" : "Very Low"
      },
      "network_change_detected" : {
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1089",
         "search_name" : "Network - Policy Or Configuration Change - Rule",
         "description" : "Detects changes to policies of the network protection devices (such as firewall policy changes).",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Network Change Detected",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Operations",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Configuration Management",
         "highlight" : "No",
         "app" : "Splunk_App_for_Enterprise_Security",
         "mitre_tactic" : "|TA0005",
         "data_source_categories" : "DS015ConfigurationManagement-ET01General",
         "journey" : "Stage_4",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : ""
      },
      "detection_remote_wmi_command_attempt" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "journey" : "Stage_3",
         "story" : "Suspicious WMI Use",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "released" : "2.0.0",
         "category" : "Lateral Movement",
         "help" : "Many a times, attackers leverage native Windows utilities that are designed to help administrators better manage their systems, infrastructure, and auditing, but are instead leveraged for malicious purposes. In this case, we are looking for instances of wmic.exe being run with various parameters that are not typically used by administrators.",
         "name" : "Remote WMI Command Attempt",
         "includeSSE" : "Yes",
         "mitre" : "Execution",
         "domain" : "Endpoint",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "This search looks for wmic.exe being launched with parameters to operate on remote systems.",
         "SPLEase" : "None",
         "search_name" : "ESCU - Remote WMI Command Attempt - Rule",
         "mitre_technique" : "T1047"
      },
      "detection_mshta_launching_scripts" : {
         "search_name" : "ESCU - Detect mshta.exe running scripts in command-line arguments - Rule",
         "mitre_technique" : "T1059",
         "description" : "This search looks for the execution of \"mshta.exe\" with command-line arguments that launch a script. The search will return the first time and last time these command-line arguments were used for these executions, as well as the target system, the user, process \"mshta.exe\" and its parent process.",
         "killchain" : "Exploitation",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Endpoint",
         "mitre" : "Execution|Persistence",
         "includeSSE" : "Yes",
         "name" : "Detect mshta.exe running scripts in command-line arguments",
         "help" : "Mshta.exe is a built-in Windows utility that can launch HTML files with .hta extensions (HTML applications), javascript, or VBScript. The search detects this behavior by looking for events where the process mshta.exe is executed with command-line arguments that indicate that a script is invoked",
         "category" : "Adversary Tactics",
         "released" : "2.2.0",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious MSHTA Activity",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0002|TA0003",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case"
      },
      "multiple_outgoing_connections" : {
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0010|TA0011",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "app" : "Splunk_User_Behavior_Analytics",
         "highlight" : "No",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Network Communication",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Insider Threat",
         "relatedUseCases" : [
            "multiple_logins",
            "excessive_data_transmission"
         ],
         "dashboard" : "UBA_Use_Case",
         "mitre_notes" : "",
         "alertvolume" : "Other",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Multiple Outgoing Connections",
         "mitre_technique" : "|T1041|T1048|T1094|T1095|T1032|T1104",
         "category" : "Lateral Movement|Account Compromise|Data Exfiltration",
         "released" : "2.0.0",
         "help" : "Help not needed -- UBA Use Case",
         "name" : "Multiple Outgoing Connections",
         "includeSSE" : "Yes",
         "domain" : "Other",
         "mitre" : ""
      },
      "detection_dns_amplification_any_query" : {
         "category" : "Denial of Service",
         "released" : "2.0.0",
         "help" : "This search counts the number of DNS ANY queries received in 5 minutes, and generates a Notable Event if the count exceeds a predefined threshold. The search returns the count, the first time, and the last time a DNS packet was observed with the ANY flag set.",
         "includeSSE" : "Yes",
         "name" : "Large Volume of DNS ANY Queries",
         "mitre" : "",
         "domain" : "Network",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "The search is used to identify attempts to use your DNS Infrastructure for DDoS purposes via a DNS amplification attack leveraging ANY queries.",
         "SPLEase" : "None",
         "search_name" : "ESCU - Large Volume of DNS ANY Queries - Rule",
         "mitre_technique" : "",
         "mitre_notes" : "Tactic or Technique around DDOS/availability?",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low",
         "mitre_tactic" : "",
         "data_source_categories" : "DS002DNS-ET01QueryRequest",
         "journey" : "Stage_3",
         "story" : "DNS Amplification Attacks",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "DNS",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Application Security"
      },
      "flight_risk_printing" : {
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/flight_risk_printing.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Flight Risk Printing - Demo",
         "alertvolume" : "Medium",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS006UserActivity-ET03Create",
         "mitre_tactic" : "TA0010",
         "journey" : "Stage_1",
         "examples" : [
            {
               "name" : "Flight Risk Printing - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Flight Risk Printing - Live",
               "label" : "Live Data"
            }
         ],
         "usecase" : "Insider Threat",
         "icon" : "Core_Use_Case.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Audit Trail",
         "highlight" : "No",
         "howToImplement" : "<p>This search implements several heuristics to look for indications that a user is a flight risk, detailed below. While most savvy employees will use a personal email address when emailing competitors, everyone in Security has some story of employees who don't.</p>",
         "operationalize" : "<p>You should likely not look at this search directly, but correlate it with other risky events via the Risk Framework in ES or the Threat Models in UBA.</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of printer logs.</p>",
         "released" : "2.2.0",
         "category" : "Insider Threat",
         "knownFP" : "<p>This search will innately generate false positives when a user prints an old copy of their resume for a new boss, or a user prints a family member's resume, or of course for managers or users in HR who will print offer letters for their explicit job duties. While you can attempt to build the correlation searches to tune out those false positives (e.g., alert when a user prints an offer letter and is not in HR and is not the hiring manager for any open positions), that can be practically very difficult. It's more common to use a flight risk alert to correlate with other risky events, such as data exfil alerts coming from your DLP or your UEBA systems.</p>",
         "mitre" : "Exfiltration",
         "relevance" : "<p>Detecting users who are about to leave, before they actually give notice, can provide you the opportunity to potentially fix the situation for an unhappy employee, but also can help you prevent the exfiltration of sensitive data (which usually happens before an employee actually gives notice). Look for the indications that an employee may be leaving, by checking printer logs.</p>",
         "domain" : "Network",
         "name" : "Flight Risk Printing",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1052",
         "description" : "<p>This search implements two heuristics to look for indications that a user is a flight risk. Many people will print offer letters, drafts of their resume, or related docs on the work environment (for convenience, or because they don't have a printer at home). Detect when that happens.</p>"
      },
      "detection_badrabbit_schtasks" : {
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0003|TA0002",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Ransomware",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "This search looks for flags passed to schtasks.exe on the command-line that indicate that task names related to the execution of Bad Rabbit ransomware were created or deleted.",
         "search_name" : "ESCU - Scheduled tasks used in BadRabbit ransomware - Rule",
         "mitre_technique" : "T1053",
         "SPLEase" : "None",
         "released" : "2.0.0",
         "category" : "Ransomware",
         "help" : "The search looks for execution of schtasks.exe with parameters that indicate that specific task names related to the Bad Rabbit ransomware were created or deleted. The specific task name used are rhaegal, drogon and viserion_. Schtasks.exe is a native windows program that is used to schedule tasks on local or remote systems. Attackers often leverage this capability to schedule the execution of commands or establish persistence.",
         "includeSSE" : "Yes",
         "name" : "Scheduled tasks used in BadRabbit ransomware",
         "domain" : "Endpoint",
         "mitre" : "Persistence|Lateral Movement|Execution"
      },
      "detection_brand_abuse_web" : {
         "category" : "Operations",
         "released" : "2.0.0",
         "help" : "This search looks at all the URLs an endpoint is connecting to and then checks the URL against a list of faux domains that could be indicative of brand abuse.",
         "includeSSE" : "Yes",
         "name" : "Monitor Web Traffic For Brand Abuse",
         "domain" : "Network",
         "mitre" : "",
         "hasSearch" : "No",
         "killchain" : "Delivery",
         "searchKeywords" : "",
         "description" : "This search looks for Web requests to faux domains similar to the one that you want to have monitored for abuse.",
         "search_name" : "ESCU - Monitor Web Traffic For Brand Abuse - Rule",
         "mitre_technique" : "|T1328",
         "SPLEase" : "None",
         "dashboard" : "ESCU_Use_Case",
         "mitre_notes" : "Not sure about brand abuse in general",
         "alertvolume" : "Low",
         "journey" : "Stage_3",
         "mitre_tactic" : "|TA0022",
         "data_source_categories" : "DS014WebServer-ET01Access|DS005WebProxyRequest-ET01Requested",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Brand Monitoring",
         "highlight" : "No",
         "datasource" : "Web Server|Web Proxy",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png"
      },
      "detection_aws_cloud_provisioning_from_previously_unseen_ip" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "",
         "description" : "This search looks for AWS provisioning activities from previously unseen IP addresses. Provisioning activities are defined broadly as any event that begins with \"Run\" or \"Create.\" ",
         "search_name" : "ESCU - AWS Cloud Provisioning From Previously Unseen IP Address - Rule",
         "mitre_technique" : "",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "help" : "The subsearch returns all events with event names that start with \"Run\" or \"Create,\" and then does a <code>GeoIP</code> lookup on the IP address that initiated the action within the last hour. It appends the historical data to those results in the lookup file. Next, it recalculates the <code>firstTime</code> and <code>lastTime</code> field for each country, region, city, and IP address and outputs this data to the lookup file to update the local cache. It then calculates the <code>firstTime</code> and <code>lastTime</code> for each city. It returns only those events from IP addresses that have first been seen in the past hour. This is combined with the main search to return the time, user, IP address, city, event name, and error code from the action.",
         "includeSSE" : "Yes",
         "name" : "AWS Cloud Provisioning From Previously Unseen IP Address",
         "mitre" : "",
         "domain" : "Endpoint",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "story" : "AWS Suspicious Provisioning Activities",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "mitre_notes" : "MITRE ATT&CK enterprise does not have good cataloging of cloud based activity.",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "inactive_account_activity_detected" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "Discovers previously inactive accounts that are now being used. This may be due to an attacker that successfully gained access to an account that was no longer being used.",
         "search_name" : "Access - Inactive Account Usage - Rule",
         "mitre_technique" : "|T1078",
         "SPLEase" : "Advanced",
         "released" : "2.0.0",
         "category" : "Insider Threat",
         "help" : "Help not needed -- ES Use Case",
         "name" : "Inactive Account Activity Detected",
         "includeSSE" : "Yes",
         "domain" : "Access",
         "mitre" : "",
         "journey" : "Stage_4",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "mitre_tactic" : "|TA0001",
         "app" : "Splunk_App_for_Enterprise_Security",
         "highlight" : "No",
         "datasource" : "Authentication",
         "displayapp" : "Splunk App for Enterprise Security",
         "usecase" : "Insider Threat|Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other"
      },
      "unusual_external_alarm" : {
         "alertvolume" : "Other",
         "mitre_notes" : "This is too generic to map to a specific technique. The alarms could be from various systems",
         "dashboard" : "UBA_Use_Case",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Insider Threat",
         "icon" : "UBA_Use_Case.png",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "DLP|IDS or IPS|Host-based IDS|Anti-Virus|Web Application Firewall",
         "highlight" : "No",
         "app" : "Splunk_User_Behavior_Analytics",
         "mitre_tactic" : "",
         "data_source_categories" : "DS016DataLossPrevention-ET01Violation|DS012NetworkIntrusionDetection-ET01SigDetection|DS020HostIntrustionDetection-ET01SigDetected|DS004EndPointAntiMalware-ET01SigDetected|DS025IPAddressAssignment-ET01General",
         "journey" : "Stage_5",
         "mitre" : "",
         "domain" : "Network|Endpoint|Threat",
         "includeSSE" : "Yes",
         "name" : "Unusual External Alarm",
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.2.0",
         "category" : "Endpoint Compromise|Network Attack",
         "mitre_technique" : "",
         "description" : "Detects external alarms (e.g., by firewalls) that have unusual characteristics.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No"
      },
      "host_sending_excessive_email" : {
         "highlight" : "No",
         "datasource" : "Email",
         "displayapp" : "Splunk App for Enterprise Security",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0001",
         "data_source_categories" : "DS001MAIL-ET03Send",
         "app" : "Splunk_App_for_Enterprise_Security",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "description" : "Alerts when an host not designated as an e-mail server sends excessive e-mail to one or more target hosts.",
         "search_name" : "Endpoint - Host Sending Excessive Email - Rule",
         "mitre_technique" : "|T1193|T1192",
         "SPLEase" : "Accelerated",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "name" : "Host Sending Excessive Email",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise|Data Exfiltration|Insider Threat",
         "help" : "Help not needed -- ES Use Case"
      },
      "UC0054" : {
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "mitre_tactic" : "",
         "journey" : "Stage_2",
         "app" : "Splunk_Professional_Services",
         "datasource" : "Web Proxy",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "category" : "Command and Control",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "includeSSE" : "No",
         "name" : "Communication with command and control over HTTP(s)",
         "mitre" : "",
         "domain" : "Network",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Detect communication with command and control system from a compromised endpoint by identifying traffic allowed by the forward proxy with unknown or uncategorized sites where the endpoint communicates in at least 15 of the last 60 minutes (bins) and the destination is not on a noise suppression white list, the Alexa top 1M, or advertising domains list.",
         "SPLEase" : "None",
         "mitre_technique" : ""
      },
      "suspicious_privilege_escalation" : {
         "app" : "Splunk_User_Behavior_Analytics",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "|TA0002",
         "journey" : "Stage_6",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre_technique" : "|T1086",
         "description" : "Detects suspicious privilege escalation by correlating login and privilege escalation events.",
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.2.0",
         "category" : "Lateral Movement|Endpoint Compromise",
         "mitre" : "",
         "domain" : "Other",
         "includeSSE" : "Yes",
         "name" : "Suspicious Privilege Escalation"
      },
      "detection_osx_keyboard_taps" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "|TA0006",
         "journey" : "Stage_3",
         "story" : "ColdRoot MacOS RAT",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "released" : "2.2.0",
         "category" : "Malware",
         "help" : "The search leverages Alerts generated from the osquery osx-attacks.conf pack search `Keyboard_Event_Taps` to detect when a process is monitoring the keystrokes of a machine, This is a common technique used by macOS remote access trojans to log keystrokes from a machine",
         "name" : "Processes Tapping Keyboard Events",
         "includeSSE" : "Yes",
         "mitre" : "Collection",
         "incluseSSE" : "No",
         "domain" : "Threat",
         "hasSearch" : "No",
         "killchain" : "Command and Control",
         "description" : "This search looks for processes in an MacOS system that is tapping keyboard events in MacOS, and essentially monitoring all keystrokes made by a user. This is a common technique used by RATs to log keystrokes from a victim, although it can also be used by legitimate processes like Siri to react on human input",
         "mitre_technique" : "|T1056"
      },
      "unusual_usb_activity" : {
         "usecase" : "Insider Threat|Security Monitoring",
         "icon" : "UBA_Use_Case.png",
         "datasource" : "DLP|Endpoint Detection and Response",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "app" : "Splunk_User_Behavior_Analytics",
         "data_source_categories" : "DS016DataLossPrevention-ET01Violation|DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
         "mitre_tactic" : "|TA0010|TA0001",
         "journey" : "Stage_4",
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "relatedUseCases" : [
            "showcase_first_usb",
            "Basic_Malware_Outbreak",
            "outbreak_detected",
            "UC0029"
         ],
         "mitre_technique" : "|T1052|T1091|T1200",
         "description" : "Generates anomalies for unusual transfers to/from USB devices. It also tracks the first time an account uses a USB and the first time a different type (e.g., vendor) of USB is used in the enterprise. ",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Other",
         "includeSSE" : "Yes",
         "name" : "Unusual USB Activity",
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.0.0",
         "category" : "Data Exfiltration|Unauthorized Software"
      },
      "detection_spike_vpc_blocked_traffic" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "journey" : "Stage_1",
         "mitre_tactic" : "TA0010|TA0011",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious AWS Traffic",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS",
         "help" : "This search retrieves all the VPC Flow log entries that have recorded a blocked outbound network connection originating from your AWS environment. Then it kicks off a subsearch, which looks at the same data and performs the following series of steps: <ol><li>Counts the number of blocked outbound connections by each source IP</li><li>Loads the cache file that contains the number of data points, the count from the latest hour, the average blocked connections, and the standard deviation for each source IP.</li><li>Drops the count from the latest hour, since it is not necessary, and merges the rest of the data with the results of the stats command. </li><li>Renames <code>numberOfBlockedConnections</code> as <code>latestCount</code>.</li><li>Calculates the new average value for each source IP with the latest count, weighting the past much more heavily than the current hour. It does the same for the standard deviation, weighting the past more heavily than the current.</li><li>Updates the cache file with the latest results.</li><li>Sets the minimum threshold for the number of data points and sets the number of standard deviations away from the mean it must be to be considered a spike.</li><li>Makes a determination regarding whether or not the current count is a spike by checking to see if the minimum data-point threshold has been met and the count is a sufficient number of standard deviations away from the average.</li><li>Filters out anything that it determines is not a spike and returns the list of source IPs to the main search. </li></ol>The main search subsequently gets the list of all destination IPs for which the traffic was blocked, the network interface ID, the number of unique destination IP, and the total number of blocked connections for each of these source IP addresses. Finally, it looks up the average and standard deviation and returns both the average and the number of standard deviations the spike is from the average.",
         "name" : "Detect Spike in blocked Outbound Traffic from your AWS",
         "includeSSE" : "Yes",
         "domain" : "Network",
         "mitre" : "Exfiltration|Command and Control",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective|Command and Control",
         "searchKeywords" : "",
         "description" : "This search will detect spike in blocked outbound network connections originating from within your AWS environment.  It will also update the cache file that factors in the latest data.",
         "mitre_technique" : "",
         "search_name" : "ESCU - Detect Spike in blocked Outbound Traffic from your AWS - Rule"
      },
      "sser_detect_lateral_movement_with_wmi" : {
         "knownFP" : "None at the moment",
         "mitre" : "Lateral Movement|Execution",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Detect Lateral Movement With WMI",
         "help" : "This use case looks for WMI being used for lateral movement.",
         "operationalize" : "When this search fires, you will want to start your incident response process and investigate the actions taken by this process.",
         "howToImplement" : "This use case requires Sysmon to be installed on the endpoints you wish to monitor and the Sysmon add-on installed on your forwarders and search heads.",
         "category" : "Lateral Movement",
         "released" : "1.1.0",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1021|T1047",
         "description" : "<p>This use case looks for WMI being used for lateral movement.</p><p><b>Alert Volume:</b> Low</p>",
         "searchKeywords" : "",
         "killchain" : "Installation|Actions on Objective",
         "hasSearch" : "Yes",
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/detect_lateral_movement_with_wmi.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Detecting WMI Remote Process Creation - Demo",
         "similarUseCases" : [
            "detection_remote_wmi_process_instantiation"
         ],
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0008|TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "journey" : "Stage_3",
         "examples" : [
            {
               "name" : "Detecting WMI Remote Process Creation - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Detecting WMI Remote Process Creation - Live"
            }
         ]
      },
      "detection_remote_desktop_process_running_on_system" : {
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0008",
         "journey" : "Stage_3",
         "story" : "Hidden Cobra Malware",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "This search looks for the remote desktop process mstsc.exe running on systems upon which it doesn't typically run. This is accomplished by filtering out all systems that are noted in the <code>common_rdp_source category</code> in the Assets and Identity framework.",
         "SPLEase" : "None",
         "mitre_technique" : "T1076",
         "search_name" : "ESCU - Remote Desktop Process Running On System - Rule",
         "released" : "2.0.0",
         "category" : "Lateral Movement",
         "help" : "This search finds systems that do not commonly use remote desktop, but which begin using it. It filters out all systems that have the \"common_rdp_source\" category applied. Categories are applied to systems using the Assets and Identity framework.",
         "includeSSE" : "Yes",
         "name" : "Remote Desktop Process Running On System",
         "mitre" : "Lateral Movement",
         "domain" : "Endpoint"
      },
      "detection_spike_s3_deletion" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "This search detects users creating spikes in API activity related to deletion of S3 buckets in your AWS environment. It will also update the cache file that factors in the latest data.",
         "search_name" : "ESCU - Detect Spike in S3 Bucket deletion - Rule",
         "mitre_technique" : "",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "help" : "This search and its corresponding subsearch run through the following series of steps: <ol><li>Retrieve all the AWS CloudTrail log entries that have recorded AWS API calls specifically for deletion of S3 buckets.</li><li>Kick off a subsearch that retrieves the same data and pulls out and converts the ARN into a more friendly format.</li><li>Count the number of API calls per ARN.</li><li>Load the cache file that contains the number of data points, the count from the latest hour, the API call average, and the standard deviation for each ARN.</li><li>Drop the count from the latest hour, since it is unnecessary, and merge the rest of the data with the results of the <code>stats</code> command. </li><li>Rename <code>apiCalls</code> as <code>latestCount</code>.</li><li>Calculate the new average value for each ARN with the latest count, weighting the past more heavily than the current hour. It does the same for the standard deviation&#151;weighting the past more heavily than the current.</li><li>Update the cache file with the latest results.</li><li>Set the minimum threshold for the number of data points and the number of standard deviations away from the mean it must be to be considered a spike.</li><li>Make a determination regarding whether or not the current count is a spike by checking to see if the minimum data-point threshold has been met and if the count is a sufficient number of standard deviations away from the average.</li><li>Filter out anything that it determines is not a spike and returns the list of ARNs to the main search. </li></ol>The main search subsequently gets the names of the deleted S3 buckets, the number of unique API calls, and the total number of API calls for each of these user ARNs.",
         "name" : "Detect Spike in S3 Bucket deletion",
         "includeSSE" : "Yes",
         "mitre" : "Credential Access|Execution",
         "domain" : "Network",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0006|TA0002",
         "journey" : "Stage_3",
         "story" : "Suspicious AWS S3 Activities",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "blacklisted_domain" : {
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Generates anomalies for traffic that goes to Blacklisted Domains.",
         "mitre_technique" : "|T1094|T1032|T1095",
         "category" : "Endpoint Compromise|Threat Intelligence",
         "released" : "2.0.0",
         "help" : "Help not needed -- UBA Use Case",
         "includeSSE" : "Yes",
         "name" : "Blacklisted Domain",
         "domain" : "Other",
         "mitre" : "",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0011",
         "data_source_categories" : "DS002DNS-ET01QueryRequest",
         "app" : "Splunk_User_Behavior_Analytics",
         "highlight" : "No",
         "datasource" : "DNS",
         "displayapp" : "Splunk User Behavior Analytics",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "mitre_notes" : "",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other"
      },
      "showcase_unique_patient_records_viewed" : {
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Number of Unique Patient Records Viewed Per Day - Demo",
         "alertvolume" : "Low",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "VendorSpecific-Cerner",
         "mitre_tactic" : "TA0009",
         "examples" : [
            {
               "name" : "Number of Unique Patient Records Viewed Per Day - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Number of Unique Patient Records Viewed Per Day - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_4",
         "usecase" : "Insider Threat|Advanced Threat Detection|Compliance",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Determine the time, role, and number of accesses occurring and from what address if possible. Contact the user and manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine if patient data is being collected.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our demo dataset is a set of manufactured logs based on a Cerner patient record system, which tracked the number of unique patient whose records a particular doctor, nurse, DBA, or etc. opened per day, 'dc(PatientID) as NumOpens by EmployeeName _time'. (In effect, if you worked with one patient all day, and opened their chart 100 times, you would have a NumOpens of 1, because you only viewed one patient). Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average. Notably, the daily dc() is already done in this dataset -- this is akin to analyzing a summary index, as is explained in the High Cardinality Alert dialog.</p>",
         "category" : "Data Exfiltration|Insider Threat",
         "released" : "1.0.0",
         "mitre" : "Collection",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information . If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p> ",
         "domain" : "Data",
         "relevance" : "Healthcare organizations need to be particularly concerned about privacy laws (HIPAA/HITECH) and data exfiltration of financially lucrative patient records. Patient records are worth 10x or 20x what credit card numbers are worth on the black market, as the more you know about an individual the more useful that individuals' information is for identity theft. This data can also be used so that an individual can impersonate the victim and obtain healthcare services, and then the bill for said services goes to the “real” individual. Therefore, tracking who is accessing patient records in a “normal” manner vs anomalous access patterns is be critical to detecting this activity before records are exfiltrated. Note that this search could find true insiders acting maliciously, or detection of users that have had their credentials compromised, and those user accounts are now being hijacked for data exfiltration.",
         "name" : "Healthcare Worker Opening More Patient Records Than Usual",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "SPLEase" : "Advanced",
         "mitre_technique" : "|T1213|T1039",
         "description" : "<p>If a healthcare worker views more patient records than normal or more than their peers, it could be a sign that their system is infected, or that they are exfiltrating patient data.</p><p><b>Alert Volume:</b> Low</p>"
      },
      "sser_malicious_command_line_executions" : {
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Command line length statistical analysis - Demo"
            },
            {
               "name" : "Command line length statistical analysis - Live",
               "label" : "Live Data"
            }
         ],
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "mitre_tactic" : "TA0002|TA0005",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Medium",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Command line length statistical analysis - Demo",
         "description" : "<p>Ransomware and other malware variants often execute long commands using command line arguments. This search performs statistical analysis of these CLI arguments to detect potentially malicious executions.</p><p><b>Alert Volume:</b> Medium</p>",
         "mitre_technique" : "|T1059|T1064",
         "SPLEase" : "Basic",
         "hasSearch" : "Yes",
         "killchain" : "Installation",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Malicious Command Line Executions",
         "domain" : "Endpoint",
         "knownFP" : "None at the moment",
         "mitre" : "Execution|Defense Evasion",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "howToImplement" : "In order to run this search you need to index Sysmon data from your Windows endpoints. However, you can modify the search o use data from other sources that capture command lines, such as endpoint products like Carbon Black, or Windows process creation events. Process creation events are not enabled by default, but can be enabled via GPO.",
         "operationalize" : "When this search fires, you want to validate that the process and the command line are legitimate. You should begin a standard incident response process by validating the process is legitimate and the command-line options for the process are also legitimate.  You should investigate what actions were taking by this process and verify any action taken by the process.",
         "help" : "Ransomware and other malware variants often execute long commands using command line arguments. This search performs statistical analysis of these CLI arguments to detect potentially malicious executions."
      },
      "host_with_high_number_of_services" : {
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : "cyber hygiene",
         "alertvolume" : "Other",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "",
         "app" : "Splunk_App_for_Enterprise_Security",
         "highlight" : "No",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Endpoint Detection and Response",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise|Unauthorized Software|Lateral Movement",
         "help" : "Help not needed -- ES Use Case",
         "name" : "Host With High Number Of Services",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "Alerts when host has a high number of services. This may be an indication that the device is running services that are not necessary (such as a default installation of a server).",
         "search_name" : "Endpoint - Host With Excessive Number Of Services - Rule",
         "mitre_technique" : "",
         "SPLEase" : "Accelerated"
      },
      "showcase_series_discovery_tools_filename" : {
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Series of Discovery Filenames - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Series of Discovery Filenames - Live"
            }
         ],
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "mitre_tactic" : "TA0007",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "icon" : "Core_Use_Case.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Series of Discovery Filenames - Demo",
         "alertvolume" : "Low",
         "hasSearch" : "Yes",
         "killchain" : "Exploitation",
         "searchKeywords" : "",
         "description" : "<p>It's uncommon to see many host discovery tools launched on an endpoint, except in very specific situations. This search will identify tools by filename, and look for many launches. (<a href=\"https://car.mitre.org/wiki/CAR-2016-03-001\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low (unless your company specifically does this)</p>",
         "mitre_technique" : "|T1087|T1069|T1057|T1016|T1033|T1082|T1007",
         "SPLEase" : "Basic",
         "category" : "Scanning|Endpoint Compromise",
         "released" : "1.0.0",
         "operationalize" : "<p>This alert is intended to corroborate other suspicious actions in most environments, rather than being a major flag on its own. You might send this alert to your alert manager as a low or information alert so that you can search for the asset and find it later. More advanced organizations might send this alert into the ES Risk Framework (so that you can aggregate low level risk elements) or to Splunk UBA (so that the threat models can incorporate this event into their calculations).</p>",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launch logs (Event ID 4688), though you could also use any other process launch logs from EDR tools. It then filters for a set of filenames that are known to be discovery related (from a lookup called tools.csv) and uses the transaction command to group them by time. If there's a single transaction with many events, it surfaces those.</p>",
         "howToImplement" : "The hardest part of implementing this correctly, once you have process launch logs ingested, will be to make sure that the fields correctly set. <ul><li>In the live version, we start with index=* which is bad Splunk form (but makes it a little bit easier to get started). You should make sure that you specify the index where your process launch logs live (index=oswinsec if you follow our best practices, and the documentation in this app).</li><li>The next field you have to worry about is the sourcetype, which should be pretty standard.</li><li>The EventCode field is the last field you have to think about, which if you use our Splunk_TA_windows on your Search Head, will also work automatically for you (again, docs are key!)</li></ul><p>Once you have the search itself running, then you need only schedule it (click \"Schedule Alert\") and have Splunk email you, create a ticket in Enterprise Security or Service Now, or take some other action for you.",
         "name" : "Concentration of Discovery Tools by Filename",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "relevance" : "These days, there are a lot of executables one can install and run on a Windows machine in order to cause mischief. The thing is, many amateur hackers will run a lot of these tools in succession (or automated scripts will run them, too). By correlating the process names being executed on endpoints with a list of 'known discovery tool executable names' we can detect this suspicious activity.",
         "mitre" : "Discovery",
         "knownFP" : "<p>The most likely source of false positives for this script would be normal admin activity, particularly if you have login scripts (or periodic scripts) that enumerate information about hosts, they could show up here. The easy way to filter out these situations is to look at that scripted fingerprint and filter that out. For example, using <span class=\"code\">| where</span> (which has eval-style syntax different from <span class=\"code\">| search</span>) you could filter out <span class=\"code\">| where mvcount(filename)=4 AND filename=\"net.exe\" AND filename=\"ipconfig.exe\" AND filename=\"sc.exe\" AND filename=\"tasklist.exe\"</span>.</p>"
      },
      "detection_large_icmp_outbound" : {
         "journey" : "Stage_1",
         "mitre_tactic" : "TA0011",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Command and Control",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Network Communication",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "hasSearch" : "No",
         "killchain" : "Command and Control",
         "searchKeywords" : "",
         "description" : "This search looks for outbound ICMP packets with a packet size larger than 1,000 bytes. Various threat actors have been known to use ICMP as a command and control channel for their attack infrastructure. Large ICMP packets from an endpoint to a remote host may be indicative of this activity.",
         "mitre_technique" : "T1095",
         "search_name" : "ESCU - Detect Large Outbound ICMP Packets - Rule",
         "released" : "2.2.0",
         "category" : "Adversary Tactics",
         "help" : "This search works by looking at fields in the Network_Traffic data model, which is populated by various firewalls and passive networking monitoring technologies. Specifically, the search looks for ICMP packets larger than 1,000 bytes with a destination that is external to your organization.",
         "includeSSE" : "Yes",
         "name" : "Detect Large Outbound ICMP Packets",
         "domain" : "Network",
         "mitre" : "Command and Control"
      },
      "UC0095" : {
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_2",
         "mitre_tactic" : "",
         "usecase" : "Application Security",
         "icon" : "PS_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Web Server",
         "displayapp" : "Splunk Professional Services",
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Web Attack",
         "domain" : "Network",
         "mitre" : "",
         "name" : "Detect Excessive Increase in HTTP Error Codes by Src",
         "includeSSE" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "High numbers of http error codes likely indicate a problem with the web application or server, or can be an indicator of malicious action. "
      },
      "unusual_time_of_badge_access" : {
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "mitre_tactic" : "|TA0025",
         "data_source_categories" : "DS017PhysicalSecurity-ET01Access",
         "journey" : "Stage_6",
         "app" : "Splunk_User_Behavior_Analytics",
         "datasource" : "Physical Security",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "icon" : "UBA_Use_Case.png",
         "released" : "2.2.0",
         "category" : "Insider Threat",
         "help" : "Help not needed -- UBA Use Case",
         "includeSSE" : "Yes",
         "name" : "Unusual Time of Badge Access",
         "mitre" : "",
         "domain" : "Threat",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Detects badge access at unusual time.",
         "mitre_technique" : "|T1360"
      },
      "detection_sql_injection_with_long_urls" : {
         "SPLEase" : "None",
         "mitre_technique" : "T1190",
         "search_name" : "ESCU - SQL Injection with Long URLs - Rule",
         "description" : "This search looks for long URLs that have several SQL commands visible within them.",
         "searchKeywords" : "",
         "killchain" : "Delivery",
         "hasSearch" : "No",
         "mitre" : "Defense Evasion|Execution",
         "domain" : "Network",
         "includeSSE" : "Yes",
         "name" : "SQL Injection with Long URLs",
         "help" : "This search looks only at your web servers and returns the source, the web server, the URL and its length, and the user agent associated with HTTP GET requests for extremely long URLs or user agent lengths with more than three common SQL commands found within the URL.",
         "category" : "Web Attack",
         "released" : "2.0.0",
         "usecase" : "Application Security",
         "icon" : "ES_Use_Case.png",
         "datasource" : "Web Server",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "Yes",
         "story" : "SQL Injection",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0001",
         "data_source_categories" : "DS014WebServer-ET01Access",
         "journey" : "Stage_2",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case"
      },
      "detection_dns_query_length_with_high_standard_deviation" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "mitre_tactic" : "TA0011|TA0010",
         "data_source_categories" : "DS002DNS-ET01Query",
         "journey" : "Stage_3",
         "story" : "Suspicious DNS Traffic",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "DNS",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "category" : "Command and Control",
         "released" : "2.0.0",
         "help" : "Attackers often use random, long domain names for their attack infrastructure. This search looks at all the queries observed over the search time frame, and identifies any domains being resolved with names that are greater that 2 times the standard deviation.",
         "name" : "DNS Query Length With High Standard Deviation",
         "includeSSE" : "Yes",
         "mitre" : "Command and Control|Exfiltration",
         "domain" : "Network",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Command and Control",
         "description" : "This search allows you to identify DNS requests and compute the standard deviation on the length of the names being resolved, then filter on two times the standard deviation to show you those queries that are unusually large for your environment.",
         "SPLEase" : "None",
         "mitre_technique" : "T1043|T1048",
         "search_name" : "ESCU - DNS Query Length With High Standard Deviation - Rule"
      },
      "UC0109" : {
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1110|T1078",
         "description" : "Monitor your security controls and prove your GDPR compliance by detecting slow and low brute force (or password guessing) attacks on GDPR-tagged systems that occur gradually over the day.",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre" : "Credential Access|Privilege Escalation",
         "knownFP" : "The only known scenario where this search could generate false positives is if you have a single source (for example, a web app) that centralizes the authentication for many people. In that scenario, you might need to adjust thresholds for that source, or exclude it and build a separate similar search just using the logs from that host.",
         "domain" : "Access",
         "gdprtext" : "<h4>Problem:</h4><p>Attackers leverage brute-force authentication attempts to bypass weak cryptographic standards, or to exploit infrastructure or applications where password best practices are not consistently applied. </p><h4>Impact:</h4><p>Brute force access is a common attack vector. Under the GDPR, monitoring and demonstrating that security controls are effective is required by Article 32, therefore immediate awareness of any brute force attempts is critical to maintaining compliance posture. Demonstrating that any such attempts have not been successful will help to prove compliance for data privacy audits initiated by data privacy authorities (Article 58) and also help counteract compensation claims (Article 82).</p><h4>Resolution Path:</h4><p>Identify GDPR-relevant resources and systems and monitor for a large number of authentication failures within a short time period, on any of those resources or systems. It is important to adjust for the scenario where a single source (such as a web app) might centralize the authentication for a large number of users, to reduce false positives.</p>",
         "name" : "Brute Force Access Behavior Detected Over One Day - Against Category",
         "includeSSE" : "Yes",
         "help" : "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Windows Authentication logs, during which someone attempts a brute force against a series of usernames. Our live search looks for Windows Authentication activity across any index in the standard sourcetype.",
         "operationalize" : "When this search fires, the immediate concern is that the brute force search was successful. See if it is coming from a host that typically logs in with that account to make sure it is not just coincidental, and then reset the password for any compromised accounts and look for any other places where that username was used.",
         "howToImplement" : "If you have followed the data onboarding guides in this app, this search will work immediately for you. You should generally specify the index where you are storing Windows Security logs (e.g., index=oswinsec), and if you use a mechanism other than the Splunk Universal Forwarder to onboard that data, you should verify the sourcetype and fields that are used. The rest is simple!",
         "category" : "GDPR",
         "released" : "2.0.0",
         "usecase" : "Compliance",
         "icon" : "Core_Use_Case.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Authentication|Vendor-Specific Data",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0006|TA0004",
         "data_source_categories" : "DS003Authentication-ET02Failure|VendorSpecific-winsec",
         "examples" : [
            {
               "name" : "Brute Force Slow and Low GDPR - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Brute Force Slow and Low GDPR - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_4",
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_brute_force_one_day.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Brute Force Slow and Low GDPR - Demo",
         "similarUseCases" : [
            "basic_brute_force",
            "brute_force_access_behavior_detected",
            "brute_force_access_behavior_detected_over_one_day",
            "excessive_failed_logins",
            "UC0099",
            "UC0108"
         ]
      },
      "UC0035" : {
         "domain" : "Access",
         "mitre" : "",
         "includeSSE" : "No",
         "name" : "Compromised account access testing",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Account Compromise",
         "released" : "2.0.0",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Following a successful authentication, an attacker will attempt to determine what resources may be accessed without causing host intrusion or DLP technologies to detect activity. Commonly the attacker will enumerate and browse to shares, access email, access web applications, or connect to databases yet perform minimal or no activity.",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Authentication",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_3",
         "mitre_tactic" : ""
      },
      "showcase_new_host_with_suspicious_cmd_launch" : {
         "alertvolume" : "Very Low",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New cmd.exe or regedit or powershell launched by services.exe - Demo",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "New cmd.exe or regedit or powershell launched by services.exe - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "New cmd.exe or regedit or powershell launched by services.exe - Live"
            }
         ],
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "mitre_tactic" : "TA0004|TA0003",
         "app" : "Splunk_Security_Essentials",
         "includeSSE" : "Yes",
         "name" : "New Suspicious cmd.exe / regedit.exe / powershell.exe Service Launch",
         "domain" : "Endpoint",
         "relevance" : "There are some very powerful executables on Windows endpoints that should be carefully audited. Most are legit when they execute, but it is a useful exercise to monitor the parent process that does the launching. The Service Control Manager, or services.exe, has no legitimate reason to launch commands like cmd.exe, powershell.exe, or regedit.exe. Incidentally, a common way for malware to masquerade as something legitimate is to call itself service.exe.",
         "mitre" : "Execution|Privilege Escalation",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This detection should have relatively few false positives given the rarity of having any of these programs launched as services. It's possible some system management scripts might flag for this, but those should be rare and easily filtered out of the search.</p>",
         "released" : "1.0.0",
         "category" : "Endpoint Compromise",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the system demonstrating this behavior. Determine the time and process that is being executed and by what account on the system. Contact the user and system owner to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine why services.exe is triggering cmd.exe, regedit.exe or powershell.exe.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688) where known suspicious tools are launched as a service. For this analysis, we are effectively grouping by process name and host, which will give us a row for each process_name+hostname combination. We check if the first time that has occurred was in the last day.</p>",
         "description" : "<p>Very rarely would cmd.exe, regedit.exe, or powershell.exe be launched by services.exe. This search will detect that malware persistence strategy. (<a href=\"https://car.mitre.org/wiki/CAR-2014-05-002\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Very Low (for most companies)</p>",
         "mitre_technique" : "|T1050",
         "SPLEase" : "Medium",
         "hasSearch" : "Yes",
         "killchain" : "Installation",
         "searchKeywords" : ""
      },
      "anomalous_new_process" : {
         "SPLEase" : "Advanced",
         "mitre_technique" : "|T1035|TA0002",
         "search_name" : "Endpoint - Anomalous New Processes - Rule",
         "description" : "Alerts when an anomalous number hosts are detected with a new process.",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Endpoint",
         "name" : "Anomalous New Process",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- ES Use Case",
         "category" : "Endpoint Compromise|Unauthorized Software",
         "released" : "2.0.0",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "app" : "Splunk_App_for_Enterprise_Security",
         "mitre_tactic" : "|TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "journey" : "Stage_3",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "relatedUseCases" : [
            "showcase_new_interactive_service_logon",
            "anomalous_new_service"
         ]
      },
      "showcase_new_path_for_familiar_filename" : {
         "killchain" : "Installation|Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1036",
         "SPLEase" : "Medium",
         "description" : "<p>Processes are typically launched from the same path. When those paths change, it can be a malicious process masquerading as a valid one, to hide in task manager. (<a href=\"https://car.mitre.org/wiki/CAR-2013-05-004\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Medium</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the event, executable, its associated path, the system, user and other pertinent information. Contact the owner of the systems. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials have been used by another party and additional investigation is warranted to determine why common files are launching from a different path.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688). Then we separate the filename from the file path, and look to see if the same filename (e.g., svchost.exe) is run from multiple places by using dc(Image) by filename (where Image is the full path). For each file with multiple paths, we check to see if the the first time that occurred was in the last day.</p>",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "relevance" : "A common technique employed by malware is to have a benign looking executable launch out of an unusual directory. Normal executions for the file will come out of a standard operating system path, but when we see the same filename launched out of multiple paths, it is time to investigate. Process whitelisting or lookup tables containing names of known-good executables can provide further fidelity here.",
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This search should very rarely generate false positives. In testing, it has been seen that the base search will detect several executables that launch from both an x64 path and x86 path, but because the search has a behavioral component, we will only alert on this if it occurs for the first time.</p>",
         "name" : "Familiar Filename Launched with New Path on Host",
         "includeSSE" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "New Path for Process On Host - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "New Path for Process On Host - Live"
            }
         ],
         "mitre_tactic" : "TA0005",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Path for Process On Host - Demo",
         "alertvolume" : "Medium"
      },
      "detection_netbackup_failed_backup" : {
         "datasource" : "Backup",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "usecase" : "Compliance",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "",
         "data_source_categories" : "DS027EndpointBackup-ET01General",
         "journey" : "Stage_1",
         "story" : "Monitor Backup Solution",
         "app" : "Enterprise_Security_Content_Update",
         "alertvolume" : "Low",
         "mitre_notes" : "This is not detecting adversary behavior - this is a self-monitoring of cybersecurity hygiene",
         "dashboard" : "ESCU_Use_Case",
         "description" : "This search gives you the hosts where a backup was attempted and then failed.",
         "SPLEase" : "None",
         "search_name" : "ESCU - Unsuccessful Netbackup backups - Rule",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Unsuccessful Netbackup backups",
         "mitre" : "",
         "domain" : "Endpoint",
         "category" : "Compliance",
         "released" : "2.0.0",
         "help" : "This search looks across the most recent backup events for each host, and returns those messages that indicate there was a backup failure."
      },
      "showcase_series_attacker_tools_filename" : {
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Series of Hacker Filenames - Demo",
         "relatedUseCases" : [
            "showcase_series_attacker_tools_hashes",
            "showcase_series_discovery_tools_filename",
            "showcase_series_discovery_tools_hashes"
         ],
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0007|TA0008|TA0002|TA0006|TA0003|TA0004|TA0010|TA0005",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "journey" : "Stage_3",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launch logs (Event ID 4688). It then filters for a set of filenames that are known to be hacker related (from a lookup called tools.csv) and uses the transaction command to group them by time. If there's a single transaction with many events, it surfaces those.</p>",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "eli5Disabled" : "<p>The basic idea behind this search is to take a set of filenames, and then look for them in a larger dataset. It's also one of the searches in SSE where the live version is way simpler than the demo version, because we can take advantage of simple keyword searching.</p><p>There are three phases to this search. <ul><li>First we run a subsearch to collect a list of filenames from a CSV file (also called a lookup) that contains a list of tools that are labeled as discovery, attacker, suspicious. If you've never used a subsearch before, the basic idea is that you take a search that works on its own, usually one that returns just one column. When you put brackets around that and add it into a new search, Splunk will run the subsearch first, take those columns and add them to the main search. For example, if your subsearch had a single field called \"name\" with a value \"David\", name=\"David\" would be added into your main search. If it returned two rows, and the second row had \"name\" with the value \"John\", then the main search would use (name=\"David\" OR name=\"John\"). They're pretty simple once you get used to them. For more info, check out the <a href=\"https://docs.splunk.com/Documentation/Splunk/7.0.1/SearchTutorial/Useasubsearch\">docs</a>, or explore <a href=\"https://www.splunk.com/view/SP-CAAAPX9\">Free Splunk Training</a>.</li>\n<li>Next we search in our process launch logs for any of those filenames. This is straightforward Splunk searching.</li><li>Finally, the other fancy part of this search is using the transaction command. Transaction takes all the logs in and groups them together by whatever field you specify, in this case host. So functionally, we are grouping together all the process launches for attacker tools (since we already filtered for them) per host. Transaction can be slow with really big datasets, but it works great for relatively small datasets like this. It also has tons of knobs and levers -- check out the <a href=\"http://docs.splunk.com/Documentation/Splunk/latest/SearchReference/transaction\">docs</a> for more. </li></ul>",
         "youtubeDisabled" : "https://www.youtube.com/embed/EErha1BpjMA",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1087|T1069|T1057|T1018|T1063|T1082|T1016|T1049|T1010|T1033|T1007|T1012|T1046|T1003|T1077|T1050|T1031|T1058|T1053|T1035|T1029|T1098|T1089|T1054|T1059",
         "fullSolutionDisabled" : "<div><p><img src=\"/static/app/Splunk_Security_Essentials/images/content_thumbnails/ES_Use_Case.png\" style=\"display:inline; float: right;\" />This use case is ultimately looking for specific filenames that we know are concerning. While here we have a limited list that we pull in via a lookup (a CSV file), Splunk Enterprise Seurity has a full threat intelligence framework that allows you to leverage both public and private threat intelligence sources and look for hosts that trigger on many different sources, all in an automatic way. In addition, many of the related capabilities that you will look for to operationalize the output of these alerts (such as a risk framework, a investigator workflow, and more) come with Enterprise Security.</p><p>Find out more about Splunk Enterprise Security <a href=\"https://www.splunk.com/en_us/products/premium-solutions/splunk-enterprise-security.html\" target=\"_blank\">on our website</a> or by <a href=\"https://www.splunk.com/en_us/about-us/contact.html\" target=\"_blank\">contacting your local Splunk team</a>.",
         "description" : "<p>It's uncommon to see attacker tools used in rapid succession on an endpoint. This search will identify tools by filename, and look for multiple executions. (<a href=\"https://car.mitre.org/wiki/CAR-2013-04-002\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>",
         "alertvolume" : "Low",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Series of Hacker Filenames - Demo"
            },
            {
               "name" : "Series of Hacker Filenames - Live",
               "label" : "Live Data"
            }
         ],
         "icon" : "Core_Use_Case.png",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "howToImplement" : "The hardest part of implementing this correctly, once you have process launch logs ingested, will be to make sure that the fields correctly set. <ul><li>In the live version, we start with index=* which is bad Splunk form (but makes it a little bit easier to get started). You should make sure that you specify the index where your process launch logs live (index=oswinsec if you follow our best practices, and the documentation in this app).</li><li>The next field you have to worry about is the sourcetype, which should be pretty standard.</li><li>The EventCode field is the last field you have to think about, which if you use our Splunk_TA_windows on your Search Head, will also work automatically for you (again, docs are key!)</li></ul><p>Once you have the search itself running, then you need only schedule it (click \"Schedule Alert\") and have Splunk email you, create a ticket in Enterprise Security or Service Now, or take some other action for you.",
         "operationalize" : "<p>This alert is very clearly tied to a known threat, so when it fires your concern is that this represents an attacker inside of one of your systems. Recommended steps are to begin incident response on the host where this alert fired from, to look for signs of other suspicious activities. The first step in that process will be to look at the parent process that launched these suspicious processes, and see what other activities that process has done. That should guide you to the underlying problem. As you get more information about this particular system (for example, how did malware end up on it, what websites has it communicated with, etc.), make sure to pivot and look across your entire organization for other indications, and to look in Open Source Intelligence sites like VirusTotal to learn more about the attacker.</p>",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "knownFP" : "<p>This search should trigger very few false positives, because it's filtered to just very specific launches, and even more, looking for multiple process launches in a short period of time. The only scenario where you would expect to see this happen is if your organization happens to use some of those unusual tools for normal sysadmin tasks, and have them scripted. Beyond that, be suspicious!</p>",
         "mitre" : "Discovery|Lateral Movement|Execution",
         "relevance" : "These days, there are a lot of executables one can install and run on a Windows machine in order to cause mischief. The thing is, many amateur hackers will run a lot of these tools in succession (or automated scripts will run them, too). By correlating the process names being executed on endpoints with a list of 'known hacker tool executable names' we can detect this suspicious activity.",
         "name" : "Concentration of Attacker Tools by Filename",
         "killchain" : "Exploitation",
         "SPLEase" : "Basic"
      },
      "detection_new_open_s3_buckets" : {
         "includeSSE" : "Yes",
         "name" : "Detect New Open S3 buckets",
         "domain" : "Network",
         "mitre" : "Execution|Initial Access|Exfiltration",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "help" : "This search queries CloudTrail logs for events with S3 bucket access controls given to the \"All Users\" group, which allows anyone in the world access to the resource. This search generates a table displaying the time when the bucket was made public, the permission of the S3 bucket, the bucket name, and the ARN of the user who created the bucket.",
         "description" : "This search looks for CloudTrail events where a user has created an open/public S3 bucket.",
         "mitre_technique" : "",
         "search_name" : "ESCU - Detect New Open S3 buckets - Rule",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0002|TA0001|TA0010",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious AWS S3 Activities"
      },
      "high_or_critical_priority_individual_logging_into_infected_machine" : {
         "name" : "High or Critical Priority Individual Logging into Infected Machine",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Access",
         "category" : "Endpoint Compromise|Account Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- ES Use Case",
         "description" : "Detects users with a high or critical priority logging into a malware infected machine",
         "SPLEase" : "Accelerated",
         "search_name" : "Access - High or Critical Priority Individual Logging into Infected Machine - Rule",
         "mitre_technique" : "|T1078",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "datasource" : "Authentication|Anti-Virus",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "Yes",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "|TA0004|TA0001",
         "data_source_categories" : "DS003Authentication-ET01Success|DS004EndPointAntiMalware-ET01SigDetected",
         "journey" : "Stage_4",
         "app" : "Splunk_App_for_Enterprise_Security"
      },
      "blacklisted_application" : {
         "released" : "2.0.0",
         "category" : "Endpoint Compromise|Threat Intelligence|Unauthorized Software|Operations",
         "help" : "Help not needed -- UBA Use Case",
         "includeSSE" : "Yes",
         "name" : "Blacklisted Application",
         "domain" : "Other",
         "mitre" : "",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Raises anomalies when the input data matches a set of predefined patterns in Microsoft Windows logs.",
         "mitre_technique" : "",
         "mitre_notes" : "broad",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "journey" : "Stage_4",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "",
         "app" : "Splunk_User_Behavior_Analytics",
         "highlight" : "No",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Endpoint Detection and Response",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Security Monitoring"
      },
      "UC0053" : {
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "journey" : "Stage_2",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "highlight" : "No",
         "datasource" : "IDS or IPS",
         "displayapp" : "Splunk Professional Services",
         "usecase" : "Advanced Threat Detection",
         "icon" : "PS_Use_Case.png",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "includeSSE" : "No",
         "name" : "Network Intrusion Detected",
         "domain" : "Network",
         "mitre" : "",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Detect attempted network intrusions by src_ip when the same source is observed with two or more unique destinations or one destination and two or more signatures",
         "mitre_technique" : "",
         "SPLEase" : "None"
      },
      "detection_anomalous_webclick" : {
         "domain" : "Threat",
         "mitre" : "",
         "incluseSSE" : "No",
         "includeSSE" : "Yes",
         "name" : "Web Fraud - Anomalous User Clickspeed",
         "help" : "It's suspicious when someone or something is moving throughout your website too quickly or with a perfect click cadence. Fortunately, it's easy to detect by calculating the time between clicks for each session and highlighting the anomalous behavior.",
         "released" : "2.2.0",
         "category" : "Abuse|",
         "mitre_technique" : "T1078|T1064",
         "description" : "This search is used to examine web sessions to identify those where the clicks are occurring too quickly for a human or are occurring with a near-perfect cadence (high periodicity or low standard deviation), resembling a script driven session.",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Other",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Web Server",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Web Fraud Detection",
         "journey" : "Stage_1",
         "mitre_tactic" : "|TA0002",
         "data_source_categories" : "DS014WebServer-ET01Access"
      },
      "detection_malicious_requests_to_exploit_jboss_servers" : {
         "journey" : "Stage_2",
         "mitre_tactic" : "TA0001",
         "data_source_categories" : "DS014WebServer-ET01Access",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "JBoss Vulnerability",
         "highlight" : "No",
         "datasource" : "Web Server",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Application Security",
         "icon" : "ES_Use_Case.png",
         "relatedUseCases" : [],
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low",
         "hasSearch" : "No",
         "killchain" : "Delivery",
         "searchKeywords" : "",
         "description" : "This search is used to detect malicious HTTP requests crafted to exploit jmx-console in JBoss servers. The malicious requests have a long URL length, as the payload is embedded in the URL.",
         "mitre_technique" : "|T1203|T1190",
         "search_name" : "ESCU - Detect malicious requests to exploit JBoss servers - Rule",
         "SPLEase" : "None",
         "category" : "Web Attack",
         "released" : "2.0.0",
         "help" : "This search looks for HTTP requests for a URL that has been used to exploit JBoss servers.",
         "includeSSE" : "Yes",
         "name" : "Detect malicious requests to exploit JBoss servers",
         "domain" : "Network",
         "mitre" : "Defense Evasion"
      },
      "detection_aws_activity_in_new_region" : {
         "mitre_technique" : "",
         "search_name" : "ESCU - EC2 Instance Started In Previously Unseen Region - Rule",
         "description" : "This search looks for CloudTrail events where an instance is started in a particular region in the last one hour and then compares it to a lookup file of previously seen regions where an instance was started",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Network",
         "mitre" : "Defense Evasion",
         "name" : "EC2 Instance Started In Previously Unseen Region",
         "includeSSE" : "Yes",
         "help" : "In this search, we query CloudTrail logs to look for events that indicate that an instance was started in a particular region. Using the <code>previously_seen_aws_regions.csv</code> lookup file created using the support search, we compare the region where this instance was started to all previously observed regions. The <code>eval</code> and <code>if</code> functions determine that the earliest times seen for this region and instance were within the last day. If a new region is detected, it will alert you with \"Instance Started in a New Region\". However, this region will be added to the list of <code>previously_seen_aws_regions.csv</code>. Please maintain <code>previously_seen_aws_regions.csv</code>",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS Cryptomining",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0005",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case"
      },
      "detection_create_local_admin_via_net" : {
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "TA0002|TA0003",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "journey" : "Stage_3",
         "story" : "DHS Report TA18-074A",
         "app" : "Enterprise_Security_Content_Update",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "description" : "This search looks for the creation of local administrator accounts using net.exe.",
         "search_name" : "ESCU - Create local admin accounts using net.exe - Rule",
         "mitre_technique" : "T1059",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "includeSSE" : "Yes",
         "name" : "Create local admin accounts using net.exe",
         "mitre" : "Execution|Persistence",
         "domain" : "Endpoint",
         "released" : "2.2.0",
         "category" : "Malware",
         "help" : "Net.exe is a built-in Windows command-line tool that can be used to add, display, or modify user accounts. While Microsoft administrators use this tool to manage user groups, threat actors often leverage it to create local admin accounts to maintain persistence. In this search, we are looking for the execution of process net.exe with command-line parameters such as <code>localgroup</code>, <code>add</code>, or <code>user</code> that may correspond to the creation of local admin accounts or setting user/group properties."
      },
      "showcase_unusual_child_process_for_spoolsv_or_connhost" : {
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0004",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Unusual Child Process for spoolsv.exe or connhost.exe - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Unusual Child Process for spoolsv.exe or connhost.exe - Live"
            }
         ],
         "journey" : "Stage_3",
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/showcase_unusual_child_process_for_spoolsv_or_connhost.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=Unusual Child Process for spoolsv.exe or connhost.exe - Demo",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1068",
         "description" : "<p>In late August 2018, a new Windows Zero Day was announced via Twitter, and the only apparent defense is to detect unusual child processes from spoolsv.exe or connhost.exe. SSE already detected the POC, but this specifically looks for any potential detection.</p>",
         "searchKeywords" : "spoolsv connhost sysmon",
         "killchain" : "Exploitation",
         "hasSearch" : "Yes",
         "mitre" : "Discovery|Lateral Movement|Execution",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This detection should have relatively few false positives given the rarity of new parent processes for these standard Windows processes. Most noise that will come from new systems management scripts, or from new software installers. These can be whitelisted in the search.</p>",
         "relevance" : "As described above, this detection is in response to a particular zero day exploit, described <a href=\"https://doublepulsar.com/task-scheduler-alpc-exploit-high-level-analysis-ff08cda6ad4f\" class=\"external\" target=\"_blank\">here</a>. This exploit allows a user (either legitimate or an attacker-owned account) with limited privileges to escalate to the SYSTEM account. In practical terms, this would allow an attacker who gets the ability to log into a system to be able to permanently maintain persistence on that system, compromise any data persence, and more easily move laterally.",
         "domain" : "Endpoint",
         "name" : "Unusual Child Process for spoolsv.exe or connhost.exe",
         "includeSSE" : "Yes",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. <b>For this search</b> you may wish to alter the process names that are tracked.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify what the child process did. Determine the system it is running on. Contact the user and system owner of this action. If it is authorized, document that this is and by whom. If not, the user credentials have been used by another party and additional investigation is warranted to ensure that processes are not spawning these commands.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch logs from Microsoft Sysmon (EventCode=1). For this analysis, we are looking at the processes spawned by spoolsv.exe or connhost.exe and comparing them against our baseline. If we've seen that process be spawned before, then all is fine, but if we've never seen it before we'll raise an alert.</p>",
         "released" : "2.2.0",
         "category" : "Endpoint Compromise"
      },
      "sser_smb_traffic_allowed" : {
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware",
         "mitre_tactic" : "TA0002|TA0008",
         "examples" : [
            {
               "name" : "Detect SMB Traffic Allowed - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Detect SMB Traffic Allowed - Live",
               "label" : "Live Data"
            },
            {
               "label" : "Accelerated Data",
               "name" : "Detect SMB Traffic Allowed - Accelerated"
            }
         ],
         "journey" : "Stage_1",
         "app" : "Splunk_Security_Essentials",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "Core_Use_Case.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Detect SMB Traffic Allowed - Demo",
         "alertvolume" : "Low",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Reconnaissance|Delivery",
         "description" : "<p>This use case looks for any SMB traffic allowed through your firewall.</p><p><b>Alert Volume:</b> Low</p>",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1210|T1077|T1035",
         "category" : "Operations",
         "released" : "1.0.0",
         "operationalize" : "When this search fires, you will to verify with your firewall block policy to see if SMB should be allowed through to your network. It is a best practice to not allow SMB from the Internet int your network.",
         "help" : "This use case looks for any SMB traffic allowed through your firewall.",
         "howToImplement" : "To run this search, you need data from firewalls or other access control devices that mediate what traffic is allowed into your environment. This is necessary so that the search can identify an 'action' taken on the traffic of interest.",
         "includeSSE" : "Yes",
         "name" : "SMB Traffic Allowed",
         "knownFP" : "This search does not filter for outgoing traffic, and assumes a firewall at the perimeter. You will need to exclude any company-owned subnets where you have firewall visibility, in order to remove false positives.",
         "mitre" : "Execution|Lateral Movement",
         "domain" : "Network"
      },
      "detection_process_launching_netsh" : {
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "usecase" : "Other",
         "icon" : "ES_Use_Case.png",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "story" : "Netsh Abuse",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0002|TA0003|TA0005",
         "journey" : "Stage_3",
         "mitre" : "Execution|Persistence|Defense Evasion",
         "domain" : "Endpoint",
         "name" : "Processes launching netsh",
         "includeSSE" : "Yes",
         "help" : "This search looks for all the parent processes of netsh.exe and returns that process, the command-line used to execute it, the host name, and the user context under which it ran.",
         "released" : "2.2.0",
         "category" : "Abuse",
         "mitre_technique" : "T1059|T1089",
         "search_name" : "ESCU - Processes launching netsh - Rule",
         "description" : "This search looks for processes launching netsh.exe. Netsh is a command-line scripting utility that allows you to, either locally or remotely, display or modify the network configuration of a computer that is currently running. Netsh can be used as a persistence proxy technique to execute a helper DLL when netsh.exe is executed. In this search, we are looking for processes spawned by netsh.exe and executing commands via the command line.",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No"
      },
      "outbreak_detected" : {
         "mitre" : "",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Outbreak Detected",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Lateral Movement|Endpoint Compromise",
         "SPLEase" : "Accelerated",
         "mitre_technique" : "|TA0002",
         "search_name" : "Endpoint - Outbreak Observed - Rule",
         "description" : "Alerts when a potential outbreak is observed based on newly infected systems all exhibiting the same infection",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "relatedUseCases" : [
            "showcase_first_usb",
            "unusual_usb_activity",
            "Basic_Malware_Outbreak",
            "UC0029"
         ],
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Anti-Virus",
         "highlight" : "Yes",
         "app" : "Splunk_App_for_Enterprise_Security",
         "mitre_tactic" : "|TA0002",
         "data_source_categories" : "DS004EndPointAntiMalware-ET01SigDetected",
         "journey" : "Stage_2"
      },
      "basic_gdpr_login_role_check" : {
         "alertvolume" : "High",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_user_logged_in.png",
         "datasource" : "Authentication|Vendor-Specific Data",
         "icon" : "Core_Use_Case.png",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Login to New System GDPR - Demo"
            },
            {
               "name" : "Login to New System GDPR - Live",
               "label" : "Live Data"
            }
         ],
         "name" : "User Logged into In-Scope System They Should Not Have",
         "relevance" : "GDPR gives the right to individuals that they can ask an organization where their data is stored (Article 15) - through data mapping reinforced by controls to detect violation, an organization can identify which vendors/processors accessed the data and might store it and in which other services the data is processed regularly. If you're processing on behalf of a controller data - this search can prove that only authorized individuals have accessed it (Article 28).",
         "knownFP" : "This will fire when someone is not in the documented list, so the most common scenario is that the documented list is just old. You can think about automating the update of the authorized user list and pull it from the source where you DPO holds the definitive record of authorized users. Another option is to generalize and enrich the information to departments who are allowed access by enriching the username with the department names.",
         "mitre" : "Credential Access|Privilege Escalation",
         "category" : "GDPR|IAM Analytics|Lateral Movement|Operations",
         "released" : "2.0.0",
         "howToImplement" : "First, use the results of the data mapping exercise from your data privacy officer to build a lookup that associates systems to the GDPR category. Then do the same for users. Use your data mapping results to build a lookup that associates systems to their GDPR category, and the same for users. At that point, as long as you have the data onboarded with common information model compliance, everything should go smoothly!",
         "operationalize" : "The most likely scenario when this alert fires is that the documentation is simply out of date. Look for indications that someone should be added to the documentation or removed, but validate with your data protection officer or their team before doing so.",
         "SPLEase" : "Basic",
         "killchain" : "Actions on Objective",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Login to New System GDPR - Demo",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "usecase" : "Insider Threat|Compliance",
         "gdpr" : "15|28",
         "journey" : "Stage_4",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-winsec",
         "mitre_tactic" : "TA0006|TA0004|TA0009",
         "app" : "Splunk_Security_Essentials",
         "includeSSE" : "Yes",
         "gdprtext" : "<h4>Problem:</h4><p>Under the GDPR, organizations are required to maintain a complete audit trail about the authorized access of employees/vendors/suppliers to systems and applications that process personal data. </p><h4>Impact:</h4><p>Per GDPR Article 15, individuals have the right to ask an organization where their data is stored. In order to fulfill such a request, an organization will need to identify which vendors and processors have accessed the personal data in question, and also identify and report on which other services the personal data in question is processed regularly. When processing personal data on behalf of a controller - there will also be a requirement to prove that only authorized individuals have accessed the data in question (Article 28). If there is an audit trail that shows unauthorized access, then this will need to be documented and reported to the data privacy authorities.</p>",
         "domain" : "Access",
         "help" : "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Windows Authentication logs, during which someone logs into a new system. Our live search looks for Windows Authentication activity across any index in the standard sourcetype.",
         "description" : "Follow your GDPR requirement and action your data mapping exercise by tracking employee/vendor/supplier access to systems, to ensure that they are authorized to view the data present on any systems they log into.",
         "mitre_technique" : "|T1078|T1213|T1098",
         "hasSearch" : "Yes",
         "searchKeywords" : ""
      },
      "detection_unauthorized_dns_servers" : {
         "usecase" : "Compliance",
         "icon" : "ES_Use_Case.png",
         "datasource" : "DNS",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "story" : "DNS Hijacking",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS002DNS-ET01QueryRequest",
         "mitre_tactic" : "TA0010|TA0011",
         "journey" : "Stage_4",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "SPLEase" : "None",
         "search_name" : "ESCU - DNS Query Requests Resolved by Unauthorized DNS Servers - Rule",
         "mitre_technique" : "T1043|T1048",
         "description" : "This search will detect DNS requests resolved by unauthorized DNS servers. Legitimate DNS servers should be identified in the Enterprise Security Assets and Identity Framework.",
         "searchKeywords" : "",
         "killchain" : "Command and Control",
         "hasSearch" : "No",
         "mitre" : "Exfiltration|Command and Control|Defense Evasion",
         "domain" : "Network",
         "includeSSE" : "Yes",
         "name" : "DNS Query Requests Resolved by Unauthorized DNS Servers",
         "help" : "Clients should be resolving their DNS requests via a trusted DNS server. This search will identify DNS queries being sent to unauthorized DNS servers by comparing the destination and source of the traffic with assets marked as DNS servers.",
         "released" : "2.0.0",
         "category" : "Compliance"
      },
      "high_or_critical_priority_host_with_malware_detected" : {
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0001|TA0002",
         "data_source_categories" : "DS004EndPointAntiMalware-ET01SigDetected",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "highlight" : "Yes",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Anti-Virus",
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : "",
         "alertvolume" : "Other",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "|T1189|T1193|T1192|T1204",
         "search_name" : "Endpoint - High Or Critical Priority Host With Malware - Rule",
         "SPLEase" : "Medium",
         "description" : "Alerts when an infection is noted on a host with high or critical priority.",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "domain" : "Endpoint",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "High Or Critical Priority Host With Malware Detected"
      },
      "AWS_New_API_Call_Per_Peer_Group" : {
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_new_api_peer_group.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=AWS New API Call Per Peer Group - Demo",
         "alertvolume" : "Medium",
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_4",
         "examples" : [
            {
               "name" : "AWS New API Call Per Peer Group - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "AWS New API Call Per Peer Group - Live",
               "label" : "Live Data"
            }
         ],
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0003|TA0004",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "highlight" : "Yes",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple, though the peer group makes things slightly more complicated.<ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. Assuming you use the ubiqutious AWS Add-on for Splunk to pull these logs in, this base search should work automatically for you without issue.</li><li>Save the search.</li></ul></p><p>To configure the Peer Group:<ol><li>Start with a data source that gives you visibility into the peer group -- easiest is usually querying Active Directory via the <a href=\"https://splunkbase.splunk.com/app/1151/\">SA-ldapsearch add-on</a>, but you could get lists of users and their teams / departments / etc from any source you have.</li><li>Next you will need to convert that log source into a format that this lookup is expecting, which is as follows:<table class=\"table\" style=\"width: 300px\"><tr><td>user</td><td>peergroup (order not important)</td></tr><tr><td>john</td><td>john|sarah</td></tr><tr><td>sarah</td><td>john|sarah</td></tr><tr><td>mark</td><td>mark</td></tr></table>The easiest way to do this is with a search like <span class=\"spl\">| inputlookup LDAPSearch.csv | stats values(user) as user by department | eval peergroup=mvjoin(user, \"|\") | mvexpand user</span></li></ol></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache drop-down below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "When this alert fires, you should look at what APIs were called. We've excluded some of the basic inaction ones (such as DescribeInstances), but the severity of the event will vary based on the severity of the API calls. The natural next step is to call the user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred.",
         "help" : "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, as detailed in How to Implement.",
         "released" : "2.0.0",
         "category" : "Account Compromise|IAM Analytics|Insider Threat|SaaS",
         "relevance" : "The risk that this detection intends to reduce is the compromise of an AWS environment, where all of a sudden an account starts accessing AWS APIs that they haven't normally before (such as creating keys, creating AMIs, changing ACLs, etc.). Because this also looks on a peer level, it won't flag for new users or users who have moved teams (provided the peer list is up to date). This firing could suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential data leakage, data deletion, or cost run-up.",
         "domain" : "Access",
         "mitre" : "Credential Access",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise (even though the peer groups help manage noise).</p><p>Specifically for AWS, they have many APIs (and create new ones regularly!), so it's generally best to tune over time for which APIs you actually want to be emailed about, leave the rest for context, or to aggregate risk.</p>",
         "name" : "AWS New API Call Per Peer Group",
         "includeSSE" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "cloudtrail",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1078",
         "SPLEase" : "Advanced",
         "description" : "Looks for users that are using AWS APIs that neither they, nor their team has ever used before."
      },
      "detection_unauthorized_assets_via_mac_address" : {
         "mitre" : "Defense Evasion",
         "domain" : "Network",
         "includeSSE" : "Yes",
         "name" : "Detect Unauthorized Assets by MAC address",
         "help" : "This search requires you to leverage the Enterprise Security Assets and Identity framework to populate assets_by_str.csv. Once the assets_by_str.csv is populated, we then query your DHCP logs to detect unknown systems connecting to your network. More documentation is available at: http://docs.splunk.com/Documentation/ES/4.7.1/Admin/Verifyassetandidentitydata.",
         "released" : "2.0.0",
         "category" : "Compliance",
         "SPLEase" : "None",
         "search_name" : "ESCU - Detect Unauthorized Assets by MAC address - Rule",
         "mitre_technique" : "|T1200",
         "description" : "By populating the organization's assets within the assets_by_str.csv, we will be able to detect unauthorized devices that are trying to connect with the organization's network by inspecting DHCP request packets, which are issued by devices when they attempt to obtain an IP address from the DHCP server. The MAC address associated with the source of the DHCP request is checked against the list of known devices, and reports on those that are not found.",
         "searchKeywords" : "",
         "killchain" : "Reconnaissance|Delivery|Actions on Objective",
         "hasSearch" : "No",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Compliance",
         "datasource" : "IP Address Assignment",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "story" : "Asset Tracking",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS025IPAddressAssignment-ET01General",
         "mitre_tactic" : "TA0001",
         "journey" : "Stage_3"
      },
      "detection_new_user_accounts" : {
         "data_source_categories" : "DS006UserActivity-ET03Create|VendorSpecific-winsec|VendorSpecific-winsec-domaincontroller",
         "mitre_tactic" : "|TA0003",
         "journey" : "Stage_4",
         "story" : "Account Monitoring and Controls",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Audit Trail|Vendor-Specific Data",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "This detection search will help profile user accounts in your environment by identifying newly created accounts that have been added to your network in the past week.",
         "SPLEase" : "None",
         "search_name" : "ESCU - Identify New User Accounts - Rule",
         "mitre_technique" : "|T1136",
         "released" : "2.0.0",
         "category" : "Operations|GDPR",
         "help" : "Adversaries will often seek to create new user accounts as a means of maintaining access to a target environment. Using this search, we identify accounts created in the last week by comparing the start date in the Identity_Management data model against the current time.",
         "gdprtext" : "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
         "name" : "Identify New User Accounts",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Access"
      },
      "detection_new_aws_console_login_by_user" : {
         "description" : "This search looks for CloudTrail events wherein a console login event by a user was recorded within the last hour, then compares the event to a lookup file of previously seen users (by ARN values) who have logged into the console. The alert is fired if the user has logged into the console for the first time within the last hour",
         "search_name" : "ESCU - Detect new user AWS Console Login - Rule",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Detect new user AWS Console Login",
         "domain" : "Network",
         "mitre" : "Credential Access",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "help" : "In this search, we query CloudTrail logs to look for events that indicate that a user has attempted to log in to the AWS console and group the events using ARN value. Using the <code>previously_seen_users_console_logins.csv</code> lookup file created using the support search, we compare the ARN to all the previously seen users logging into the AWS console. The <code>eval</code> and <code>if</code> functions determine whether the earliest time we see this user ARN was seen within the last hour. The alert will be fired only when a user is seen for first time in the last hour.",
         "highlight" : "No",
         "datasource" : "Audit Trail|Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0006",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious AWS Login Activities",
         "alertvolume" : "Medium",
         "mitre_notes" : "MITRE ATT&CK enterprise does not have good cataloging of cloud based activity.",
         "dashboard" : "ESCU_Use_Case"
      },
      "showcase_new_sfdc_tables" : {
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
         "mitre" : "Discovery|Collection",
         "domain" : "Data",
         "gdprtext" : "<h4>Impact:</h4><p>Detecting first-time query attempts to sensitive tables by a user who has previously not accessed the tables in question, can help prove that individuals within the organization are not abusing or misusing legitimate access to assets.</p><p>This can relate to GDPR in that in-scope assets will store and process personal data. This method is an industry best practice and can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). </p>",
         "name" : "New Tables Queried by Salesforce.com User",
         "includeSSE" : "Yes",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, and tables queried. If possible, determine the system the user is using and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "help" : "<p>This is the generic search builder for First Seen Detection. Our dataset is an anonymized data collection from an actual customer environment.</p>",
         "released" : "1.4.0",
         "category" : "Data Exfiltration|GDPR|SaaS",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1213|T1018",
         "description" : "<p>Salesforce.com supports a simplified query language called SOQL. This search detects users who begin querying new sensitive tables.</p><p><b>Alert Volume:</b> Low</p>",
         "searchKeywords" : "salesforce sfdc",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_new_table_user.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New SFDC Tables Queried by User - Demo",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Compliance|Insider Threat",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "VendorSpecific-sfdc-elf",
         "mitre_tactic" : "TA0007|TA0009",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "New SFDC Tables Queried by User - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "New SFDC Tables Queried by User - Live"
            }
         ]
      },
      "detection_osx_coldroot_pack" : {
         "killchain" : "Installation|Command and Control",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "description" : "This search looks for ColdRoot events from the osx-attacks osquery pack.",
         "help" : "The search looks at the Alerts data model to identify those  generated from the osquery osx-attacks.conf pack, which search for the ColdRoot RAT.",
         "released" : "2.2.0",
         "category" : "Malware",
         "mitre" : "Execution|Persistence|Command and Control",
         "incluseSSE" : "No",
         "domain" : "Threat",
         "includeSSE" : "Yes",
         "name" : "Osquery pack - ColdRoot detection",
         "story" : "ColdRoot MacOS RAT",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0002|TA0003|TA0011",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "journey" : "Stage_3",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "old_passwords" : {
         "name" : "Old Passwords in Use",
         "includeSSE" : "Yes",
         "relevance" : "Accounts that have out-dated passwords leave an organization subject to brute force, or exposed to abuse from ex-employees. It is best practice to change passwords every ninety days for most organizations -- this search will look through Active Directory for accounts with out-of-date passwords.",
         "domain" : "Access",
         "mitre" : "Credential Access",
         "knownFP" : "Whether this search generates false positives or not is generally dependent upon your organization's security policy. Some organizations are permissive of service accounts that have older passwords -- this is discouraged by security best practices and many auditors, but it could be permissible. The only scenario where this detection might not function as expected is when the authentication doesn't update the lastLogonTimestamp parameter in Active Directory -- this occurs most frequently for systems that don't authenticate through the standard Windows mechanism (such as Linux systems connecting to Identity Management for Unix). In that scenario, it is prudent to employ basic checks for just old passwords, ignoring the last use timestamp.",
         "released" : "2.1.0",
         "category" : "Compliance|GDPR",
         "howToImplement" : "<p>There are multiple approaches for pulling Active Directory data:<ul><li>Using the Supporting Add-on for Active Directory (aka SA-ldapsearch) which provides the ldapsearch command -- recommended for on premises installations in organizations with fewer than 50,000 users (<a href=\"https://splunkbase.splunk.com/app/1151/\" target=\"_blank\">app link</a>, <a href=\"http://docs.splunk.com/Documentation/SA-LdapSearch/2.1.6/User/AbouttheSplunkSupportingAdd-onforActiveDirectory\" target=\"_blank\">docs link</a>).</li><li>Using data from AD Monitor, which is the Splunk Universal Forwarder's ability to monitor Active Directory for changes -- recommended for large organizations, and for Cloud environments (<a href=\"http://docs.splunk.com/Documentation/Splunk/7.0.2/Data/MonitorActiveDirectory\" target=\"_blank\">doc link</a>).</li><li>Using a Powershell script to query Active Directory for this data (<a href=\"https://gallery.technet.microsoft.com/scriptcenter/Powershell-script-to-5edcdaea\" target=\"_blank\">link</a>).</li></ul></p><p>Once the data is ingested, select the search option that matches your data type, and the rest should flow smoothly. The only other consideration you may wish to employ is scheduling the search with throttling on the username, so that while you run the search daily, you don't get repeated alerts. Enterprise Security customers can leverage the suppression rules for more granular control, specifying an event-specific (and so account-specific) suppression period, but all customers can opt to only alert once per week/month/etc, to avoid duplicate alerts.</p>",
         "operationalize" : "When this search fires, the first thing to do is to determine based on policy whether the account with an old password is expected. If it is, add it to the account whitelist. If it is not, work with the account owner to change the password and update any systems that may be using the saved password.",
         "help" : "<p>This example leverages the Simple Search Assistant. Our dataset is the anonymized output of running an LDAP Search against a typical domain, pulling out a set of AD attributes. There are several ways to pull this data from live environments, including the Live Search listed below.</p>",
         "description" : "Detect active accounts with passwords that haven't been updated in more than 120 days.",
         "mitre_technique" : "|T1110",
         "SPLEase" : "Basic",
         "hasSearch" : "Yes",
         "killchain" : "",
         "searchKeywords" : "",
         "alertvolume" : "Medium",
         "mitre_notes" : "Cyber hygiene to change passwords",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Old Passwords In Use - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/old_passwords_in_use.png",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Compliance",
         "journey" : "Stage_1",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Old Passwords In Use - Demo"
            },
            {
               "label" : "Using LDAPSearch",
               "name" : "Old Passwords In Use - LDAPSearch"
            },
            {
               "label" : "Using CSV File",
               "name" : "Old Passwords In Use - CSV"
            }
         ],
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0006",
         "app" : "Splunk_Security_Essentials"
      },
      "detection_samsam_test_file_write" : {
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "SamSam Ransomware",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low",
         "hasSearch" : "No",
         "killchain" : "Delivery",
         "description" : "The search looks for a file named \"test.txt\" written to the windows system directory tree, which is consistent with Samsam propagation.",
         "mitre_technique" : "",
         "category" : "Malware|",
         "released" : "2.2.0",
         "help" : "This search looks at file modifications across your hosts and monitors for a file named \"test.txt\" written to \"windows\\system32\". This file is copied to potential targets during SamSam ransomware attacks to test the attacker's ability to access remote systems. If the file is successfully copied to the system, the system is added to a list of targets on which to deploy ransomware.",
         "includeSSE" : "Yes",
         "name" : "Samsam Test File Write",
         "domain" : "Endpoint",
         "incluseSSE" : "No",
         "mitre" : ""
      },
      "UC0021" : {
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Outbound communication with servers hosted in regions where the organization does not expect to have employees, customers, or suppliers. ",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Network",
         "name" : "Communication outbound to regions without business relationship",
         "includeSSE" : "No",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Command and Control|Endpoint Compromise",
         "released" : "2.0.0",
         "usecase" : "Advanced Threat Detection",
         "icon" : "PS_Use_Case.png",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "IDS or IPS",
         "highlight" : "No",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case"
      },
      "high_volume_of_traffic_from_high_or_critical_host_observed" : {
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0010",
         "data_source_categories" : "DS005WebProxyRequest-ET01Requested",
         "app" : "Splunk_App_for_Enterprise_Security",
         "highlight" : "Yes",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Web Proxy",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring|Insider Threat",
         "mitre_notes" : "",
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "Alerts when a host of high or critical severity generates a high volume of outbound traffic. This may indicate that the host has been compromised.",
         "mitre_technique" : "|T1048|T1041",
         "SPLEase" : "Accelerated",
         "category" : "Endpoint Compromise|Data Exfiltration|Insider Threat",
         "released" : "2.0.0",
         "help" : "Help not needed -- ES Use Case",
         "includeSSE" : "Yes",
         "name" : "High Volume of Traffic from High or Critical Host Observed",
         "domain" : "Network",
         "mitre" : ""
      },
      "detection_netbackup_no_backups_in_time_period" : {
         "alertvolume" : "Low",
         "mitre_notes" : "Cyber hygiene to ensure backup completion",
         "dashboard" : "ESCU_Use_Case",
         "datasource" : "Backup",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "usecase" : "Compliance",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "",
         "data_source_categories" : "DS027EndpointBackup-ET01General",
         "journey" : "Stage_1",
         "story" : "Monitor Backup Solution",
         "app" : "Enterprise_Security_Content_Update",
         "name" : "Extended Period Without Successful Netbackup Backups",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Endpoint",
         "released" : "2.0.0",
         "category" : "Compliance",
         "help" : "This search finds all the successful backup messages in your logs, and then looks for the most recent backup time for each system. It then identifies those systems where the most recent successful backup time is over a week ago, and reports on them.",
         "description" : "This search returns a list of hosts that have not successfully completed a backup in over a week.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "search_name" : "ESCU - Extended Period Without Successful Netbackup Backups - Rule",
         "hasSearch" : "No",
         "searchKeywords" : ""
      },
      "high_volume_email_activity_to_noncorporate_domains_by_user" : {
         "app" : "Splunk_App_for_Enterprise_Security",
         "mitre_tactic" : "|TA0010",
         "data_source_categories" : "DS001MAIL-ET03Send",
         "journey" : "Stage_3",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Email",
         "highlight" : "No",
         "dashboard" : "ES_Use_Case",
         "relatedUseCases" : [
            "detection_email_attachments_with_spaces",
            "showcase_external_emails_with_internal_domain",
            "showcase_spike_in_outgoing_email",
            "detection_suspicious_email_attachments",
            "UC0004"
         ],
         "alertvolume" : "Other",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "SPLEase" : "Accelerated",
         "mitre_technique" : "|TA0010",
         "search_name" : "Identity - High Volume Email Activity with Non-corporate Domains - Rule",
         "description" : "Alerts on high volume email activity by a user to non-corporate domains.",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise|Data Exfiltration|Insider Threat",
         "mitre" : "",
         "domain" : "Identity",
         "includeSSE" : "Yes",
         "name" : "High Volume Email Activity to Non-corporate Domains by User"
      },
      "showcase_increase_interactive_logon" : {
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "journey" : "Stage_1",
         "examples" : [
            {
               "name" : "Increase in Interactive Logons - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Increase in Interactive Logons - Live"
            }
         ],
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0008|TA0004|TA0003",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Low",
         "similarUseCases" : [
            "showcase_many_hosts",
            "showcase_increase_in_interactively_logged_on_users"
         ],
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Increase in Interactive Logons - Demo",
         "description" : "<p>Typically non-admin users will only interactively log into one system per day. A user who starts loggin into many can indicate account compromise and lateral movement. (<a href=\"https://car.mitre.org/wiki/CAR-2013-02-012\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>",
         "mitre_technique" : "|TA0008|T1078|T1021",
         "SPLEase" : "Medium",
         "hasSearch" : "Yes",
         "killchain" : "Installation|Actions on Objective",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Significant Increase in Interactive Logons",
         "relevance" : "By monitoring the number of interactively logged in users to assets, security teams can identify anomalies that may indicate the compromise of an asset or credentials. A spike in users on a particular asset could be an indicate that the asset was compromised and additional system level user accounts are being created for malicious purposes, or if they are valid credentials in AD that accounts have been compromised and the adversary is testing the accounts against a particular asset or groups of assets to test and or escalate privileges to gain deeper access to critical assets and infrastructure.",
         "domain" : "Access",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
         "mitre" : "Lateral Movement",
         "category" : "Lateral Movement",
         "released" : "1.0.0",
         "operationalize" : "When this search returns values, initiate your incident response process and capture the event times, the user account and systems, process and other pertinent information. Contact the owners of the systems. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of Windows Logon events, filtered to interactive logon types (Local: 2, RemoteInteractive: 10, Cached Local: 11). For this analysis, we are tracking the number of unique hosts the user has interactively logged into per day 'dc(host) by user _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average.</p>"
      },
      "UC0029" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "When a new malware variant is detected by endpoint antivirus technology it is possible the configuration or capability of other controls are deficient. Review the sequence of events leading to the infection to determine if additional preventive measures can be put in place.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "includeSSE" : "No",
         "name" : "New malware detected by signature",
         "mitre" : "",
         "domain" : "Endpoint",
         "mitre_tactic" : "",
         "journey" : "Stage_2",
         "app" : "Splunk_Professional_Services",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Anti-Virus",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "PS_Use_Case.png",
         "dashboard" : "PS_Use_Case",
         "similarUseCases" : [
            "Basic_Malware_Outbreak",
            "Recurring_Infection_on_Host",
            "high_number_of_infected_hosts",
            "host_with_a_recurring_malware_infection",
            "host_with_multiple_infections",
            "UC0028",
            "UC0075",
            "UC0065"
         ],
         "relatedUseCases" : [
            "showcase_first_usb",
            "unusual_usb_activity",
            "Basic_Malware_Outbreak",
            "outbreak_detected"
         ],
         "alertvolume" : "Other"
      },
      "AWS_Cloud_Provisioning_Activity_from_Unusual_IP" : {
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "|TA0003|TA0004",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "AWS Cloud Provisioning Activity from Unusual IP - Demo"
            },
            {
               "name" : "AWS Cloud Provisioning Activity from Unusual IP - Live",
               "label" : "Live Data"
            }
         ],
         "alertvolume" : "High",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_provisioning_unusual_ip.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=AWS Cloud Provisioning Activity from Unusual IP - Demo",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1078",
         "description" : "Looks for AWS Provisioning activities that occur from new IPs (for organizations with strict IP controls).",
         "searchKeywords" : "cloudtrail",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "mitre" : "",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>For most organizations, this search is not going to be useful apart from contextual data (i.e., when we are analyzing another alert related to account compromise, we can also see that this user logged in from an unusual IP). The reason is that most organizations don't apply strict controls to what IPs are allowed to reach out to their AWS orchestration environments. However, if your organization does have strict controls, and all of a sudden a new IP shows up, that could be very noteworthy. </p>",
         "relevance" : "The risk that this detection intends to reduce is the compromise of an AWS environment, where all of a sudden provisioning occurs from IP Addresses that have not been seen before (only applicable for organizations that have strict policies around IP Addresses for AWS Access). Assuming that the user is not traveling, and that new orchestration tools are not being used, this would suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential data leakage, data deletion, or cost run-up.",
         "domain" : "Access",
         "includeSSE" : "Yes",
         "name" : "AWS Cloud Provisioning Activity from Unusual IP",
         "operationalize" : "For organizations that have strict allowed IPs for cloud orchestration, you may opt to use Splunk's Adaptive Response Actions to automatically disable an account that is doing provisioning from a new IP. More commonly, the concern is account compromise so it is prudent to immediately call the user and find out if they intended to take those actions.",
         "howToImplement" : "Assuming you use the ubiquitous AWS Add-on for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
         "help" : "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, as detailed in How to Implement.",
         "category" : "Account Compromise|IAM Analytics|Account Sharing|SaaS",
         "released" : "2.0.0"
      },
      "detection_shim_database_file_creation" : {
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "TA0003",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "journey" : "Stage_3",
         "story" : "Windows Persistence Techniques",
         "app" : "Enterprise_Security_Content_Update",
         "name" : "Shim Database File Creation",
         "includeSSE" : "Yes",
         "mitre" : "Persistence",
         "domain" : "Endpoint",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "This search looks for files being created in <code>Windows\\AppPatch\\Custom and Windows\\AppPatch\\Custom64</code>, the location where shim databases are installed. It will return all the files created, as well as the time of creation for the first and last file for each endpoint.",
         "description" : "This search looks for shim database files being written to default directories. The sdbinst.exe application is used to install shim database files (.sdb). According to Microsoft, a shim is a small library that transparently intercepts an API, changes the parameters passed, handles the operation itself, or redirects the operation elsewhere.",
         "SPLEase" : "None",
         "mitre_technique" : "T1138",
         "search_name" : "ESCU - Shim Database File Creation - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective"
      },
      "detection_windows_event_log_cleared" : {
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0005",
         "data_source_categories" : "VendorSpecific-winsec",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Ransomware",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "similarUseCases" : [
            "sser_windows_event_log_clearing_events",
            "detection_suspicious_wevtutil_usage",
            "sser_detect_log_clearing_with_wevtutil"
         ],
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "This search looks for Windows events that indicate one of the Windows event logs has been purged.",
         "search_name" : "ESCU - Windows Event Log Cleared - Rule",
         "mitre_technique" : "T1070",
         "SPLEase" : "None",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "This search looks at the Windows security and system event logs. EventCode 1002 in the security log indicates that the log has been cleared, EventCode 1000 in the security log indicates the event logging service has been shut down, and EventCode 104 in the system log indicates the application log has been cleared. If any of these events are found, a notable will be generated.",
         "name" : "Windows Event Log Cleared",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion"
      },
      "new_user_account_created_on_multiple_hosts" : {
         "domain" : "Endpoint",
         "mitre" : "",
         "name" : "New User Account Created On Multiple Hosts",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Lateral Movement|Endpoint Compromise",
         "search_name" : "Endpoint - Anomalous User Account Creation - Rule",
         "mitre_technique" : "|T1078|T1136",
         "SPLEase" : "Advanced",
         "description" : "Alerts when numerous new accounts are created for a username accounts multiple hosts.",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "mitre_notes" : "",
         "dashboard" : "ES_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "highlight" : "No",
         "datasource" : "Audit Trail|Vendor-Specific Data",
         "displayapp" : "Splunk App for Enterprise Security",
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0003",
         "data_source_categories" : "DS006UserActivity-ET03Create|VendorSpecific-winsec"
      },
      "showcase_spike_in_sfdc_document_downloads" : {
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Spike in SFDC Documents Downloaded - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_spike_downloaded_docs.png",
         "alertvolume" : "Medium",
         "data_source_categories" : "VendorSpecific-sfdc-elf",
         "mitre_tactic" : "TA0009",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Spike in SFDC Documents Downloaded - Demo"
            },
            {
               "name" : "Spike in SFDC Documents Downloaded - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "app" : "Splunk_Security_Essentials",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat",
         "released" : "1.4.0",
         "category" : "Data Exfiltration|SaaS",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, and number of documents downloaded. If possible, determine the system the user is using to download this data and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized data collection from an actual customer environment.</p>",
         "name" : "Spike in Downloaded Documents Per User from Salesforce.com",
         "includeSSE" : "Yes",
         "mitre" : "Collection",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
         "domain" : "Data",
         "hasSearch" : "Yes",
         "searchKeywords" : "salesforce sfdc",
         "killchain" : "Actions on Objective",
         "description" : "<p>Salesforce.com contains the most critical information for many companies. This example tracks the number of documents downloaded per day per user, to detect exfiltration.</p><p><b>Alert Volume:</b> Medium</p>",
         "SPLEase" : "Hard",
         "mitre_technique" : "|T1213"
      },
      "suspicious_domain_name" : {
         "mitre" : "",
         "domain" : "Other",
         "name" : "Suspicious Domain Name",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.0.0",
         "category" : "Command and Control|Endpoint Compromise|Data Exfiltration",
         "mitre_technique" : "|T1323",
         "description" : "Detects algorithmically generated domain names using a machine learning model.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "datasource" : "DNS|Web Proxy",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "app" : "Splunk_User_Behavior_Analytics",
         "data_source_categories" : "DS002DNS-ET01QueryRequest|DS005WebProxyRequest-ET01Requested",
         "mitre_tactic" : "|TA0021",
         "journey" : "Stage_6"
      },
      "high_process_count" : {
         "searchKeywords" : "",
         "hasSearch" : "No",
         "SPLEase" : "Accelerated",
         "mitre_technique" : "|T1035",
         "search_name" : "Endpoint - Host With Excessive Number Of Processes - Rule",
         "description" : "Alerts when host has a high number of processes. This may be due to an infection or a runaway process.",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "mitre" : "",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "High Process Count",
         "app" : "Splunk_App_for_Enterprise_Security",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "|TA0002",
         "journey" : "Stage_3",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other"
      },
      "UC0103" : {
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "app" : "Splunk_Professional_Services",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Network Communication",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Detect lateral movement by searching for hosts with an unusually high number of connections to hosts it has never connected to before, within a given time period.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "category" : "Scanning|Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "name" : "High Number of Newly Seen Connections to Internal Hosts",
         "includeSSE" : "No",
         "mitre" : "",
         "domain" : "Network"
      },
      "detection_dns_tunnelling" : {
         "help" : "The search will calculate the distinct count and sum of the length of DNS queries made and DNS answers received by a particular host to alert the analyst if the combined length is greater than 10000, which is not typical behavior.",
         "category" : "Command and Control",
         "released" : "2.0.0",
         "mitre" : "Command and Control|Exfiltration",
         "domain" : "Network",
         "includeSSE" : "Yes",
         "name" : "Detection of DNS Tunnels",
         "searchKeywords" : "",
         "killchain" : "Command and Control|Actions on Objective",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "search_name" : "ESCU - Detection of DNS Tunnels - Rule",
         "mitre_technique" : "T1043|T1048|TA0005",
         "description" : "This search is used to detect DNS tunneling, by calculating the sum of the length of DNS queries and DNS answers. The search also filters out potential false positives by filtering out queries made to internal systems and the queries originating from internal DNS, Web, and Email servers. Endpoints using DNS as a method of transmission for data exfiltration, command and control, or evasion of security controls can often be detected by noting an unusually large volume of DNS traffic.",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "High",
         "story" : "Data Protection",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0011|TA0010|TA0005",
         "data_source_categories" : "DS002DNS-ET01QueryRequest",
         "journey" : "Stage_3",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "datasource" : "DNS",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No"
      },
      "detection_unusually_long_content-type_length" : {
         "help" : "This detection search uses HTTP traffic data captured with Splunk Stream.  The search is constructed to use \"stream:http\" sourcetype and counts of the number of times an HTTP request is received by a destination which the length of the Content-Type header value the client sends the server is greater than 100 characters long. We calculate this content_type_length field and output the results.",
         "released" : "2.0.0",
         "category" : "Web Attack",
         "mitre" : "Defense Evasion",
         "domain" : "Network",
         "name" : "Unusually Long Content-Type Length",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Delivery",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "mitre_technique" : "|T1320",
         "search_name" : "ESCU - Unusually Long Content-Type Length - Rule",
         "description" : "This search looks for unusually long strings in the Content-Type http header that the client sends the server.",
         "dashboard" : "ESCU_Use_Case",
         "mitre_notes" : "need to revisit",
         "alertvolume" : "Low",
         "story" : "Apache Struts Vulnerability",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0005|TA0021",
         "data_source_categories" : "DS014WebServer-ET01Access",
         "journey" : "Stage_1",
         "usecase" : "Application Security",
         "icon" : "ES_Use_Case.png",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Web Server",
         "highlight" : "Yes"
      },
      "detection_outbound_smb_connections" : {
         "help" : "In this search, we are looking for the network connections that were not blocked by the firewall and that are destined for destination port 139 or 445. We then filter out events that have Classless Inter-Domain Routing (CIDR) blocks categorized as internal in the <code>assets_by_cidr.csv</code> lookup file which is located in <code>$SPLUNK_HOME/etc/apps/SA-IdentityManagement/lookups/</code>. Since we are only looking for outbound traffic from the hosts made to the Internet, we filter out traffic whose destination IP address is private.",
         "released" : "2.2.0",
         "category" : "Malware",
         "mitre" : "Credential Access|Lateral Movement",
         "domain" : "Network",
         "name" : "Detect Outbound SMB Traffic",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective|Command and Control",
         "hasSearch" : "No",
         "mitre_technique" : "T1043",
         "search_name" : "ESCU - Detect Outbound SMB Traffic - Rule",
         "description" : "This search looks for outbound SMB connections made by hosts within your network to the Internet. SMB traffic is used for Windows file-sharing activity. One of the techniques often used by attackers involves retrieving the credential hash using an SMB request made to a compromised server controlled by the threat actor.",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "story" : "Hidden Cobra Malware",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "TA0006|TA0008",
         "journey" : "Stage_1",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Network Communication",
         "highlight" : "No"
      },
      "AWS_Instance_Modified_by_Unusual_User" : {
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "|TA0003|TA0004",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "AWS Instance Modified by Unusual User - Demo"
            },
            {
               "name" : "AWS Instance Modified by Unusual User - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "alertvolume" : "Medium",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_modified_unusual_user.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=AWS Instance Modified by Unusual User - Demo",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1078",
         "description" : "Detects the first time a user modifies an existing instance.",
         "searchKeywords" : "cloudtrail",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>For this use case, you probably don't care every time a new user starts modifying instances in a large environment, but you may care when they change resources in sensitive VPCs. Smaller organizations with a limited number of admins would likely care the minute that a new account is created. For all organizations, having this data around for context or to aggregate risk is extremely useful!</p>",
         "mitre" : "",
         "relevance" : "The risk that this detection intends to reduce is the compromise of an AWS environment, where all of a sudden instance modification occurs by a user that isn't known to modify instances. Assuming that the user has not changed roles, and that new orchestration tools are not being used, this would suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential data leakage, data deletion, or cost run-up.",
         "domain" : "Access",
         "name" : "AWS Instance Modified by Unusual User",
         "includeSSE" : "Yes",
         "help" : "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, as detailed in How to Implement.",
         "operationalize" : "When this alert fires, call the user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred.",
         "howToImplement" : "Assuming you use the ubiqutious AWS Add-on for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
         "category" : "Account Compromise|IAM Analytics|SaaS",
         "released" : "2.0.0"
      },
      "detection_protocols_authenticating_in_cleartext" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Reconnaissance|Actions on Objective",
         "description" : "This search looks for cleartext protocols at risk of leaking credentials. Currently, this consists of legacy protocols such as telnet, POP3, IMAP, and non-anonymous FTP sessions. While some of these protocols can be used over SSL, they typically run on different assigned ports in those cases.",
         "SPLEase" : "None",
         "mitre_technique" : "|T1040",
         "search_name" : "ESCU - Protocols passing authentication in cleartext - Rule",
         "released" : "2.0.0",
         "category" : "Compliance",
         "help" : "This search is checking for traffic on well-known ports that are associated with protocols that pass authentication in cleartext.",
         "includeSSE" : "Yes",
         "name" : "Protocols passing authentication in cleartext",
         "mitre" : "Credential Access|Lateral Movement|Collection",
         "domain" : "Network",
         "mitre_tactic" : "TA0006",
         "data_source_categories" : "DS010NetworkCommunication-ET03UserAware",
         "journey" : "Stage_2",
         "story" : "Use of Cleartext Protocols",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "Network Communication",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Compliance",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "detection_reg_used_to_hide_files" : {
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion|Persistence",
         "name" : "Reg.exe used to hide files/directories via registry keys",
         "includeSSE" : "Yes",
         "help" : "Reg.exe is a binary native to Windows platform used to edit the registry hives of the system. Attackers can leverage this binary to hide files by passing in arguments that are used to hide the files. In the search, we first gather results with keywords, add, Hidden, and REG_DWORD, that will be in the raw event and filter by process and the command-line. We then leverage regular expressions on the command-line field to look for /d value as 2 which is responsible for hiding a file or directory.",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "search_name" : "ESCU - Reg.exe used to hide files/directories via registry keys - Rule",
         "mitre_technique" : "|T1060|T1112",
         "SPLEase" : "None",
         "description" : "The search looks for command-line arguments used to hide a file or directory using the reg add command.",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Windows Persistence Techniques",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0005",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch"
      },
      "excessive_failed_logins" : {
         "description" : "Detects excessive number of failed login attempts (this is likely a brute force attack)",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1110",
         "search_name" : "Access - Excessive Failed Logins - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "name" : "Excessive Failed Logins",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Access",
         "released" : "2.0.0",
         "category" : "Lateral Movement|IAM Analytics",
         "help" : "Help not needed -- ES Use Case",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Authentication",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "mitre_tactic" : "|TA0006",
         "data_source_categories" : "DS003Authentication-ET02Failure",
         "journey" : "Stage_2",
         "app" : "Splunk_App_for_Enterprise_Security",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "relatedUseCases" : [
            "Basic_Scanning",
            "showcase_first_logon",
            "detection_no_win_updates_in_timeframe"
         ],
         "similarUseCases" : [
            "basic_brute_force",
            "brute_force_access_behavior_detected",
            "brute_force_access_behavior_detected_over_one_day",
            "UC0099",
            "UC0108",
            "UC0109"
         ]
      },
      "prohibited_port_activity_detected" : {
         "usecase" : "Advanced Threat Detection|Compliance",
         "icon" : "ES_Use_Case.png",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "No",
         "app" : "Splunk_App_for_Enterprise_Security",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "|TA0011",
         "journey" : "Stage_4",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1065",
         "search_name" : "Network - Unapproved Port Activity Detected - Rule",
         "description" : "Detects the use of ports that are prohibited. Useful for detecting the installation of new software or a successful compromise of a host (such as the presence of a backdoor or a system communicating with a botnet).",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Network",
         "gdprtext" : "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
         "includeSSE" : "Yes",
         "name" : "Prohibited Port Activity Detected",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Lateral Movement|Endpoint Compromise|GDPR"
      },
      "gdpr_glass_table" : {
         "category" : "GDPR",
         "released" : "2.1.0",
         "help" : "Help not needed -- ES Use Case",
         "name" : "Auditing Overview of Data Processing Systems (Glass Table)",
         "includeSSE" : "Yes",
         "domain" : "Data",
         "mitre" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "Understand and monitor the compliance of API and user connections to systems with sensitive data for GDPR Compliance.",
         "mitre_technique" : "",
         "dashboard" : "gdpr_glass_table?load=1",
         "mitre_notes" : "Not an attacker technique",
         "alertvolume" : "Other",
         "journey" : "Stage_5",
         "mitre_tactic" : "",
         "data_source_categories" : "DS034ApplicationLogs-ET01General|DS006UserActivity-ET01List|DS006UserActivity-ET02Read|DS006UserActivity-ET03Create|DS006UserActivity-ET04Update|DS006UserActivity-ET05Delete|VendorSpecific-sfdc-elf",
         "app" : "Splunk_App_for_Enterprise_Security",
         "highlight" : "Yes",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Application Logs|Audit Trail|Vendor-Specific Data",
         "usecase" : "Compliance",
         "icon" : "ES_Use_Case.png"
      },
      "sser_monitor_unsuccessful_windows_updates" : {
         "alertvolume" : "Low",
         "mitre_notes" : "Cyber hygiene monitoring",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Windows Updates Install Failure - Demo",
         "usecase" : "Security Monitoring",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Patch Management",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "",
         "data_source_categories" : "DS019PatchManagement-Failed",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Windows Updates Install Failure - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Windows Updates Install Failure - Live"
            }
         ],
         "journey" : "Stage_1",
         "mitre" : "",
         "knownFP" : "None at the moment",
         "domain" : "Operations",
         "includeSSE" : "Yes",
         "name" : "Monitor Unsuccessful Windows Updates",
         "help" : "Keeping current with Microsoft updates for Windows is one of the best ways to prevent WannaCry and other ransomware attacks. This use case evaluates Windows event logs and Windows update logs to identify hosts that have failed to implement the appropriate updates.",
         "operationalize" : "When this search files, you'll want to investigate why the update was not successfully applied to the system.",
         "howToImplement" : "This use case requires a universal forwarder on the Windows endpoints you wish to monitor as well as the Windows add-on configured to send your logs to Splunk. You can also implement this use case using Windows event logs.",
         "category" : "Operations",
         "released" : "1.0.0",
         "SPLEase" : "Basic",
         "mitre_technique" : "",
         "description" : "<p>Keeping current with Microsoft updates for Windows is one of the best ways to prevent malware. This example identifies hosts that have failed to implement appropriate updates.</p><p><b>Alert Volume:</b> Low</p>",
         "searchKeywords" : "",
         "hasSearch" : "Yes"
      },
      "UC0097" : {
         "usecase" : "Security Monitoring",
         "icon" : "PS_Use_Case.png",
         "datasource" : "Authentication",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "Yes",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Executive or VIP user credentials should be limited to assets that can be attributed to them. Any unusual or newly seen authentication activity should be considered suspect, where their credentials may be compromised.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Access",
         "includeSSE" : "No",
         "name" : "Newly Seen Authentication Behavior from VIP or Executive User",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Account Compromise|Account Sharing",
         "released" : "2.0.0"
      },
      "detection_system_processes_run_from_unexpected_locations" : {
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0005",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Unusual Processes",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "This search looks for system processes that normally run out of C:\\Windows\\System32\\ or C:\\Windows\\SysWOW64 that are not run from that location.  This can indicate a malicious process that is trying to hide as a legitimate process.",
         "mitre_technique" : "T1036",
         "search_name" : "ESCU - System Processes Run From Unexpected Locations - Rule",
         "SPLEase" : "None",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "This search returns all the processes that are not executing out of the C:\\Windows\\System32 or C:\\Windows\\SysWOW64 directories. It then uses a regular expression to extract the file name of the running process. Next, it takes the filename and looks it up in a table of files that should normally run out of the C:\\Windows\\System32 or C:\\Windows\\SysWOW64 directory. Any matches are then returned.",
         "name" : "System Processes Run From Unexpected Locations",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion"
      },
      "detection_execution_of_nirsoft_tools" : {
         "description" : "This search looks for specific command-line arguments that may indicate the execution of tools made by Nirsoft, which are legitimate, but may be abused by attackers.",
         "search_name" : "ESCU - Detection of tools built by NirSoft - Rule",
         "mitre_technique" : "T1087|T1072|T1059|T1081",
         "hasSearch" : "No",
         "killchain" : "Installation|Actions on Objective",
         "includeSSE" : "Yes",
         "name" : "Detection of tools built by NirSoft",
         "incluseSSE" : "No",
         "mitre" : "",
         "domain" : "Endpoint",
         "category" : "Malware|",
         "released" : "2.2.0",
         "help" : "The search looks for process-creation events accompanied by specific command-line arguments (\"scomma\" and \"stext\"). These parameters may be leveraged by a set of free, legitimate tools built by NirSoft. Attackers have been seen abusing the tools' capabilities to steal passwords, set up key loggers, recover account information from mail clients, and conduct other nefarious activities. The search will identify the count, the first and last times a process is executed, the command-line arguments, and the parent process.",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "mitre_tactic" : "|TA0002|TA0006",
         "journey" : "Stage_3",
         "story" : "Emotet Malware (TA18-201A)",
         "app" : "Enterprise_Security_Content_Update",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case"
      },
      "detection_new_connections_to_routers" : {
         "mitre_tactic" : "|TA0001",
         "data_source_categories" : "DS003Authentication-ET01Success|DS003Authentication-ET02Failure",
         "journey" : "Stage_2",
         "story" : "Router & Infrastructure Security",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Authentication",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "The search queries the authentication logs for assets that are categorized as routers in the ES Assets and Identity Framework, to identify connections that have not been seen before in the last 30 days.",
         "SPLEase" : "None",
         "search_name" : "ESCU - Detect New Login Attempts to Routers - Rule",
         "mitre_technique" : "|T1078",
         "category" : "Operations",
         "released" : "2.0.0",
         "help" : "Attackers will often attempt to compromise network devices such as routers for a variety of nefarious purposes, including modifying VPN settings or re-routing network traffic. Typically, only a relatively small number of user accounts log into these devices on a regular basis. This search identifies 'new' connections to your routers by checking to see if a similar login was made in the last 30 days. Routers are identified by checking the IP address against those categorized as a \"router\" in the ES assets and identity framework.",
         "name" : "Detect New Login Attempts to Routers",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Network"
      },
      "multiple_primary_functions_detected" : {
         "domain" : "Endpoint",
         "mitre" : "",
         "name" : "Multiple Primary Functions Detected",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Operations",
         "mitre_technique" : "",
         "search_name" : "Endpoint - Multiple Primary Functions Detected - Rule",
         "SPLEase" : "Advanced",
         "description" : "Multiple Primary Functions Detected",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "mitre_notes" : "Unclear",
         "dashboard" : "ES_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "highlight" : "No",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Network Communication",
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic"
      },
      "many_usb_file_copies" : {
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1052",
         "description" : "<p>Build a baseline of how many file copies each user does to USB media, and detect when a user copies an uncharacteristically large number of files.</p>",
         "howToImplement" : "<p>This detection relies on visibility for files copied to USB. There are two frequent paths to building out that visibility. The first (and most common) is commercial DLP or EDR software that tracks these activities. The second, and cheaper, is that there is a little-known group policy option that instructs Windows itself to log these activities in the Windows Security Event Log. DV Provide This Link</p>",
         "operationalize" : "<p>When this alert fires, the immediate questions should be: what data was copied, and was it sensitive. As SOC staff rarely have very deep understanding of the sensitivity of the actual data (if you have data categorization fully implemented in your organization, kudos! You are the only organization in the world), it's usually most prudent to look at whether this user is in a position to have access to sensitive data. There are a few approaches to this process: guessing from titles / departments (e.g., research scientist versus customer service representative), pulling a list of privileged users (<a href=\"/app/Splunk_Security_Essentials/showcase_simple_search?ml_toolkit.dataset=Pull%20List%20of%20Privileged%20Users%20-%20Demo\" target=\"_blank\">link</a>), or others. Very mature organizations will also track authorized USB device (either via encryption or other means), where data copy to unauthorized / unencrypted devices carries different consequences than to devices that are a part of standard operating procedures. Finally, it's often realistic to make some determination of risk based on the file names copied, though it's important to not be overly reliant on that indication (if I were to exfiltrate data, I would likely create a zip file called expense_report_receipts.zip or something mundane).</p><p>Ultimately, with many behavioral detections, you probably don't want to evaluate this alert in a vacuum, as you would end up with an excessive number of false positives. Sure, alert directly if this alert occurs for users who have access to sensitive data, but generally speaking you should combine this alert with other suspicious indications such as HR issues, recent (or future) separation, etc.</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized data collection from an actual customer environment.</p>",
         "category" : "Insider Threat",
         "released" : "2.2.0",
         "mitre" : "Exfiltration",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely the opportunity for lots of noise.</p>",
         "domain" : "Endpoint",
         "relevance" : "<p>Data exfiltration is top of mind for most security organizations. Copying data to USB is a top means for exfiltrating large and small volumes of data, so detecting that type of activity is key.</p>",
         "name" : "Many USB File Copies for User",
         "includeSSE" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0010",
         "data_source_categories" : "DS016DataLossPrevention-ET01Violation|DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Many USB File Copies for User - Demo"
            },
            {
               "name" : "Many USB File Copies for User - Live",
               "label" : "Live Data"
            }
         ],
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat",
         "datasource" : "DLP|Endpoint Detection and Response",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/many_usb_file_copies.png",
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Many USB File Copies for User - Demo",
         "alertvolume" : "High"
      },
      "personally_identifiable_information_detected" : {
         "description" : "Detects personally identifiable information (PII) in log files. Some software can inadvertently provide sensitive information in log files, resulting in potential exposure to those reviewing the log files.",
         "SPLEase" : "Advanced",
         "mitre_technique" : "",
         "search_name" : "Audit - Personally Identifiable Information Detection - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "gdprtext" : "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
         "includeSSE" : "Yes",
         "name" : "Personally Identifiable Information Detected",
         "mitre" : "",
         "domain" : "Audit",
         "category" : "Compliance|Insider Threat|Data Exfiltration|GDPR",
         "released" : "2.0.0",
         "help" : "Help not needed -- ES Use Case",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Compliance|Insider Threat",
         "data_source_categories" : "VendorSpecific-AnySplunk",
         "mitre_tactic" : "",
         "journey" : "Stage_1",
         "app" : "Splunk_App_for_Enterprise_Security",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : "Not an attacker technique.  More for compliance."
      },
      "detection_deletion_network_acl" : {
         "help" : "The search looks for CloudTrail events to detect whether any network ACLs have been deleted and gives you values of error messages and error codes (if any), user details, user source IP, the user who initiated this request, and the name of the event.",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "domain" : "Network",
         "mitre" : "Persistence",
         "includeSSE" : "Yes",
         "name" : "AWS Network Access Control List Deleted",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "search_name" : "ESCU - AWS Network Access Control List Deleted - Rule",
         "mitre_technique" : "",
         "description" : "Enforcing network-access controls is one of the defensive mechanisms used by cloud administrators to restrict access to a cloud instance. After the attacker has gained control of the AWS console by compromising an admin account, they can delete a network ACL and gain access to the instance from anywhere. This search will query the CloudTrail logs to detect users deleting network ACLs.",
         "mitre_notes" : "MITRE ATT&CK enterprise does not have good cataloging of cloud based activity.",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS Network ACL Activity",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0003",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update"
      },
      "UC0024" : {
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Email|DNS|Web Proxy|Network Communication",
         "usecase" : "Advanced Threat Detection",
         "icon" : "PS_Use_Case.png",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "The endpoint has attempted (success or fail) to communicate with an external server identified on a threat list using any protocol. An attempted communication could indicate activity generated by malicious code. ",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "help" : "Help not needed -- PS Use Case",
         "name" : "Endpoint communicating with external service identified on a threat list.",
         "includeSSE" : "No",
         "domain" : "Network",
         "mitre" : ""
      },
      "high_number_of_hosts_not_updating_malware_signatures" : {
         "mitre" : "",
         "domain" : "Endpoint",
         "gdprtext" : "<h4>Problem</h4><p>Similar to Detection of Uncleaned Malware on Endpoint, malware may persist if somehow, an endpoint protection solution is not updating its malware signatures. If there are a high number of hosts not updating, then this could indicate a sign of more widespread infection or other compromised state that is resulting in malware signatures not updating.</p><h4>Impact</h4><p>Uncleaned malware puts digital systems at risk. For any environments/systems that are involved in processing personal data, this situation can be critical, and especially so in a GDPR context. Article 32 of the GDPR requires that organizations regularly test, assess and evaluate effectiveness of implemented technical and organizational security controls. In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58). If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). </p><h4>Resolution Path:</h4><p> Removing malware infections that antivirus and other legacy endpoint protection software cannot remove (whether due to file permissions or other configurations that prevents easy quarantine or cleaning) can be considered in many cases appropriate, and helps to demonstrate compliance.</p>",
         "name" : "High Number of Hosts Not Updating Malware Signatures",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- ES Use Case",
         "category" : "Operations|GDPR",
         "released" : "2.0.0",
         "SPLEase" : "Advanced",
         "mitre_technique" : "|T1089",
         "search_name" : "Endpoint - High Number of Hosts Not Updating Malware Signatures - Rule",
         "description" : "Alerts when a high number of hosts not updating malware signatures have been discovered.  These hosts should be evaluated to determine why they are not updating their malware signatures.",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "images" : [
            {
               "label" : "In ES, it is easy to see all of the AV versions running in your environment.",
               "name" : "Clients by Signature Version",
               "path" : "/static/app/Splunk_Security_Essentials/images/example_images/es_hosts_not_updating_signatures_1.png"
            },
            {
               "name" : "Example Search",
               "label" : "Here is another perspective on the same capability.",
               "path" : "/static/app/Splunk_Security_Essentials/images/example_images/es_hosts_not_updating_signatures_2.png"
            }
         ],
         "dashboard" : "ES_Use_Case",
         "similarUseCases" : [
            "UC0030",
            "Outdated_Malware_Definitions",
            ""
         ],
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "datasource" : "Anti-Virus",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "Yes",
         "app" : "Splunk_App_for_Enterprise_Security",
         "data_source_categories" : "DS004EndPointAntiMalware-ET02UpdatedSig",
         "mitre_tactic" : "|TA0005",
         "journey" : "Stage_2"
      },
      "detection_open_redirect_in_splunk_web" : {
         "data_source_categories" : "VendorSpecific-SplunkInternal",
         "mitre_tactic" : "|TA0002",
         "journey" : "Stage_1",
         "story" : "Splunk Enterprise Vulnerability",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Application Security",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Delivery",
         "description" : "This search allows you to look for evidence of exploitation for CVE-2016-4859, the Splunk Open Redirect Vulnerability.",
         "SPLEase" : "None",
         "search_name" : "ESCU - Open Redirect in Splunk Web - Rule",
         "mitre_technique" : "|T1203",
         "released" : "2.0.0",
         "category" : "Web Attack",
         "help" : "This search looks within Splunk's internal logs for evidence of CVE-2016-4859 open redirect exploitation attempts.",
         "includeSSE" : "Yes",
         "name" : "Open Redirect in Splunk Web",
         "mitre" : "Defense Evasion",
         "domain" : "Network"
      },
      "detection_netsh_launching_process" : {
         "name" : "Processes created by netsh",
         "includeSSE" : "Yes",
         "mitre" : "Execution|Persistence",
         "domain" : "Endpoint",
         "category" : "Abuse",
         "released" : "2.2.0",
         "help" : "This search looks for all processes with the parent process \"c:\\Windows\\System32\\netsh.exe\" and returns the process, the command line used to execute it, the host name, and the user context under which it ran.",
         "description" : "This search looks for processes launching netsh.exe to execute various commands via the netsh command-line utility. Netsh.exe is a command-line scripting utility that allows you to, either locally or remotely, display or modify the network configuration of a computer that is currently running. Netsh can be used as a persistence proxy technique to execute a helper .dll when netsh.exe is executed. In this search, we are looking for processes spawned by netsh.exe that are executing commands via the command line.",
         "search_name" : "ESCU - Processes created by netsh - Rule",
         "mitre_technique" : "T1059",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Other",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0002|TA0003",
         "journey" : "Stage_3",
         "story" : "Netsh Abuse",
         "app" : "Enterprise_Security_Content_Update"
      },
      "UC0111" : {
         "category" : "GDPR",
         "released" : "2.0.0",
         "operationalize" : "When this fires, you should reach out to the user involved to see if they're aware of why their account was used in two places. You should also see what actions were taken, particularly if one of the locations was unusual. If the user is not aware of the reason, it's important to also ask if the user is aware of sharing their credentials with anyone else. You can also see what other activities occurred from the same remote IP addresses.",
         "howToImplement" : "First, use your data mapping results to build a lookup that associates systems to their GDPR category. Then you just need a log source that provide external IP addresses. If you are using SFDC data, as we are in the live example, it will work easily. Otherwise, any data source that is compliant with the Splunk Common Information Model (so that it contains a src_ip field) should work pretty automatically.",
         "help" : "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Salesforce.com logs, during which someone logs in from opposite ends of the earth. Our live search looks for the same activity across the standard index and sourcetype of SFDC data. For this use case, you can use any kind of data source, including VPN logs and others.",
         "includeSSE" : "Yes",
         "name" : "Geographically Improbable Access Detected against Category",
         "gdprtext" : "<h4>Problem:</h4><p>When monitoring user activity, a key indicator to look for is anomalous authentication attempts (see method above, “Brute Force Access Behavior Detected”). These can point to evidence of stolen or exploited credentials. Concurrent authentication attempts from multiple IP addresses can indicate unauthorized sharing of credentials, or even stolen credentials; and improbable travel anomalies, such as logging in from two geographically distant locations at the same time, which can be an indicator of exploited or misused credentials. </p><h4>Impact:</h4><p>Detecting and proving that individuals within the organization are not sharing user accounts for accessing and processing personal data is an industry best practice and can be considered an effective security control, as required by Article 32. Demonstrating that credentials are not being misused or exploited will help to prove compliance for data privacy audits from authorities (Article 58) or counteract any compensation claims (Article 82). This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). </p><h4>Resolution Path:</h4><p>Ensure you have a GDPR-mandated audit trail with individual user accounts for each processor accessing personal data. Detect when the same account is logged into twice in a short period of time but from multiple locations far away from each other, to a GDPR-tagged system.</p>",
         "relevance" : "Detecting and proving that your organizations environment does not use shared user accounts for accessing and processing personal data is industry best practice and should be considered as a effective security control which is required by Article 32 and will help you to prove compliance for data privacy audits from authorities (Article 58) or counteract any compensation claims (Article 82).",
         "domain" : "Access",
         "knownFP" : "There are two big buckets for false positives. One is where the geoip is unreliable -- particularly outside of major economic areas (e.g., US, larger countries in Western Europe), the free MaxMind GeoIP that ships with Splunk Enterprise tends to be less accurate, causing some customers to add the paid version in their Splunk installations. The other big categories is where IPs are centralized, such as someone in the US using a Korean VPN service, or using a networking service that originates nation-wide traffic from the same set of IPs (for example, years ago all traffic from a major US cellular carrier originated from the same IP space that was geolocated to Ohio).",
         "mitre" : "Credential Access",
         "hasSearch" : "Yes",
         "searchKeywords" : "land speed superman landspeed",
         "description" : "To ensure you have a GDPR-mandated audit trail with individual accounts for each person, detect when the same account is logged into twice in a short period of time but from locations very far away, to a GDPR-tagged system.",
         "mitre_technique" : "|T1078",
         "SPLEase" : "Advanced",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Land Speed GDPR - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_land_speed.png",
         "alertvolume" : "Low",
         "journey" : "Stage_4",
         "examples" : [
            {
               "name" : "Land Speed GDPR - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Land Speed GDPR - Live",
               "label" : "Live Data"
            }
         ],
         "mitre_tactic" : "TA0001",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-sfdc-elf|VendorSpecific-aws-cloudtrail",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Authentication|Vendor-Specific Data",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Compliance"
      },
      "access_inscope_resources_unencrypted" : {
         "description" : "Unencrypted communications leaves you vulnerable to a data breach -- when users access PII data, ensure that all connections are encrypted.",
         "mitre_technique" : "",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "gdprtext" : "<h4>Impact:</h4><p>Access to critical resources should only be made over an encrypted connection. Especially in the context of a compliance mandate, encryption should be used for any channel to access in-scope resources. Detecting when this is not the case, where instead unencrypted connections are being used to access in-scope resources, can help determine potential misuse or unauthorized access, and potentially a deeper issue such as compromised host or network device.</p><p>Within a GDPR context, in-scope assets and applications will store and process personal data. Ensuring that only encrypted connections are being used to access those assets is an industry best practice and can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58). If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). Capability to demonstrate that best practice was adhered to – that is, that only encrypted connections were used for accessing personal data -- can help mitigate potential impact to the organization.</p>",
         "includeSSE" : "Yes",
         "domain" : "Network",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Firewall logs (onboarded in accordance with our Data Onboarding Guides), during which someone uses Workday to download data over an unencrypted connection. Our live search looks for the same behavior using the standardized sourcetypes for Palo Alto Networks or the Common Information Model, and you can look for any destination where you have sensitive data including your cloud providers, databases, and more.",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "usecase" : "Compliance",
         "data_source_categories" : "DS005WebProxyRequest-ET01RequestedWebAppAware",
         "mitre_tactic" : "",
         "journey" : "Stage_1",
         "app" : "Splunk_Security_Essentials",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Access to Inscope Resources Unencrypted GDPR - Demo",
         "mitre_notes" : "Cyber hygiene to keep data segregated",
         "similarUseCases" : [
            "access_inscope_resources"
         ],
         "SPLEase" : "Basic",
         "name" : "Access to In-Scope Unencrypted Resources",
         "mitre" : "",
         "knownFP" : "No known false positives at this time.",
         "released" : "2.1.0",
         "category" : "GDPR",
         "howToImplement" : "Implementation of this capability will vary from system to system. Tracking access via firewall connections is a popular approach, though you could also use application logs which would provide more granular access. Ensure that all data flows (e.g., backups, remote management, etc.) are all encrypted. Splunk recommends working with you auditor, and Splunk Professional Services for any complicated situations.",
         "operationalize" : "Understand why and how this application was accessed over an insecure connection. For in-house apps, this can be tracking down configuration settings. For SaaS apps, this usually understands analyzing your communication paths for a proxy that sends in cleartext (or potentially noting a major bug in a SaaS provider, which is unusual).",
         "datasource" : "Web Proxy",
         "icon" : "Core_Use_Case.png",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Access to Inscope Resources Unencrypted GDPR - Demo"
            },
            {
               "name" : "Access to Inscope Resources Unencrypted GDPR - Live",
               "label" : "Live Data"
            }
         ],
         "alertvolume" : "Low",
         "visualizations" : [
            {
               "panel" : "row1cell1",
               "type" : "viz",
               "vizParameters" : {
                  "charting.chart" : "pie",
                  "resizable" : true
               },
               "dashboard" : "General Windows and Linux Posture",
               "title" : "Percentage of Connections That Are Encrypted",
               "header" : "Broken",
               "search" : "| `Load_Sample_Log_Data(Sample Firewall Data)` | search app=workday* | eval encrypted=if(dest_port=443, \"Yes\", \"No\") | stats count by encrypted",
               "vizType" : "ChartElement"
            }
         ],
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/access_to_in_scope_unencrypted_resources.png"
      },
      "host_with_high_number_of_listening_ports" : {
         "includeSSE" : "Yes",
         "name" : "Host With High Number Of Listening ports",
         "mitre" : "",
         "domain" : "Endpoint",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise|Unauthorized Software|Lateral Movement",
         "help" : "Help not needed -- ES Use Case",
         "description" : "Alerts when host has a high number of listening services. This may be an indication that the device is running services that are not necessary (such as a default installation of a server) or is not running a firewall.",
         "SPLEase" : "Accelerated",
         "search_name" : "Endpoint - Host With Excessive Number Of Listening Ports - Rule",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "alertvolume" : "Other",
         "mitre_notes" : "Cyber Hygiene",
         "dashboard" : "ES_Use_Case",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "data_source_categories" : "DS009EndPointIntel-ET06ListeningPorts",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "app" : "Splunk_App_for_Enterprise_Security"
      },
      "aggregated_risk" : {
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1078|T1076|T1028",
         "SPLEase" : "Medium",
         "description" : "Detect low and slow activities and complex insider threat patterns by finding users with concentrations of risky activities.",
         "operationalize" : "See the response guidance for the underlying searches that generate the original events.",
         "help" : "This example leverages the Simple Search assistant. Our example dataset is a collection of events from the risk index of a demo environment for Splunk Enterprise Security. The risk index provides a way to track \"risky\" events that aren't necessarily significant enough to send to a SOC analyst (along with aggregating the overall volume of events for a given user). Our live search looks for the same behavior using the standard sourcetypes. See How to Implement if you do not use Enterprise Security.",
         "howToImplement" : "You can use almost anything to generate a list of risky events -- in fact that's the desired intent for most medium-or-higher alert volume searches in Splunk Security Essentials! Most customers who go down this path will use the Enterprise Security Risk Framework to aggregate these events, though you can also 'roll your own' risk framework with Summary Indexing.",
         "released" : "2.2.0",
         "category" : "Insider Threat|Account Sharing",
         "domain" : "Threat",
         "relevance" : "A constant dilemma in the SIEM space is handling events that are potentially risky but not so risky that you want to send it directly to the SOC. There are a variety of different methods for responding these, including the high powered capabilities of Splunk UBA (graph mining, machine learning, looking over all time? oh my!), but those just starting down this path will find success even with simpler technological approaches with the Splunk ES Risk Framework. Here we look at two methods -- the first is to alert on any users for whom the number of searches in a short period is above a threshold, or if searches from multiple security domains fire in a short period of time. The second is to leverage just the numerical risk scores defined in the Risk Framework to show users who have bursty recent risk scores or consistent long term risk. These will detect users who have a large volume of suspicious behavior even in scenarios where there's not enough immediate risk to generate an alert to the SOC, preventing a slow and low threat from bypassing your detections.",
         "knownFP" : "This search can inherently generate false positives because it opens the door to alerting on low confidence events. You will need to tune the underlying searches, or potentially filter for a certain risk score to manage false positives.",
         "mitre" : "",
         "name" : "Aggregate Risky Events",
         "includeSSE" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "Aggregated Risk by Domains - Demo",
               "label" : "Demo Data - By Count"
            },
            {
               "name" : "Aggregated Risk by Domains - Live",
               "label" : "Live Data - By Count"
            },
            {
               "name" : "Aggregated Risk by Score - Demo",
               "label" : "Demo Data - By Score"
            },
            {
               "label" : "Live Data - By Score",
               "name" : "Aggregated Risk by Score - Live"
            }
         ],
         "journey" : "Stage_4",
         "data_source_categories" : "DS013TicketManagement-ET02LowLevelEvents",
         "mitre_tactic" : "|TA0003|TA0004|TA0008",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat|Advanced Threat Detection",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Ticketing System",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aggregated_risk.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Aggregated Risk by Domains - Demo",
         "alertvolume" : "Medium"
      },
      "sser_detect_journal_clearing" : {
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Deleting USN Journal Log - Demo",
         "similarUseCases" : [
            "detection_fsutil_deleting_journals"
         ],
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/detect_journal_clearing.png",
         "alertvolume" : "Low",
         "mitre_tactic" : "TA0005",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Deleting USN Journal Log - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Deleting USN Journal Log - Live"
            }
         ],
         "journey" : "Stage_3",
         "app" : "Splunk_Security_Essentials",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "category" : "Endpoint Compromise",
         "released" : "1.1.0",
         "operationalize" : "When this search fires, you will want to start your incident response process for dealing with a ransomware infection. You should verify with the system owner if this was an action taken on their part. You will want to investigate the parent process of fsutil and its activities as well.",
         "help" : "This use case looks for the fsutil process clearing the update sequence number (USN) change journal.",
         "howToImplement" : "This use case requires Sysmon to be installed on the endpoints you wish to monitor and the Sysmon add-on installed on your forwarders and search heads.",
         "includeSSE" : "Yes",
         "name" : "Detect Journal Clearing",
         "mitre" : "Defense Evasion",
         "knownFP" : "None at the moment",
         "domain" : "Endpoint",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "<p>This use case looks for the fsutil process clearing the update sequence number (USN) change journal.</p><p><b>Alert Volume:</b> Low</p>",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1070"
      },
      "UC0071" : {
         "help" : "Help not needed -- PS Use Case",
         "category" : "Account Compromise",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Access",
         "includeSSE" : "No",
         "name" : "Fast IP Change Between Remote Authentications",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "For employers that allow remote external connectivity the detection of two or more distinct values of external source IP address for successful authentications to a remote access solution in a short period of time indicates a likely compromise of credentials.",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "datasource" : "Authentication",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No"
      },
      "UC0003" : {
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Server Operating Systems, and Application services often generate email to support general purpose, or application specific functions. Configuration management is often used to identify servers generating e-mails, as well as maintaining recipient lists.",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "category" : "Data Exfiltration|Lateral Movement|Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "includeSSE" : "No",
         "name" : "Server generating email outside of approved usage",
         "domain" : "Network",
         "mitre" : "",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Email",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "icon" : "PS_Use_Case.png",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other"
      },
      "UC0083" : {
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "mitre" : "",
         "domain" : "Network",
         "includeSSE" : "No",
         "name" : "New Rule allowing Traffic to or from Protected Network",
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Scanning|Network Attack",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Communication from a enclave network may indicate a misconfiguration that could weaken the security posture of the organization or actual/attempted compromise. ",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No"
      },
      "detection_attackers_scanning_for_vulnerable_jboss_servers" : {
         "help" : "This search returns the number of times a URL associated with this type of JexBoss probe is observed.",
         "category" : "Scanning",
         "released" : "2.0.0",
         "mitre" : "Discovery",
         "domain" : "Network",
         "includeSSE" : "Yes",
         "name" : "Detect attackers scanning for vulnerable JBoss servers",
         "searchKeywords" : "",
         "killchain" : "Reconnaissance",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "mitre_technique" : "T1082|T1190",
         "search_name" : "ESCU - Detect attackers scanning for vulnerable JBoss servers - Rule",
         "description" : "This search looks for specific GET or HEAD requests to web servers that are indicative of reconnaissance attempts to identify vulnerable JBoss servers. JexBoss is described as the exploit tool of choice for this malicious activity.",
         "mitre_notes" : "Test Notes by David!",
         "dashboard" : "ESCU_Use_Case",
         "relatedUseCases" : [
            "external_website_attack"
         ],
         "alertvolume" : "Medium",
         "narrative" : "...",
         "story" : "JBoss Vulnerability",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0007|TA0001",
         "data_source_categories" : "DS014WebServer-ET01Access",
         "journey" : "Stage_2",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Web Server",
         "highlight" : "No"
      },
      "showcase_new_service_creations" : {
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_3",
         "examples" : [
            {
               "name" : "New Service Creation - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "New Service Creation - Live"
            }
         ],
         "mitre_tactic" : "TA0003|TA0005|TA0004",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Service Creation - Demo",
         "alertvolume" : "High",
         "killchain" : "Exploitation|Installation|Command and Control",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1036|T1050",
         "SPLEase" : "Medium",
         "description" : "<p>New service creations are uncommon for most hosts. This search will look for both new executables and executables running from new paths launched by services.exe.</p><p><b>Alert Volume:</b> High</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688) filtered for service launches. We check the first time that's occurred per path, per host, and then alert if that was in the last day.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the event, executable, its associated path, the system, user and other pertinent information. Contact the owner of the systems. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials have been used by another party and additional investigation is warranted to determine if services.exe has spawned new executables on new paths.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "relevance" : "Although it is useful to know what paths are involved with services launched on an endpoint, unless the system is considered “locked down” such as a single-purpose system (POS, kiosk, etc) this will result in significant noise because new services are being created on endpoints all of the time. Therefore, this type of search is best applied with a whitelist so that only ‘unapproved’ service paths are reported.",
         "domain" : "Endpoint",
         "mitre" : "Persistence|Defense Evasion|Privilege Escalation",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>New Service Creations should be fairly rare for most systems, occurring only when new software is installed or there is a Windows upgrade. You may want to filter out tools that you know help desk staff often install (for example, the Wireshark libpcap service), and any other common tools in your environment, but ultimately the efficacy of this search depends on how much change there is in your particular environment, and may or may not be that reliable. In the worst case, you can use it as a background contextual item for notable events.</p> ",
         "includeSSE" : "Yes",
         "name" : "New Service Paths for Host"
      },
      "UC0108" : {
         "help" : "This example leverages the Simple Search assistant. Our example dataset is a collection of anonymized Windows Authentication logs, during which someone attempts a brute force against a series of usernames. Our live search looks for Windows Authentication activity across any index in the standard sourcetype.",
         "domain" : "Access",
         "includeSSE" : "Yes",
         "gdprtext" : "<h4>Problem:</h4><p>Attackers leverage brute-force authentication attempts to bypass weak cryptographic standards, or to exploit infrastructure or applications where password best practices are not consistently applied. </p><h4>Impact:</h4><p>Brute force access is a common attack vector. Under the GDPR, monitoring and demonstrating that security controls are effective is required by Article 32, therefore immediate awareness of any brute force attempts is critical to maintaining compliance posture. Demonstrating that any such attempts have not been successful will help to prove compliance for data privacy audits initiated by data privacy authorities (Article 58) and also help counteract compensation claims (Article 82).</p><h4>Resolution Path:</h4><p>Identify GDPR-relevant resources and systems and monitor for a large number of authentication failures within a short time period, on any of those resources or systems. It is important to adjust for the scenario where a single source (such as a web app) might centralize the authentication for a large number of users, to reduce false positives.</p>",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1110|T1078",
         "description" : "Monitor your security controls and prove your GDPR compliance by detecting brute force (or password guessing) attacks on GDPR-tagged systems.",
         "similarUseCases" : [
            "basic_brute_force",
            "brute_force_access_behavior_detected",
            "brute_force_access_behavior_detected_over_one_day",
            "excessive_failed_logins",
            "UC0099",
            "UC0109"
         ],
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Brute Force GDPR - Demo",
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_4",
         "mitre_tactic" : "TA0006|TA0004",
         "data_source_categories" : "DS003Authentication-ET02Failure|VendorSpecific-winsec",
         "usecase" : "Compliance",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "howToImplement" : "If you have followed the data onboarding guides in this app, this search will work immediately for you. You should generally specify the index where you are storing Windows Security logs (e.g., index=oswinsec), and if you use a mechanism other than the Splunk Universal Forwarder to onboard that data, you should verify the sourcetype and fields that are used. The rest is simple!",
         "operationalize" : "When this search fires, the immediate concern is that the brute force search was successful. See if it is coming from a host that typically logs in with that account to make sure it is not just coincidental, and then reset the password for any compromised accounts and look for any other places where that username was used.",
         "category" : "GDPR",
         "released" : "2.0.0",
         "relevance" : "Monitoring that your security controls are effective is required by Article 32 and will help you to prove compliance for data privacy audits from authorities (Article 58) or counteract any compensation claims (Article 82). ",
         "knownFP" : "The only known scenario where this search could generate false positives is if you have a single source (for example, a web app) that centralizes the authentication for many people. In that scenario, you might need to adjust thresholds for that source, or exclude it and build a separate similar search just using the logs from that host.",
         "mitre" : "Credential Access|Privilege Escalation",
         "name" : "Brute Force Access Behavior Detected - Against Category",
         "killchain" : "",
         "SPLEase" : "Medium",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_brute_force.png",
         "alertvolume" : "Low",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Brute Force GDPR - Demo"
            },
            {
               "name" : "Brute Force GDPR - Live",
               "label" : "Live Data"
            }
         ],
         "icon" : "Core_Use_Case.png",
         "datasource" : "Authentication|Vendor-Specific Data"
      },
      "phone_call_flight_risk" : {
         "SPLEase" : "Medium",
         "mitre_technique" : "",
         "description" : "<p>Detect your employees who may be considering going to competitors (hopefully not with your data!) by looking for outbound phone calls to their phone ranges.</p>",
         "searchKeywords" : "",
         "killchain" : "",
         "hasSearch" : "Yes",
         "knownFP" : "<p></p>",
         "mitre" : "",
         "domain" : "Audit",
         "relevance" : "<p>For some organizations, particularly those that are highly competitive or highly regulated, phone calls to competitors are a potential source of concern. While most employees would not use a tracked company phone if they were really going to reach out to a competitor with malicious intent (or to get a new job), but many times people make very simple mistakes.</p>",
         "includeSSE" : "Yes",
         "name" : "Competitor Phone Call",
         "howToImplement" : "<p>There are a few components to implementing this detection -- handling your CDR logs correctly, and then filtering for just your competitors phone numbers.</p>",
         "operationalize" : "<p>Response to this particular type of detection is highly dependent to the organization. For some orgs, this is a potential capital offense that must be immediately investigated to protect against anti-trust concerns (or other issues). For other organizations, it's only really a concern if there are other sorts of events that an employee has seen (maybe this is the straw that breaks the camel's back, so to speak).</p>",
         "help" : "<p>This example leverages the first time seen search assistant. Our dataset is an anonymized collection of phone records, that we will filter for just the phone ranges that belong to our competitors.</p>",
         "released" : "2.2.0",
         "category" : "Insider Threat",
         "usecase" : "Insider Threat",
         "icon" : "Core_Use_Case.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Other",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "examples" : [
            {
               "name" : " - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : " - Live",
               "label" : "Live Data"
            },
            {
               "name" : " - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "alertvolume" : "Medium",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/phone_call_flight_risk.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset= - Demo"
      },
      "UC0041" : {
         "help" : "Help not needed -- PS Use Case",
         "category" : "Unauthorized Software|Compliance",
         "released" : "2.0.0",
         "domain" : "Network",
         "mitre" : "",
         "includeSSE" : "No",
         "name" : "SSH v1 detected",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Authentication using insecure protocol SSHv1 detected. The legacy SSH protocol is inherently insecure indication of accepted SSHv1 sessions indicate a mis-configured system. Attempted and denied sessions indicate system probing or scanning.",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "usecase" : "Security Monitoring|Compliance",
         "icon" : "PS_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Authentication|Network Communication"
      },
      "detection_dyn_dns_web_traffic" : {
         "hasSearch" : "No",
         "killchain" : "Command and Control|Actions on Objective",
         "description" : "This search looks for web connections to dynamic DNS providers.",
         "search_name" : "ESCU - Detect web traffic to dynamic domain providers - Rule",
         "mitre_technique" : "T1102|T1041",
         "category" : "Malware|",
         "released" : "2.2.0",
         "help" : "This search looks for hosts in your environment that may be communicating with a dynamic DNS provider. It checks each URL an endpoint is connecting to against a list of dynamic DNS providers. It returns the source and destination IP address of the web request, the URL requested, and the first time the event occurred.",
         "name" : "Detect web traffic to dynamic domain providers",
         "includeSSE" : "Yes",
         "domain" : "Network",
         "incluseSSE" : "No",
         "mitre" : "Command and Control|Defense Evasion",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0011|TA0005",
         "data_source_categories" : "DS005WebProxyRequest-ET01Requested",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Dynamic DNS",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Web Proxy",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low"
      },
      "UC0096" : {
         "description" : "Hosts with multiple indicators are likely infected with malware or successfully compromised. ",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "name" : "Network Intrusion Event Detected on Malware Infected Host",
         "includeSSE" : "No",
         "mitre" : "",
         "domain" : "Network",
         "released" : "2.0.0",
         "category" : "Network Attack|Endpoint Compromise",
         "help" : "Help not needed -- PS Use Case",
         "datasource" : "Anti-Virus|IDS or IPS|Host-based IDS",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "mitre_tactic" : "",
         "journey" : "Stage_2",
         "app" : "Splunk_Professional_Services",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case"
      },
      "outbound_emails_from_scanners" : {
         "howToImplement" : "<p>This search leverages a lookup to keep a behavioral baseline to track how often a host has sent out documents externally in the past, and to track what percentage of emails have attachments. We combine that baseline with the most recent data to alert on devices that are now sending out large volumes of external emails. To implement this search, you need only have email data ingested, with valid attachments.</p>",
         "operationalize" : "<p>Troubleshooting this alert can be very difficult because it's often difficult to know what documents are sent out, and who actually sent them. The process of responding will vary greatly based on factors, but at a high level you should consider attempting to see what documents are actually sent to determine whether they're sensitive or not, and also to see if they provide any indication of who is sending them (e.g., \"Report Generated by John Smith\"). If they are sensitive and there's no indication of who sent them, then look for users printing to that device around the same time, or consult physical security. It's often easiest to just prevent these devices from sending to external destinations to close the gap moving forward.</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of email logs. For this analysis, we are working to track emails from scanners.</p>",
         "released" : "2.2.0",
         "category" : "Insider Threat",
         "knownFP" : "<p>This search has a behavioral component, which means it may catch types of devices that aren't explicitly scanners (or other multi-function devices).</p>",
         "mitre" : "",
         "relevance" : "<p>Particularly in organizations where users don't need to authenticate to a Multi-Function Device (or any scanner), an easy way to send sensitive data outbound without leaving any traces can be to configure a scanner to send a document out to a personal email address. There's no telltale filename that admins can search, oftentimes there are no strings that a DLP can search (without using OCR), and it's not tied to your account. While these alerts can be difficult to track, detecting one of these devices that suddenly starts sending large volumes of sensitive data outbound can be cause for investigation.</p>",
         "domain" : "Network",
         "includeSSE" : "Yes",
         "name" : "Outbound Emails from Scanners",
         "searchKeywords" : "",
         "killchain" : "",
         "hasSearch" : "Yes",
         "SPLEase" : "Hard",
         "mitre_technique" : "",
         "description" : "<p>Detect scanners (or systems that look like scanners) that send data to external systems instead of to your internal users.</p>",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/outbound_emails_from_scanners.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset= - Demo",
         "alertvolume" : "Low",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : " - Demo"
            },
            {
               "name" : " - Live",
               "label" : "Live Data"
            },
            {
               "name" : " - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat",
         "datasource" : "Email",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No"
      },
      "splunk_access_provisioning" : {
         "knownFP" : "The only known scenario where this search could generate false positives is if you have a single source (for example, a web app) that centralizes the authentication for many people. In that scenario, you might need to adjust thresholds for that source, or exclude it and build a separate similar search just using the logs from that host.",
         "mitre" : "Privilege Escalation|Credential Access",
         "name" : "User Has Access to In-Scope Splunk Indexes They Should Not",
         "operationalize" : "When this search fires, the immediate concern is that the brute force attack was successful. See if it is coming from a host that typically logs in with that account to make sure it is not just coincidental, and then reset the password for any compromised accounts and look for any other places where that username was used.",
         "howToImplement" : "First, use the results of the data mapping exercise from your data privacy officer to build a lookup that associates systems to a GDPR category. Then do the same for users. Then the search should work smoothly. Importantly though, this information is held on the search head, so if you have multiple search heads in your environment you will need to run this search on every one of them (only one cluster member from a search head cluster must be used).",
         "released" : "2.0.0",
         "category" : "GDPR|IAM Analytics|Operations",
         "SPLEase" : "Basic",
         "killchain" : "Actions on Objective",
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_splunk_indexes.png",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Vendor-Specific Data",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Splunk Role Check GDPR - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Splunk Role Check GDPR - Live"
            }
         ],
         "domain" : "Access",
         "gdprtext" : "<h4>Impact</h4><p>Per Article 6, data can only be accessed and used for the legitimate reason it needed to be collected and lawfully processed. This lawful processing requires meeting specific criteria, such as the data subject has consented to processing, or processing is necessary for the performance of a contract with the data subject, or for compliance and legal obligations, or for protecting the vital interests of individuals, or for public interest reasons or the legitimate interests by the controller or a third party. Machine data that is stored within a central logging tool can include personal data -- in the case of Splunk, as stored within indexes or as the result of functions performed within Splunk such as enrichment or correlations across data sources. Therefore it is critical to be aware of when a user has access to in-scope Splunk indexes when they should not, to maintain compliance and / or to document and report to authorities as required.</p>",
         "includeSSE" : "Yes",
         "help" : "This example leverages the Simple Search assistant. Our example dataset is the output of very long and complicated macro (see the live search). ",
         "mitre_technique" : "",
         "description" : "Alerts the first time a user gains rights to search an index that they're not supposed to according to the output of a GDPR data source and GDPR user mapping exercise.",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Splunk Role Check GDPR - Demo",
         "mitre_notes" : "Incorrect privilege assignment, not an attacker technique",
         "gdpr" : "32|58",
         "usecase" : "Insider Threat|Compliance",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "",
         "data_source_categories" : "VendorSpecific-SplunkInternal",
         "journey" : "Stage_4"
      },
      "vulnerability_scanner_detected_by_events" : {
         "similarUseCases" : [
            "Basic_Scanning",
            "showcase_network_dc_dest",
            "vulnerability_scanner_detected_by_targets"
         ],
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0007",
         "data_source_categories" : "DS012NetworkIntrusionDetection-ET01SigDetection",
         "app" : "Splunk_App_for_Enterprise_Security",
         "highlight" : "Yes",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "IDS or IPS",
         "usecase" : "Security Monitoring|Compliance",
         "icon" : "ES_Use_Case.png",
         "released" : "2.0.0",
         "category" : "Scanning",
         "help" : "Help not needed -- ES Use Case",
         "includeSSE" : "Yes",
         "name" : "Vulnerability Scanner Detected (by events)",
         "domain" : "Network",
         "mitre" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "Detects a potential vulnerability scanner by detecting devices that have triggered a large number of unique events. Vulnerability scanners generally trigger a high number unique events when scanning a host since each vulnerability check tends to trigger a unique event.",
         "mitre_technique" : "|T1046|T1018",
         "search_name" : "Network - Vulnerability Scanner Detection (by event) - Rule",
         "SPLEase" : "Medium"
      },
      "badge_reader_swipe_while_VPNd_in" : {
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/badge_reader_swipe_while_VPNd_in.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Badge Reader and VPN - Demo",
         "alertvolume" : "Low",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "Badge Reader and VPN - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Badge Reader and VPN - Live"
            },
            {
               "label" : "Accelerated Data",
               "name" : "Badge Reader and VPN - Accelerated"
            }
         ],
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat|Compliance",
         "highlight" : "Yes",
         "datasource" : "VPN|Physical Security",
         "displayapp" : "Splunk Security Essentials",
         "howToImplement" : "<p>This search is relatively tricky to implement primarily because of the difficulty of ingesting badge reader logs (not to mention getting the correct locations of those badge readers). If you're pulling badge reader logs into Splunk, most organizations will end up with a CSV/excel file with the physical location for each badge reader, though some badge reader systems will blessedly track that in their logs. Once you have this file, you can configure the lookup in Splunk so that you will know the latitude and longitude for each badge swipe.</p><p>Once you have that data in place, the rest is typically easy. Most Splunk customers already have their VPN logs ingested and compliant with the common information model, which grants us the src_ip field. The iplocation search command will do the GeoIP and then we just have to calculate the distance. There are a few options for calculating distance, but for most purposes using the slightly less accurate calculation that we show here is generally sufficient.</p>",
         "operationalize" : "<p>When this alert fires, the pot</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of VPN and Badge Reader Logs. For this analysis, we are looking for times when a user VPNs in, doing a GeoIP to determine the source location. We then pull the recorded location of the badge reader swipe, and do a distance check to see how far apart those locations are.</p>",
         "released" : "2.2.0",
         "category" : "Insider Threat|Account Sharing",
         "domain" : "Access",
         "relevance" : "<p>When an account is logging in from a distant location via the VPN while their badge is being physically used in the office, that can indicate account sharing or account compromise. Account sharing would occur if a user gives their username / password with another user. This frequently occurs with executives and their assistants, but can occur in all manner of scenarios (and would show up when one of the employees travels, logging in or swiping their badge in a distant location). Account compromise will manifest similarly, but with the assumption that the remote user doesn't legitimately have access to the credentials (or badge).</p>",
         "knownFP" : "<p>There are two big buckets for false positives. One is where the geoip is unreliable -- particularly outside of major economic areas (e.g., US, larger countries in Western Europe), the free MaxMind GeoIP that ships with Splunk Enterprise tends to be less accurate, causing some customers to add the paid version in their Splunk installations. The other big categories is where IPs are centralized, such as someone in the US using a Korean VPN service, or using a networking service that originates nation-wide traffic from the same set of IPs (for example, years ago all traffic from a major US cellular carrier originated from the same IP space that was geolocated to Ohio).</p>",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "Badge Swipe While Using VPN",
         "killchain" : "",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "",
         "SPLEase" : "Medium",
         "description" : "<p>Detect user accounts who are logging in remotely while their assigned badge is physically in the office, indicating account sharing or account compromise.</p>"
      },
      "flight_risk_email" : {
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Email",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat",
         "journey" : "Stage_4",
         "examples" : [
            {
               "name" : "Flight Risk Emails - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Flight Risk Emails - Live",
               "label" : "Live Data"
            }
         ],
         "data_source_categories" : "DS001MAIL-ET03Send",
         "mitre_tactic" : "",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Medium",
         "mitre_notes" : "Possible insider threat, data theft candidate, not an external attacker.",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Flight Risk Emails - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/flight_risk_email.png",
         "description" : "<p>This search implements several heuristics to look for indications that a user is a flight risk. While most savvy employees will use a personal email address when emailing competitors, everyone in Security has some story of employees who don't, as it will happen. Detect when it does.</p>",
         "mitre_technique" : "",
         "SPLEase" : "Medium",
         "hasSearch" : "Yes",
         "killchain" : "",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Flight Risk Emailing",
         "domain" : "Network",
         "relevance" : "<p>Detecting users who are about to leave, before they actually give notice, can provide you the opportunity to potentially fix the situation for an unhappy employee, but also can help you prevent the exfiltration of sensitive data (which usually happens before an employee actually gives notice). Look for the indications that an employee may be leaving, by checking email logs.</p>",
         "mitre" : "Exfiltration",
         "knownFP" : "<p>There is a variety of different rules being implemented here with varying levels of confidence. See <i>How to Respond</i> for more details.</p>",
         "released" : "2.2.0",
         "category" : "Insider Threat",
         "operationalize" : "<p>There are several checks being run in this search. Most of these will require some tuning, and are often best to combine with another correlation searches that look for anomalous activities (e.g., data exfiltration). <ul><li><b>Emailing Competitors</b>: while there can be legitimate reasons to email competitors, there are several concerns as well. We don't have concrete guidelines for tuning this search, and consider it beta and high false positive.</li><li><b>Email to careers@ / jobs@ / recruiting@</b>: There are a few common email aliases used for job sites. If a user is emailing multiple recruiting aliases, alert on that. Low false positives.</li><li><b>Outbound Attachments Mentioning Resume</b>: Look for someone emailing out a resume. Medium false positives.</li><li><b>Outbound Attachments Mentioning Resume and Name</b>: Look for someone emailing out a resume that has their name in it. Low false positives.</li></ul></p><p>You should likely not look at the results of this search directly, but correlate it with other risky events via the Risk Framework in ES or the Threat Models in UBA.</p>",
         "howToImplement" : "<p>This search leverages email logs, with attachment data. You can pull this data in from your email system, or from Splunk Stream. See <i>How to Respond</i> for more details.</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of email logs.</p>"
      },
      "AWS_New_API_Call_Per_User" : {
         "alertvolume" : "High",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_api_per_user.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=AWS New API Call Per User - Demo",
         "relatedUseCases" : [
            "AWS_Cloud_Provisioning_Activity_from_Unusual_Country",
            "AWS_Instance_Created_by_Unusual_User",
            "AWS_Unusual_Amount_of_Modifications_to_ACLs"
         ],
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0002|TA0006|TA0009|TA0010|TA0015",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "AWS New API Call Per User - Demo"
            },
            {
               "name" : "AWS New API Call Per User - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>Specifically for AWS, they have many APIs (and create new ones regularly!), so it's generally best to tune over time for which APIs you actually want to be emailed about, leave the rest for context, or to aggregate risk.</p>",
         "mitre" : "Execution|Credential Access|Collection|Exfiltration",
         "domain" : "Access",
         "relevance" : "The risk that this detection intends to reduce is the compromise of an AWS environment, where all of a sudden an account starts accessing AWS APIs that they haven't normally before (such as creating keys, creating AMIs, changing ACLs, etc.). Assuming that the user has not changed roles, and that new orchestration tools are not being used, this would suggest that credentials have been created or compromised, and are in control of an adversary. This could result in potential data leakage, data deletion, or cost run-up.",
         "includeSSE" : "Yes",
         "name" : "AWS New API Call Per User",
         "howToImplement" : "Assuming you use the ubiqutious AWS Add-on for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
         "operationalize" : "When this alert fires, you should look at what APIs were called. We've excluded some of the basic inaction ones (such as DescribeInstances), but the severity of the event will vary based on the severity of the API calls. The natural next step is to call the user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred.",
         "help" : "This example leverages the Detect New Values search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, as detailed in How to Implement.",
         "category" : "Account Compromise|IAM Analytics|Insider Threat|SaaS",
         "released" : "2.0.0",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1260",
         "description" : "Looks for users that are using AWS APIs that they've never used before.",
         "searchKeywords" : "cloudtrail",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes"
      },
      "detection_protocol_mismatch" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "journey" : "Stage_2",
         "data_source_categories" : "DS010NetworkCommunication-ET01TrafficAppAware",
         "mitre_tactic" : "TA0011|TA0010",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Command and Control",
         "highlight" : "No",
         "datasource" : "Network Communication",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "released" : "2.0.0",
         "category" : "Operations",
         "help" : "This search looks for instances in which the protocol observed is not consistent with the port and transport protocol typically used for that protocol. For example, looking for network traffic other than HTTP running over TCP port 80. Such behavior could indicate a misconfiguration or a custom command and control protocol that has been designed to look like ordinary web traffic. The search will also identify if HTTP traffic is observed running on unexpected ports. This can be common in many environments.",
         "includeSSE" : "Yes",
         "name" : "Protocol or Port Mismatch",
         "domain" : "Network",
         "mitre" : "Command and Control",
         "hasSearch" : "No",
         "killchain" : "Command and Control",
         "searchKeywords" : "",
         "description" : "This search looks for network traffic on common ports where a higher layer protocol does not match the port that is being used. For example, this search should identify cases where protocols other than HTTP are running on TCP port 80. This can be used by attackers to circumvent firewall restrictions, or as an attempt to hide malicious communications over ports and protocols that are typically allowed and not well inspected.",
         "search_name" : "ESCU - Protocol or Port Mismatch - Rule",
         "mitre_technique" : "T1043|T1048",
         "SPLEase" : "None"
      },
      "UC0082" : {
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "mitre" : "",
         "domain" : "Network",
         "name" : "Communication with enclave by default rule",
         "includeSSE" : "No",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Lateral Movement|Scanning|Network Attack",
         "released" : "2.0.0",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Communication from an enclave network may indicate a misconfiguration that could weaken the security posture of the organization or actual/attempted compromise. Communication filtered by the default rule implies no explicit permission for communication has been granted and should be reviewed. Consider ingress communication allowed by the default rule, and egress communication allowed or blocked.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No"
      },
      "sse_hostnotincmdb" : {
         "alertvolume" : "Medium",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Hosts Not in CMDB - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sse_hostnotincmdb.png",
         "highlight" : "No",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Security Essentials",
         "usecase" : "Security Monitoring|Compliance",
         "icon" : "Core_Use_Case.png",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Hosts Not in CMDB - Demo"
            },
            {
               "name" : "Hosts Not in CMDB - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0001",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "app" : "Splunk_Security_Essentials",
         "name" : "RFC1918 IP Not in CMDB",
         "includeSSE" : "Yes",
         "domain" : "Network",
         "relevance" : "<p>In many organizations, chaos reigns free, but if you have controlled the chaos they you may want to know when your rules are being broken. The key concern here for most organizations is Shadow IT where a user plugs in a switch or wireless AP for their own convenience, to the detriment of your security controls, though it may also catch a bold physical security penetration tester (or a reckless digital intruder). When a new Source IP shows up that isn't a part of any address ranges or known hosts in the CMDB, this can indicate trouble.</p>",
         "mitre" : "",
         "knownFP" : "Because of invariably incomplete CMDB data and the challenges with DHCP scopes, this search will likely produce a large volume of noise. It's use is only recommended in very clean environments, such as companies that believe they've conquered the CMDB challenge or in particular enclaves where shadow IT is a risk and there is relatively minimal change.",
         "category" : "Best Practices|Compliance|Shadow IT",
         "released" : "2.2.0",
         "operationalize" : "<p>When this alert fires, leverage DHCP to determine what device is plugged in, to see if there is any record of it. Work with the network team to track down the location of the device and determine whether it is allowable or not. If you have a large volume of these alerts, consider automating this process with a SOAR product like Splunk Phantom.</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of network traffic logs. For this analysis, we are aggregating by source_ip, and then looking it up in an asset database to determine the owner of each asset. When we don't have a match in the asset database, that is cause for an alert..</p>",
         "howToImplement" : "<p>Accurate CMDB information is a life-long effort, and is the hard part of this query. Given the goal of this search, it probably makes the most sense to implement it in phases, starting with a production data center and then moving elsewhere. A primary goal here is to detect shadow IT, so it's often useful to augment this detection with DHCP data (either as a lookup, combined | stats, or even as a different dashboard panel or adaptive response action) to weed out authorized devices being plugged into unusual locations.</p>",
         "description" : "<p>Find internal addresses that aren't in your Asset database.</p>",
         "mitre_technique" : "|T1200",
         "SPLEase" : "Basic",
         "hasSearch" : "Yes",
         "killchain" : "",
         "searchKeywords" : ""
      },
      "showcase_lookalike_filenames" : {
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Processes With Lookalike Filenames - Demo",
         "alertvolume" : "Very Low",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "mitre_tactic" : "TA0005|TA0002",
         "examples" : [
            {
               "name" : "Processes With Lookalike Filenames - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Processes With Lookalike Filenames - Live"
            }
         ],
         "journey" : "Stage_4",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launches (EventID 4688), with one injected to use scvhost.exe instead of svchost.exe. The search then leverages the URL Toolbox app from apps.splunk.com to run a levenshtein distance calculation against multiple different common Windows processes. It filters by making sure that there's no exact matches (distance=0), and then filters for where any of the matches was 1 or 2 away from the normal (e.g., svdhost.exe or scvhost.exe). There are a few other techniques used in the search to provide more context to the analyst -- the most interesting of those is the use of curly braces \"{score}\" -- that will insert the value of the score field (e.g., \"2\") into the variable name (so, score2). The rest of the more complicated aspects of the search are just formatting -- in particular, the use of foreach to pull out all suspicious filenames from the dataset.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the event, filename and path of the suspect file, the system it executed on and the user and other pertinent information. Contact the user and owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "howToImplement" : "Implementing this search is similar to any of the other searches that require EDR data. In order to use it, we need to get process launch events. For the demo and live version of this search we use Microsoft Sysmon logs, but you could apply it to any other data source that shows you launched processes -- just adjust the file path field (Image) to match (it is not a CIM field).",
         "released" : "1.0.0",
         "category" : "Endpoint Compromise",
         "knownFP" : "<p>This search will find any launched executable with filenames similar to standard Windows processes, much like running dnstwist on a domain name. If there are valid processes with names similar to standard Windows processes, they would create false positives. One might imagine a system speed up service creating a process like svchaste.exe, which would have a difference of 2 and would trigger (one for the o->a, one for the added e).</p>",
         "mitre" : "Defense Evasion",
         "domain" : "Endpoint",
         "name" : "Processes with Lookalike (typo) Filenames",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Installation",
         "hasSearch" : "Yes",
         "SPLEase" : "Hard",
         "mitre_technique" : "|T1036|T1035",
         "description" : "<p>To evade analysts, attackers will create a service with a name similar to that of a standard Windows service. This search looks for small differences. Idea from David Bianco, formerly of Sqrrl (<a href=\"http://detect-respond.blogspot.com/2016/11/hunting-for-malware-critical-process.html\">link</a>).</p><p><b>Alert Volume:</b> Very Low</p>"
      },
      "UC0037" : {
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "datasource" : "IDS or IPS",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "mitre" : "",
         "domain" : "Network",
         "name" : "Network Intrusion - New Signatures",
         "includeSSE" : "No",
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Network Attack",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "IDS devices reporting an attack using a signature not previously encountered are more likely be successful as new signatures are prompted by newly know attacks in the wild.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No"
      },
      "building_departmental_peer_group" : {
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "",
         "description" : "<p>Build a departmental peer group that can be used by the detections in Splunk Security Essentials.</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "",
         "category" : "Insider Threat|Compliance",
         "released" : "2.2.0",
         "howToImplement" : "<p>There are multiple approaches for pulling Active Directory data:<ul><li>Using the Supporting Add-on for Active Directory (aka SA-ldapsearch) which provides the ldapsearch command -- recommended for on premises installations in organizations with fewer than 50,000 users (<a href=\"https://splunkbase.splunk.com/app/1151/\" target=\"_blank\">app link</a>, <a href=\"http://docs.splunk.com/Documentation/SA-LdapSearch/2.1.6/User/AbouttheSplunkSupportingAdd-onforActiveDirectory\" target=\"_blank\">docs link</a>).</li><li>Using data from AD Monitor, which is the Splunk Universal Forwarder's ability to monitor Active Directory for changes -- recommended for large organizations, and for Cloud environments (<a href=\"http://docs.splunk.com/Documentation/Splunk/7.0.2/Data/MonitorActiveDirectory\" target=\"_blank\">doc link</a>).</li><li>Using a Powershell script to query Active Directory for this data (<a href=\"https://gallery.technet.microsoft.com/scriptcenter/Powershell-script-to-5edcdaea\" target=\"_blank\">link</a>).</li></ul></p><p>Once the AD data is ingested, running through the search is straightforward you should be good to go.",
         "operationalize" : "<p>No alerts will be generated by this search.</p>",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is the output of an LDAP Search, which we are transforming into a departmental peer group that we can use in our other detections.</p>",
         "includeSSE" : "Yes",
         "name" : "Building a Departmental Peer Group",
         "mitre" : "",
         "knownFP" : "<p>Not Applicable</p>",
         "domain" : "Access",
         "relevance" : "<p>In order to do peer group analysis, you must first build out departmental peer groups. This search will convert a peer group into the format that the searches in this app expect.</p>",
         "data_source_categories" : "VendorSpecific-winsec-domaincontroller",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Build Departmental Peer Group - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Build Departmental Peer Group - Live"
            }
         ],
         "app" : "Splunk_Security_Essentials",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "usecase" : "Compliance|Insider Threat",
         "icon" : "Core_Use_Case.png",
         "mitre_notes" : "Not an attacker technique",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Build Departmental Peer Group - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/building_departmental_peer_group.png",
         "alertvolume" : "Very Low"
      },
      "download_from_internal_server" : {
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Insider Threat|Security Monitoring",
         "highlight" : "Yes",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Network Communication",
         "app" : "Splunk_User_Behavior_Analytics",
         "journey" : "Stage_3",
         "mitre_tactic" : "|TA0009",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "alertvolume" : "Other",
         "mitre_notes" : "",
         "dashboard" : "UBA_Use_Case",
         "mitre_technique" : "|T1039|T1213",
         "description" : "Detects outliers in the timeseries of downloaded bytes from possible internal servers per user.",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Other",
         "mitre" : "",
         "name" : "Download from Internal Server",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- UBA Use Case",
         "category" : "Insider Threat|Account Compromise",
         "released" : "2.0.0"
      },
      "shortlived_account_detected" : {
         "name" : "Short-lived Account Detected",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Access",
         "released" : "2.0.0",
         "category" : "Account Compromise",
         "help" : "Help not needed -- ES Use Case",
         "description" : "Detects when a account or credential is created and then removed a short time later. This may be an indication of malicious activities.",
         "SPLEase" : "Accelerated",
         "mitre_technique" : "|T1136|T1078",
         "search_name" : "Access - Short-lived Account Detected - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Audit Trail",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "data_source_categories" : "DS006UserActivity-ET03Create|DS006UserActivity-ET05Delete",
         "mitre_tactic" : "|TA0003|TA0004",
         "journey" : "Stage_2",
         "app" : "Splunk_App_for_Enterprise_Security"
      },
      "showcase_first_git_peer" : {
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0009",
         "data_source_categories" : "DS014WebServer-ET03SourceCode",
         "journey" : "Stage_4",
         "examples" : [
            {
               "name" : "Accessing New Git Repositories With Peer - Demo",
               "label" : "Demo Data"
            }
         ],
         "usecase" : "Insider Threat",
         "icon" : "Core_Use_Case.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Web Server",
         "highlight" : "Yes",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=Accessing New Git Repositories With Peer - Demo",
         "alertvolume" : "Medium",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "SPLEase" : "Advanced",
         "mitre_technique" : "|T1213",
         "description" : "<p>Find users who accessed a git repository for the first time, where their peer group also hasn't accessed it before.</p><p><b>Alert Volume:</b> Medium</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is the Splunk-internal git source source checkout history for a couple of our Splunk UBA software developers, anonymized to Alice and Chuck. On the last day, I added in a few more developers who visit other repositories, but set their usernames to Chuck so that it looks like he started downloading from a bunch of repositories that he's never touched before. We also have a user Bob, who has checked out from a few other repositories in the past, and is on Chuck's team. Under the peer group, git_peer_group is selected, which includes that chuck and bob are on the same team. For this analysis, we are looking at the first time a username, or anyone in that user's peer group, has checked out from a repository names, and alerting if that was in the last day. </p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the user account accessing the specific repo. Contact the user and manager to determine if they are accessing the repo with authorization. If they did not access this repo, attempt to determine if the user credentials have been used by another party by stealing a user's credentials.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple, though the peer group makes things slightly more complicated.<ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>To configure the Peer Group:<ol><li>Start with a data source that gives you visibility into the peer group -- easiest is usually querying Active Directory via the <a href=\"https://splunkbase.splunk.com/app/1151/\">SA-ldapsearch add-on</a>, but you could get lists of users and their teams / departments / etc from any source you have.</li><li>Next you will need to convert that log source into a format that this lookup is expecting, which is as follows:<table class=\"table\" style=\"width: 300px\"><tr><td>user</td><td>peergroup (order not important)</td></tr><tr><td>john</td><td>john|sarah</td></tr><tr><td>sarah</td><td>john|sarah</td></tr><tr><td>mark</td><td>mark</td></tr></table>The easiest way to do this is with a search like <span class=\"spl\">| inputlookup LDAPSearch.csv | stats values(user) as user by department | eval peergroup=mvjoin(user, \"|\") | mvexpand user</span></li></ol></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "category" : "Data Exfiltration",
         "released" : "1.0.0",
         "mitre" : "Collection",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise (even though the peer groups help manage noise).</p><p> You should not review these alerts directly except for access to extremely sensitive repositories, but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
         "relevance" : "This is an insider threat use case that builds off of the \"Accessing New Git Repositories\" example. Your developers are often granted access to the Git (or other software life cycle repository) that they require, but why would they be gaining access to other repos that other members of their team (e.g. peer group) never access? This could be an alertable condition. In order to perform searches like this you must map your users into peer groups - we have done this via a simple Splunk lookup in the example, but this could be done via more automated fashion, and Splunk UBA contains its own methods of discovering peer groups for individual users.",
         "domain" : "Data",
         "name" : "First Time Accessing an Internal Git Repository Not Viewed by Peers",
         "includeSSE" : "Yes"
      },
      "showcase_new_local_admin_account" : {
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Compliance",
         "icon" : "Core_Use_Case.png",
         "mitre_tactic" : "TA0005|TA0003",
         "data_source_categories" : "VendorSpecific-winsec",
         "examples" : [
            {
               "name" : "New Local Admin - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "New Local Admin - Live"
            }
         ],
         "journey" : "Stage_1",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Medium",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=New Local Admin - Demo",
         "relatedUseCases" : [
            "sser_fake_windows_processes",
            "showcase_new_interactive_service_logon"
         ],
         "similarUseCases" : [
            "showcase_short_lived_accounts"
         ],
         "description" : "<p>Local admin accounts are used by legitimate technicians, but they're also used by attackers. This search looks for newly created accounts that are elevated to local admins.</p><p><b>Alert Volume:</b> Medium</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1078|T1136",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Command and Control",
         "name" : "New Local Admin Account",
         "includeSSE" : "Yes",
         "mitre" : "Defense Evasion|Persistence",
         "knownFP" : "<p>The only real source of false positives for this search would be for help desk admins who create local admin accounts. If this is common practice in your environment, you should filter out their admin account creation messages by excluding their usernames from the base search.</p><p>If your local admin group doesn't include the term \"administrators\" then it would potentially generate false negatives.</p>",
         "domain" : "Endpoint",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the creation, as well as the user accounts that created the account and the account name itself, the system that initiated the request and other pertinent information. Contact the owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials have been used by another party and additional investigation is warranted.</p>",
         "howToImplement" : "<p>First, verify that you have Windows Security Logs coming in, and that you have implemented account change auditing (see the <a href=\"/app/Splunk_Security_Essentials/data_source?datasource=Windows%20Security?technology=Windows%20Security%20Logs\">Windows Security data source documentation</a>). Once your logs are coming in, you should be able to search for <span class=\"spl\">source=\"WinEventLog:Security\" EventCode=4720 OR EventCode=4732</span> to see account creation or change events. Finally, make sure that your local admin group name is \"administrators\" so that we are looking for the right group membership changes.</p>",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows security logs for user creation and group modification. We then use the transaction command to group an account create, and an addition to the local administrators group, in a short period of time. Anything that matches, we will surface.</p>"
      },
      "detection_wmi_perm_event_subscription_sysmon" : {
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "story" : "Suspicious WMI Use",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0002|TA0003",
         "data_source_categories" : "VendorSpecific-winsec",
         "journey" : "Stage_1",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "mitre_technique" : "T1047|T1084",
         "description" : "This search looks for the creation of WMI permanent event subscriptions.",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "mitre" : "Execution|Persistence",
         "incluseSSE" : "No",
         "domain" : "Endpoint",
         "name" : "WMI Permanent Event Subscription - Sysmon",
         "includeSSE" : "Yes",
         "help" : "Attackers are increasingly abusing Windows Management Infrastructure (WMI) for stealth, persistence, lateral movement, or just to leverage its functionality. This search looks for the creation of a WMI event subscription by watching for Sysmon event ID 21.",
         "category" : "Adversary Tactics|",
         "released" : "2.2.0"
      },
      "multiple_authentication_failures" : {
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.2.0",
         "category" : "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
         "mitre" : "",
         "domain" : "Other",
         "name" : "Multiple Authentication Failures",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre_technique" : "|T1110",
         "description" : "Detects outliers in the timeseries of service or machine authentication failures per user.",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_User_Behavior_Analytics",
         "mitre_tactic" : "|TA0006",
         "data_source_categories" : "DS003Authentication-ET02Failure",
         "journey" : "Stage_4",
         "usecase" : "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance",
         "icon" : "UBA_Use_Case.png",
         "datasource" : "Authentication",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No"
      },
      "default_account_at_rest_detected" : {
         "mitre_notes" : "Cyber hygiene to clean up default accounts",
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_App_for_Enterprise_Security",
         "data_source_categories" : "DS015ConfigurationManagement-ET01General",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "datasource" : "Configuration Management",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "No",
         "help" : "Help not needed -- ES Use Case",
         "category" : "IAM Analytics",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Access",
         "name" : "Default Account At Rest Detected",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "SPLEase" : "Medium",
         "mitre_technique" : "",
         "search_name" : "Access - Default Accounts At Rest - Rule",
         "description" : "Discovers the presence of default accounts even if they are not being used. Default accounts should be disabled in order to prevent an attacker from using them to gain unauthorized access to remote hosts."
      },
      "external_alarm_activity" : {
         "alertvolume" : "Other",
         "mitre_notes" : "This is too generic to map to a specific technique.  The alarms could be from various systems",
         "dashboard" : "UBA_Use_Case",
         "highlight" : "No",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "DLP|IDS or IPS|Host-based IDS|Anti-Virus|Web Application Firewall",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Insider Threat",
         "icon" : "UBA_Use_Case.png",
         "journey" : "Stage_5",
         "mitre_tactic" : "",
         "data_source_categories" : "DS016DataLossPrevention-ET01Violation|DS012NetworkIntrusionDetection-ET01SigDetection|DS020HostIntrustionDetection-ET01SigDetected|DS004EndPointAntiMalware-ET01SigDetected|DS025IPAddressAssignment-ET01General",
         "app" : "Splunk_User_Behavior_Analytics",
         "name" : "External Alarm Activity",
         "includeSSE" : "Yes",
         "domain" : "Network|Endpoint|Threat",
         "mitre" : "",
         "released" : "2.2.0",
         "category" : "Endpoint Compromise|Network Attack",
         "help" : "Help not needed -- UBA Use Case",
         "description" : "Computes risk analytics for the external alarm of entities and raises anomalies for the most noteworthy external alarm activity.",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : ""
      },
      "UC0057" : {
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Operations|Compliance|Unauthorized Software",
         "domain" : "Audit",
         "mitre" : "",
         "name" : "Identify users of Cloud Services that may not be approved",
         "includeSSE" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Utilize email logs to identify users being welcomed to a cloud service on an identified risky list for the first time, notify the user to be aware the service is not approved and notify the users manager if known by identity. ",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "usecase" : "Security Monitoring|Compliance",
         "icon" : "PS_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Email",
         "displayapp" : "Splunk Professional Services"
      },
      "detection_common_ransomware_notes" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Low",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Ransomware",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "|TA0011",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "help" : "This search looks at file modifications in the Change Analysis data model. It checks modified file names against an included lookup file, which contains the names of note files left behind by ransomware (to inform the victim how they can pay the ransom and retrieve their files). The search returns a list of files with matching names.",
         "released" : "2.0.0",
         "category" : "Ransomware",
         "domain" : "Endpoint",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "Common Ransomware Notes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "|TA0011",
         "search_name" : "ESCU - Common Ransomware Notes - Rule",
         "SPLEase" : "None",
         "description" : "The search looks for files created with names matching those typically used in ransomware notes that tell the victim how to get their data back."
      },
      "malicious_ad_activity" : {
         "app" : "Splunk_User_Behavior_Analytics",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "|TA0003|TA0004|TA0001",
         "journey" : "Stage_4",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre_technique" : "|T1078",
         "description" : "Raises anomalies when the input data matches a set of predefined patterns in Microsoft Windows logs.",
         "help" : "Help not needed -- UBA Use Case",
         "category" : "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Other",
         "includeSSE" : "Yes",
         "name" : "Malicious AD Activity"
      },
      "AWS_Public_Bucket" : {
         "knownFP" : "There are two types of undesired alerts that can occur from this search. One is when someone intentionally creates a public bucket -- you may wish to whitelist marketing employees that do this on a regular basis, or create a policy for how to create a public bucket, so that you can exclude it. The other is when someone creates a bucket that is public momentarily, but then they switch it back to private (discussed more in How To Respond).",
         "mitre" : "",
         "domain" : "Access",
         "relevance" : "Open S3 Buckets are an extremely common way for breaches to occur these days. People host files for quick transfer but forget to take them down, or use S3 Buckets for backups of sensitive data but inadvertently mess up permissions. Newly created S3 buckets are monitored and data is quickly pulled. If you have a corporate AWS environment, you should prioritize analyzing any open S3 buckets. You may even wish to automate the remediation of them through AWS functions (<a target=\"_blank\" href=\"https://aws.amazon.com/blogs/security/how-to-detect-and-automatically-remediate-unintended-permissions-in-amazon-s3-object-acls-with-cloudwatch-events/\">link</a>).",
         "includeSSE" : "Yes",
         "name" : "Public S3 Bucket in AWS",
         "operationalize" : "When this alert fires, there are three questions that should be asked -- is it still public, are the files public, and what is in it. The first is easy to detect -- just search your logs for the bucket name and PutBucketACL, you will see any subsequent ACL changes. The second and third are trickier, and require that server access logging is turned on for the S3 bucket (not done by default, and pretty inconvenient, so don't bet on it). ",
         "help" : "This example leverages the Simple Search Assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, where someone creates a public bucket. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, as detailed in How to Implement.",
         "howToImplement" : "Assuming you use the ubiqutious AWS Add-on for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
         "category" : "Data Exfiltration|SaaS",
         "released" : "2.1.0",
         "SPLEase" : "Medium",
         "mitre_technique" : "",
         "description" : "Detects when new or existing S3 buckets are set to public.",
         "searchKeywords" : "cloudtrail",
         "hasSearch" : "Yes",
         "alertvolume" : "Very Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/public_s3_bucket_in_aws.png",
         "mitre_notes" : "Cyber hygiene to prevent data exposure",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=AWS Public Bucket - Demo",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring|Advanced Threat Detection",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "AWS Public Bucket - Demo"
            },
            {
               "name" : "AWS Public Bucket - Live",
               "label" : "Live Data"
            }
         ]
      },
      "detection_abnormally_high_instance_termination" : {
         "search_name" : "ESCU - Abnormally High AWS Instances Terminated by User - Rule",
         "mitre_technique" : "",
         "description" : "This search looks for CloudTrail events where an abnormally high number of instances were successfully terminated by a user in a 10-minute window",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Network",
         "mitre" : "Execution",
         "includeSSE" : "Yes",
         "name" : "Abnormally High AWS Instances Terminated by User",
         "help" : "In this search, we query CloudTrail logs to look for events where an instance is successfully terminated by a particular user. Since we want to detect a high number of instances terminated within a short period, we create event buckets for 10-minute windows. We then calculate the total number of instances terminated by a particular user, as well as the average- and standard-deviation values. Assign a <code>threshold_value</code> in the search. Try starting with 3 (but it will likely need to be tweaked for your environment). The <code>eval</code> function will set the outlier to 1 if the number of instances is greater than the average number of instances terminated, added to the multiplied value of threshold and standard deviation. We then filter out outliers with a value of 1 and show only those instance-termination events that happened within the previous 10 minutes.",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious AWS EC2 Activities",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case"
      },
      "detection_children_of_spoolsv" : {
         "mitre_technique" : "T1068",
         "description" : "This search looks for child processes of spoolsv.exe. This activity is associated with a POC privilege-escalation exploit associated with CVE-2018-8440. Spoolsv.exe is the process associated with the Print Spooler service in Windows and typically runs as SYSTEM.",
         "killchain" : "Exploitation",
         "hasSearch" : "No",
         "mitre" : "Privilege Escalation",
         "incluseSSE" : "No",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Child Processes of Spoolsv.exe",
         "help" : "This search looks for child processes of spoolsv.exe, which is associated with the Print Spooler service on Windows. Children of this process typically run under the SYSTEM context. This search should address the POC developed for the Windows local-privilege-escalation exploit announced in September of 2018. The associated vulnerability was assigned CVE-2018-8440. More information is available at https://doublepulsar.com/task-scheduler-alpc-exploit-high-level-analysis-ff08cda6ad4f.",
         "category" : "Adversary Tactics|",
         "released" : "2.2.0",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "story" : "Windows Privilege Escalation",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0004",
         "journey" : "Stage_3",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case"
      },
      "UC0090" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Detection of logon with the same account to a production and a non production environment. If an account (not user) has logged into more than one account, access management controls have failed and must be remediated.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "released" : "2.0.0",
         "category" : "Lateral Movement|Compliance|Account Compromise|Account Sharing",
         "help" : "Help not needed -- PS Use Case",
         "name" : "User account cross enclave access",
         "includeSSE" : "No",
         "mitre" : "",
         "domain" : "Access",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "app" : "Splunk_Professional_Services",
         "datasource" : "Authentication",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Compliance",
         "icon" : "PS_Use_Case.png",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other"
      },
      "showcase_spike_in_sfdc_exports" : {
         "description" : "<p>For many organizations, Salesforce.com contains the most critical information in their company. This use case tracks the number of records exported per day (and is based on a real set of data collection).</p><p><b>Alert Volume:</b> Medium</p>",
         "mitre_technique" : "|T1213",
         "SPLEase" : "Hard",
         "hasSearch" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "salesforce sfdc",
         "includeSSE" : "Yes",
         "name" : "Spike in Exported Records from Salesforce.com",
         "gdprtext" : "<h4>Impact:</h4><p>A sudden, high-volume increase in exported records can indicate unauthorized, non-compliant, and potentially malicious behavior. </p><p>Specific to GDPR, detecting and proving that individuals within the organization are not abusing or misusing legitimate access to assets that store and process personal data is an industry best practice and can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). </p>",
         "domain" : "Data",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
         "mitre" : "Collection",
         "category" : "Data Exfiltration|GDPR|SaaS",
         "released" : "1.4.0",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, and number of rows exported. If possible, determine the system the user is using to download this data and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized data collection from an actual customer environment.</p>",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Compliance|Insider Threat",
         "examples" : [
            {
               "name" : "Spike in SFDC Records Exported - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Spike in SFDC Records Exported - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0009",
         "data_source_categories" : "VendorSpecific-sfdc-elf",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Medium",
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Spike in SFDC Records Exported - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_spike_exported_records.png"
      },
      "UC0042" : {
         "released" : "2.0.0",
         "category" : "Compliance|Endpoint Compromise",
         "help" : "Help not needed -- PS Use Case",
         "name" : "SSH Authentication using unknown key",
         "includeSSE" : "No",
         "mitre" : "",
         "domain" : "Endpoint",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "The public key utilized for authentication is recorded in the SSHD authentication log. Detection of a new key should be investigated to determine the owner of the key and validate authorization to access the resource.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "app" : "Splunk_Professional_Services",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Authentication",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Compliance"
      },
      "multiple_logins" : {
         "mitre_tactic" : "|TA0001",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "journey" : "Stage_4",
         "app" : "Splunk_User_Behavior_Analytics",
         "datasource" : "Authentication",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance",
         "dashboard" : "UBA_Use_Case",
         "relatedUseCases" : [
            "multiple_outgoing_connections",
            "excessive_data_transmission"
         ],
         "alertvolume" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Detects outliers in the timeseries of workstation logins per user.",
         "mitre_technique" : "|T1078",
         "category" : "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
         "released" : "2.0.0",
         "help" : "Help not needed -- UBA Use Case",
         "includeSSE" : "Yes",
         "name" : "Multiple Logins",
         "mitre" : "",
         "domain" : "Other"
      },
      "showcase_new_sfdc_clients" : {
         "journey" : "Stage_3",
         "examples" : [
            {
               "name" : "New Applications Contacting SFDC - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "New Applications Contacting SFDC - Live",
               "label" : "Live Data"
            }
         ],
         "mitre_tactic" : "TA0009",
         "data_source_categories" : "VendorSpecific-sfdc-elf",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "Yes",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "usecase" : "Compliance|Insider Threat",
         "icon" : "Core_Use_Case.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Applications Contacting SFDC - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_new_app.png",
         "alertvolume" : "Low",
         "hasSearch" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "salesforce sfdc",
         "description" : "<p>Salesforce.com contains the most critical information for many companies. This search looks for users who connect to SFDC's reporting API with new clients. </p><p><b>Alert Volume:</b> Low</p>",
         "mitre_technique" : "|T1213",
         "SPLEase" : "Medium",
         "released" : "1.4.0",
         "category" : "Data Exfiltration|GDPR|SaaS",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, and application. If possible, determine the system the user is using and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "help" : "<p>This is the generic search builder for First Seen Detection. Our dataset is an anonymized data collection from an actual customer environment.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "name" : "New Application Accessing Salesforce.com API",
         "includeSSE" : "Yes",
         "gdprtext" : "<h4>Problem:</h4><p>Many organizations maintain business-critical information within SaaS applications such as Salesforce.com. Salesforce is an example of a CRM business application which is used to store and process personal data relating to customers, partners, prospects and often employees. As part of a Salesforce.com deployment, other applications interact with this sensitive data, via push or pull APIs that automate data exchange - for example integrations into finance and human resources applications such as Workday, or marketing automation tools such as Eloqua and Marketo. Attackers can attempt to use the Salesforce.com API as a vector to gain access to sensitive data. Because Salesforce.com is a cloud application with a publicly accessible domain, this vector only requires valid credentials, and can be exploited for access to sensitive data by adversaries, even if they lack access to internal resources.</p><h4>Impact:</h4><p>Under the GDPR Article 30, organizations are required to maintain a record of processing activities including contact details of the controller, the purposes of processing, description of the categories of data subjects and personal data processed -- as well as the categories of recipients to whom the personal data has been or will be disclosed including recipients in any other countries. Interactions from new applications -- whether for legitimate purposes or as a result of malicious activity -- can create a non-compliance condition if they are not documented properly. This situation may not impact organizations who employ fewer than 250 persons and therefore may not have critical categories of personal data for processing.</p><h4>Resolution Path:</h4><p>Monitoring Salesforce.com API activity can help identify connections from new applications or clients that might not be whitelisted or documented. The timely and accurate reporting of a non-compliance state can prompt the Data Privacy Officer to proactively follow up and update documentation, and report to the authorities in a timely manner if appropriate.</p>",
         "domain" : "Data",
         "mitre" : "Collection",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>"
      },
      "excessive_http_failure_responses" : {
         "relatedUseCases" : [
            ""
         ],
         "mitre_notes" : "",
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_2",
         "data_source_categories" : "DS014WebServer-ET01Access",
         "mitre_tactic" : "|TA0001|TA0006",
         "usecase" : "Application Security",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Web Server",
         "displayapp" : "Splunk App for Enterprise Security",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Web Attack",
         "domain" : "Network",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "Excessive HTTP Failure Responses",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "search_name" : "Network - Excessive HTTP Failure Responses - Rule",
         "mitre_technique" : "|T1190|T1110",
         "SPLEase" : "Accelerated",
         "description" : "Alerts when a host generates a lot of HTTP failures in a short span of time"
      },
      "detection_unusually_long_commandlines" : {
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Unusual Processes",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "search_name" : "ESCU - Unusually Long Command Line - Rule",
         "mitre_technique" : "|T1059",
         "SPLEase" : "None",
         "description" : "Command-lines that are extremely long can be indicative of malicious activity on your hosts.",
         "help" : "This search calculates the average and standard deviation for the length of the command-lines on each of your endpoints and alerts when a command-line is found with a length over 10 times the standard deviation larger than the average command-line.",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "includeSSE" : "Yes",
         "name" : "Unusually Long Command Line"
      },
      "UC0020" : {
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Network Communication",
         "highlight" : "No",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "mitre_tactic" : "TA0010|TA0007|TA0011",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "FW Default Rules - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "FW Default Rules - Live"
            }
         ],
         "journey" : "Stage_1",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Low",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=FW Default Rules - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/unauthorized_connection_through_firewall.png",
         "description" : "Any communication through the firewall not explicitly granted by policy could indicate either a misconfiguration or even malicious actions, putting your security and compliance at risk.",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1041|T1048|T1094|T1032|T1095|T1046",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Command and Control",
         "name" : "Unauthorized Connection Through Firewall",
         "includeSSE" : "Yes",
         "mitre" : "Exfiltration|Discovery|Command and Control",
         "knownFP" : "No known false positives.",
         "relevance" : "In addition to the general security benefits, this detection will help the data privacy officer of an organization in their GDPR requirements to detect if any new applications or service providers have been connected to push or pull personal data without the proper documentation. This helps to trigger the update of the documentation and engage the DPO, enabling continuous monitoring to detect unauthorized and undocumented new applications that do not follow corporate processes. In addition, GDPR Article 32 requires that you regularly test, assess and evaluate the effectiveness of your implemented technical and organizational security controls. If the Authority executes their powers and your Organization is in the scope of a Privacy Audit you need to demonstrate compliance (Article 58). Also in case you face a breach and individuals are impacted they have the right to compensation of the damage - if an organization can prove that they have done everything appropriate to the risk and deployed proper countermeasures, they shouldn't be liable (Article 82).",
         "domain" : "Access",
         "category" : "GDPR|Data Exfiltration|Scanning",
         "released" : "2.0.0",
         "howToImplement" : "This search should work out of the box with Palo Alto Networks firewalls, and with any other device that uses the Splunk common information model. Just make sure you use a Splunk Add-on that maps them to the Common Information Model (search on Splunkbase!)",
         "operationalize" : "A default allow firewall rule should never be used. If the connection should be allowed, go document it and then add a specific allow rule.",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Firewall logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Firewall or the Common Information Model."
      },
      "insecure_or_cleartext_authentication_detected" : {
         "icon" : "ES_Use_Case.png",
         "usecase" : "Compliance",
         "datasource" : "Network Communication",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "No",
         "app" : "Splunk_App_for_Enterprise_Security",
         "mitre_tactic" : "",
         "data_source_categories" : "DS010NetworkCommunication-ET03UserAware",
         "journey" : "Stage_2",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : "Not an attack - cyber hygiene",
         "SPLEase" : "Medium",
         "mitre_technique" : "",
         "search_name" : "Access - Insecure Or Cleartext Authentication - Rule",
         "description" : "Detects authentication requests that transmit the password over the network as cleartext (unencrypted)",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Access",
         "gdprtext" : "<p>While not explicitly required for GDPR, this capability is often seen as a part of maintaining State of the Art Security and supports GDPR requirements.</p>",
         "name" : "Insecure Or Cleartext Authentication Detected",
         "includeSSE" : "Yes",
         "help" : "Help not needed -- ES Use Case",
         "category" : "IAM Analytics|GDPR",
         "released" : "2.0.0"
      },
      "host_with_multiple_infections" : {
         "mitre" : "",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Host With Multiple Infections",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "SPLEase" : "Accelerated",
         "search_name" : "Endpoint - Host With Multiple Infections - Rule",
         "mitre_technique" : "|T1189|T1193|T1192|T1204",
         "description" : "Alerts when a host with multiple infections is discovered.",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "mitre_notes" : "",
         "dashboard" : "ES_Use_Case",
         "similarUseCases" : [
            "Basic_Malware_Outbreak",
            "Recurring_Infection_on_Host",
            "high_number_of_infected_hosts",
            "host_with_a_recurring_malware_infection",
            "UC0029",
            "UC0028",
            "UC0075",
            "UC0065"
         ],
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "datasource" : "Anti-Virus",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "Yes",
         "app" : "Splunk_App_for_Enterprise_Security",
         "data_source_categories" : "DS004EndPointAntiMalware-ET01SigDetected",
         "mitre_tactic" : "|TA0001|TA0002",
         "journey" : "Stage_2"
      },
      "detection_ec2_instance_created_by_previously_unseen_user" : {
         "includeSSE" : "Yes",
         "name" : "EC2 Instance Started With Previously Unseen User",
         "domain" : "Endpoint",
         "mitre" : "",
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS",
         "help" : "The subsearch returns the ARNs of all successful EC2 instance launches within the last hour and then appends the historical data in the lookup file to those results.  It then recalculates the <code>firstTime</code> and <code>lastTime</code> field for each ARN and returns only those ARNs that have first been seen in the past hour.  This is combined with the main search to return the time, user, and instance id of those systems.",
         "description" : "This search looks for EC2 instances being created by users who have not created them before.",
         "search_name" : "ESCU - EC2 Instance Started With Previously Unseen User - Rule",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "killchain" : "",
         "searchKeywords" : "",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS Cryptomining"
      },
      "sser_ransomware_extensions" : {
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "mitre_tactic" : "TA0002",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Ransomware Extensions - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Ransomware Extensions - Live"
            }
         ],
         "journey" : "Stage_3",
         "alertvolume" : "Low",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Ransomware Extensions - Demo",
         "similarUseCases" : [
            "detection_common_ransomware_extensions"
         ],
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1204",
         "description" : "<p>This example queries your endpoint data to find encrypted files that ransomware will create. You can often even use these extensions to identify the ransomware affecting a given endpoint.</p><p><b>Alert Volume:</b> Low</p>",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "mitre" : "Execution",
         "knownFP" : "None at the moment",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Ransomware Extensions",
         "operationalize" : "When this search fires, you will want to start your incident response process for dealing with a ransomware infection.  You should check for recent backups for the systems effected by the infection.",
         "help" : "This use case is designed to query your endpoint data to look for encrypted files that ransomware creates. Most ransomware families use a consistent extension for the encrypted files they generate, so you can use those extensions to identify the ransomware affecting a given endpoint.",
         "howToImplement" : "This search requires Sysmon to be installed on your endpoints with the Sysmon add-on installed on your forwarders and search heads. Common ransomware extensions and the associated ransomware families are located in the ransomware_extensions.csv lookup file. You can update this list to reflect the latest intelligence without the need to modify the search.",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0"
      },
      "showcase_significant_printing" : {
         "description" : "<p>Find users who printed more pages than normal.</p><p><b>Alert Volume:</b> Medium</p>",
         "mitre_technique" : "|T1052",
         "SPLEase" : "Hard",
         "hasSearch" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Increase in Pages Printed",
         "relevance" : "It may seem inefficient and old-fashioned, but users that suddenly start printing a lot more pages from networked printers than is “normal” could be a sign of data exfiltration. Sensitive data could be leaving your corporation, literally in black-and-white! It is particularly interesting to correlate this behavior to a watchlist which may contain the user IDs of personnel that are considered higher risk: contractors, new employees, employees that never go on vacation, employees with access to particularly sensitive data. Often, the data gathered by Splunk can include the destination printer(s), the source of the print jobs, the names of files printed, and even whether or not the output was black-and-white or color.",
         "domain" : "Data",
         "mitre" : "Exfiltration",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p> ",
         "released" : "1.0.0",
         "category" : "Data Exfiltration",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and validate the user account running these print jobs. If possible, determine which printer and what files are being printed and the time frame during which the printing occurred. Contact the user to determine if it is authorized, and document if it is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as excessive page prints might be a way to exfiltrate sensitive data.</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our demo dataset is an anonymized collection of Print Server logs from a Uniflow print server. For this analysis, we are tracking the total number of pages the user has printed per day 'sum(NumPages) by User _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average.</p>",
         "highlight" : "Yes",
         "datasource" : "Audit Trail",
         "displayapp" : "Splunk Security Essentials",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat",
         "examples" : [
            {
               "name" : "Pages Printed Per User Per Day - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Pages Printed Per User Per Day - Live",
               "label" : "Live Data"
            },
            {
               "label" : "Accelerated with Data Models",
               "name" : "Pages Printed Per User Per Day - Accelerated"
            }
         ],
         "journey" : "Stage_1",
         "mitre_tactic" : "TA0010",
         "data_source_categories" : "DS006UserActivity-ET03Create",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Medium",
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Pages Printed Per User Per Day - Demo"
      },
      "detection_registry_privilege_escalation" : {
         "domain" : "Endpoint",
         "mitre" : "Privilege Escalation|Persistence",
         "name" : "Registry Keys Used For Privilege Escalation",
         "includeSSE" : "Yes",
         "help" : "This search looks for specific registry paths that malware often uses to elevate privileges. The search returns the count, the first time the activity was seen, the last time the activity was seen, the registry path that was modified, the host where the modification took place, and the user who performed the modification.",
         "released" : "2.0.0",
         "category" : "Privilege Escalation",
         "search_name" : "ESCU - Registry Keys Used For Privilege Escalation - Rule",
         "mitre_technique" : "T1183",
         "SPLEase" : "None",
         "description" : "This search looks for modifications to registry keys that can be used to elevate privileges. The registry keys under \"Image File Execution Options\" are used to intercept calls to an executable and can be used to attach malicious binaries to benign system binaries.",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious Windows Registry Activities",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "TA0004|TA0003"
      },
      "sser_spike_in_smb_traffic" : {
         "includeSSE" : "Yes",
         "name" : "Spike in SMB Traffic",
         "mitre" : "Discovery|Execution|Lateral Movement",
         "knownFP" : "No known false positives.",
         "domain" : "Network",
         "category" : "Lateral Movement|Scanning",
         "released" : "1.0.0",
         "howToImplement" : "To run this search, you must index data from sources that observe network traffic, such as Bro, Splunk Stream, or firewalls. You can then identify spikes in the number of SMB connection attempts.",
         "operationalize" : "When this search fires, you will to start your incident response process to verify the activity of the system is legitimate.  You should investigate and determine the process that initiated this traffic and verify its activities.",
         "help" : "This search looks for hosts with an unusually high increase in SMB network connections.",
         "description" : "<p>This search looks for hosts with an unusually high increase in SMB network connections.</p><p><b>Alert Volume:</b> Very Low</p>",
         "SPLEase" : "Hard",
         "mitre_technique" : "|T1135|T1105|T1021",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "alertvolume" : "Very Low",
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Detect Spike in SMB Traffic - Demo",
         "similarUseCases" : [
            "detection_smb_traffic_spike"
         ],
         "datasource" : "Network Communication",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "mitre_tactic" : "TA0007|TA0008",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic|DS010NetworkCommunication-ET01TrafficAppAware",
         "examples" : [
            {
               "name" : "Detect Spike in SMB Traffic - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Detect Spike in SMB Traffic - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_1",
         "app" : "Splunk_Security_Essentials"
      },
      "geographically_improbable_access_detected" : {
         "description" : "Alerts on access attempts that are improbable based on time and geography.",
         "mitre_technique" : "|T1078",
         "search_name" : "Access - Geographically Improbable Access Detected - Rule",
         "SPLEase" : "Accelerated",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "name" : "Geographically Improbable Access Detected",
         "includeSSE" : "Yes",
         "domain" : "Access",
         "mitre" : "",
         "released" : "2.0.0",
         "category" : "IAM Analytics|Account Sharing|Account Compromise",
         "help" : "Help not needed -- ES Use Case",
         "highlight" : "No",
         "datasource" : "Authentication",
         "displayapp" : "Splunk App for Enterprise Security",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Compliance",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0001|TA0004",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "app" : "Splunk_App_for_Enterprise_Security",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case"
      },
      "showcase_new_parent_process_for_cmd" : {
         "examples" : [
            {
               "name" : "New Parent Process for cmd.exe or regedit.exe - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "New Parent Process for cmd.exe or regedit.exe - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "mitre_tactic" : "TA0002",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Parent Process for cmd.exe or regedit.exe - Demo",
         "alertvolume" : "Medium",
         "hasSearch" : "Yes",
         "killchain" : "Exploitation",
         "searchKeywords" : "sysmon",
         "description" : "<p>cmd.exe and regedit.exe tend to be used in the same ways. New parent processes can be suspicious. (<a href=\"https://car.mitre.org/wiki/CAR-2013-02-003\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Medium</p>",
         "mitre_technique" : "|T1059",
         "SPLEase" : "Medium",
         "released" : "1.0.0",
         "category" : "Endpoint Compromise",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. <b>For this search</b> you may wish to alter the process names that are tracked.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the parent process that initiated cmd.exe or regedit.exe. Determine the user account this is running under and the system it is running on. Contact the user and system owner of this action. If it is authorized, document that this is and by whom. If not, the user credentials have been used by another party and additional investigation is warranted to ensure that processes are not spawning these commands.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch logs from Microsoft Sysmon (EventCode=1). For this analysis, we are looking at the processes that spawned cmd.exe, regedit.exe, and powershell.exe. If we've seen that ParentProcess before, then all is fine, but if we've never seen it before we'll raise an alert.</p>",
         "name" : "New Parent Process for cmd.exe or regedit.exe",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "relevance" : "As described above, we want to carefully monitor certain executables on our Windows endpoints and understand what is calling them. For example, if we see a program like Word or Excel launching cmd.exe, it is probably up to no good especially if we’ve never seen it do that before. Programs that behave in this way legitimately should be whitelisted - others should be immediately investigated.",
         "mitre" : "Discovery|Lateral Movement|Execution",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This detection should have relatively few false positives given the rarity of new parent processes for these standard Windows processes. Most noise that will come from new systems management scripts, or from new software installers. These can be whitelisted in the search.</p>"
      },
      "detection_schtasks_scheduling_job_on_remote_system" : {
         "name" : "Schtasks scheduling job on remote system",
         "includeSSE" : "Yes",
         "mitre" : "Persistence|Lateral Movement|Execution",
         "domain" : "Endpoint",
         "category" : "Lateral Movement",
         "released" : "2.0.0",
         "help" : "The search looks for execution of schtasks.exe with parameters that indicate a task is being scheduled on a remote host. Schtasks.exe is a native windows program that is used to schedule tasks on local or remote systems. Attackers often leverage this capability to schedule the execution of commands or malicious executables on remote systems.",
         "description" : "This search looks for flags passed to schtasks.exe on the command-line that indicate a job is being scheduled on a remote system.",
         "SPLEase" : "None",
         "mitre_technique" : "T1053|T1021",
         "search_name" : "ESCU - Schtasks scheduling job on remote system - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0003|TA0008|TA0002",
         "journey" : "Stage_3",
         "story" : "Lateral Movement",
         "app" : "Enterprise_Security_Content_Update"
      },
      "anomalous_new_service" : {
         "alertvolume" : "Other",
         "relatedUseCases" : [
            "showcase_new_interactive_service_logon",
            "anomalous_new_process"
         ],
         "dashboard" : "ES_Use_Case",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Splunk App for Enterprise Security",
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_3",
         "mitre_tactic" : "|TA0004|TA0003",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "domain" : "Endpoint",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "Anomalous New Service",
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise|Unauthorized Software|Privilege Escalation",
         "mitre_technique" : "|T1050",
         "search_name" : "Endpoint - Anomalous New Services - Rule",
         "SPLEase" : "Advanced",
         "description" : "Alerts when an anomalous number hosts are detected with a new service.",
         "searchKeywords" : "",
         "hasSearch" : "No"
      },
      "showcase_emails_with_lookalike_domains" : {
         "alertvolume" : "Very Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/emails_lookalike_domains.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Emails With Lookalike Domains - Demo",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "highlight" : "Yes",
         "datasource" : "Email",
         "displayapp" : "Splunk Security Essentials",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "Emails With Lookalike Domains - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Emails With Lookalike Domains - Live",
               "label" : "Live Data"
            },
            {
               "name" : "Emails With Lookalike Domains - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_4",
         "data_source_categories" : "DS001MAIL-ET02Receive",
         "mitre_tactic" : "TA0001",
         "domain" : "Network",
         "mitre" : "Initial Access",
         "knownFP" : "<p>This search will through incoming emails for any domains similar to your domain names, much like running dnstwist on a domain name. If there are any incoming emails with source domain names that are very similar to but not the same, they would create alerts which could be false positives. One might imagine a scenario where a company who manufactures wooden planks for pirate ships, plank.com, emails their sales rep at splunk.com. That would create a difference of 2 (u->a, extra s) and would be flagged (Arrrr!). Known examples of this could be filtered out in the search, or you could pipe this into a First Time Seen detection to automatically remove past examples. </p>",
         "name" : "Emails with Lookalike Domains",
         "includeSSE" : "Yes",
         "howToImplement" : "Implementing this search is generally fairly straightforward. If you have CIM compliant data onboarded, it should work out of the box, however you are always better off specifying the index and sourcetype of your email data (think particularly when you have multiple email log sources, such as a perimeter ESA and a core Exchange environment). If you have the right index, sourcetype, you have the src_user field, and you've installed the URL Toolbox app, it should work like a charm. ",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the event, the sender, recipient, subject or the mail and attachments, if any. Contact the sender. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is an anonymized collection of email logs centered around a particular user for a month.</p>",
         "released" : "1.2.0",
         "category" : "Endpoint Compromise|SaaS",
         "mitre_technique" : "|T1192",
         "SPLEase" : "Advanced",
         "advancedtags" : "Cool Search",
         "description" : "<p>Emailing from a domain name that is similar to your own is a common phishing technique, such as splunk.com receiving an email from spiunk.com. This search will detect those similar domains.</p><p><b>Alert Volume:</b> Very Low</p>",
         "killchain" : "Delivery",
         "searchKeywords" : "",
         "hasSearch" : "Yes"
      },
      "detection_malicious_application_shimming_via_registry" : {
         "story" : "Windows Persistence Techniques",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "TA0003",
         "journey" : "Stage_3",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "search_name" : "ESCU - Registry Keys for Creating SHIM Databases - Rule",
         "mitre_technique" : "T1138",
         "description" : "This search looks for registry activity associated with application compatibility shims, which can be leveraged by attackers for various nefarious purposes.",
         "help" : "In this search, we look for modifications to registry keys used for shim databases on Microsoft platforms via the object_category and object_path field in the Change_Analysis data model and give you the destination, command used to initiate the change, the user who conducted this activity, the resource affected(object), and the whole path of the object. An application compatibility shim is a small library that transparently intercepts an API (via hooking), changes the parameters passed, handles the operation itself, or redirects the operation elsewhere, such as additional code stored on a system. This capability can be also leveraged by attackers to create and store malicious files in a shim database as observed in CARBANAK backdoor.",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "mitre" : "Persistence",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Registry Keys for Creating SHIM Databases"
      },
      "UC0115" : {
         "SPLEase" : "Basic",
         "released" : "2.0.0",
         "category" : "GDPR|Endpoint Compromise",
         "howToImplement" : "First, use your data mapping results to build a lookup that associates systems to their GDPR category. This particular search usually finds most of its success with just Symantec AV. Many Anti-Virus products are found to provide insufficient logging to be able to see when the definitions are updated (often, just when there is malware found). If you are using Symantec AV and followed the data onboarding guide, this should work automatically. If you did not follow the data onboarding guide, make sure that your sourcetypes and indexes match. Always hard-code your sourcetypes and indexes rather than doing index=* in searches.",
         "operationalize" : "When this fires, look on the host to see why the Anti-Virus isn't updating. If you don't see an obvious reason (e.g., specific and logical error), then it may be worth investigating that host to see if there are any other suspicious events that have occurred to rule out an infection.",
         "name" : "In-Scope Device with Outdated Anti-Malware Found",
         "knownFP" : "No known false positives at this time.",
         "mitre" : "",
         "examples" : [
            {
               "name" : "Outdated Malware Definitions GDPR - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Outdated Malware Definitions GDPR - Live",
               "label" : "Live Data"
            }
         ],
         "datasource" : "Anti-Virus",
         "icon" : "Core_Use_Case.png",
         "visualizations" : [
            {
               "vizType" : "ChartElement",
               "search" : "| `Load_Sample_Log_Data(Symantec Endpoint Protection Operations)`  |stats max(eval(if(like(Event_Description, \"%LiveUpdate session ran successfully%\") , _time, null))) as LatestUpdate max(_time) as LatestMessage max(eval(if(tag=\"error\", _time, null))) as LatestError by Host_Name   | eval Up_To_Date = if( LatestUpdate < relative_time(LatestMessage, \"-3d\") OR LatestError > LatestUpdate , \"No\", \"Yes\") | lookup gdpr_system_category host as Host_Name| search category=* | stats count by Up_To_Date",
               "header" : "Broken",
               "title" : "Percentage of In-Scope Hosts with Up To Date AV",
               "dashboard" : "General Windows and Linux Posture",
               "vizParameters" : {
                  "refresh.link.visible" : "false",
                  "link.inspectSearch.visible" : "false",
                  "link.openSearch.visible" : "false",
                  "link.exportResults.visible" : "false",
                  "resizable" : true,
                  "charting.chart" : "pie",
                  "link.visible" : "false",
                  "link.openPivot.visible" : "false"
               },
               "type" : "viz",
               "panel" : "row1cell1"
            },
            {
               "header" : "Broken",
               "vizType" : "TableElement",
               "search" : "| `Load_Sample_Log_Data(Symantec Endpoint Protection Operations)`  |stats max(eval(if(like(Event_Description, \"%LiveUpdate session ran successfully%\") , _time, null))) as LatestUpdate max(_time) as LatestMessage max(eval(if(tag=\"error\", _time, null))) as LatestError by Host_Name   | eval Up_To_Date = if( LatestUpdate < relative_time(LatestMessage, \"-3d\") OR LatestError > LatestUpdate , \"No\", \"Yes\") | search Up_To_Date = Yes | lookup gdpr_system_category host as Host_Name| search category=*| convert ctime(LatestUpdate) ctime(LatestMessage) ctime(LatestError) ",
               "dashboard" : "General Windows and Linux Posture",
               "title" : "Hosts with Up To Date AV",
               "type" : "viz",
               "vizParameters" : {
                  "link.openPivot.visible" : "false",
                  "link.inspectSearch.visible" : "false",
                  "refresh.link.visible" : "false",
                  "resizable" : true,
                  "link.openSearch.visible" : "false",
                  "link.exportResults.visible" : "false"
               },
               "panel" : "row1cell2"
            },
            {
               "header" : "Broken",
               "vizType" : "TableElement",
               "search" : "| `Load_Sample_Log_Data(Symantec Endpoint Protection Operations)`  |stats max(eval(if(like(Event_Description, \"%LiveUpdate session ran successfully%\") , _time, null))) as LatestUpdate max(_time) as LatestMessage max(eval(if(tag=\"error\", _time, null))) as LatestError by Host_Name   | eval Up_To_Date = if( LatestUpdate < relative_time(LatestMessage, \"-3d\") OR LatestError > LatestUpdate , \"No\", \"Yes\") | search Up_To_Date = No | lookup gdpr_system_category host as Host_Name| search category=* | convert ctime(LatestUpdate) ctime(LatestMessage) ctime(LatestError)",
               "dashboard" : "General Windows and Linux Posture",
               "title" : "Hosts with Expired AV",
               "type" : "viz",
               "vizParameters" : {
                  "link.openPivot.visible" : "false",
                  "link.inspectSearch.visible" : "false",
                  "refresh.link.visible" : "false",
                  "resizable" : true,
                  "link.exportResults.visible" : "false",
                  "link.openSearch.visible" : "false"
               },
               "panel" : "row1cell3"
            }
         ],
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/gdpr_outdated_av.png",
         "alertvolume" : "Low",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "description" : "Alerts when a GDPR-tagged system has out of date malware definitions, which would conflict with GDPR's requirement to maintain a secure environment.",
         "mitre_technique" : "",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
         "gdprtext" : "<h4>Problem:</h4><p>Similar to High Number of Hosts Not Updating Malware Signatures and Detection of Uncleaned Malware on Endpoint, malware can persist if an endpoint protection solution is not updating its malware signatures. Even a single host with outdated anti-malware can indicate an infection. If that host is tagged under the GDPR category, then immediate remediation is required to address that non-compliant condition.</p><h4>Impact:</h4><p>When environments that are involved in processing personal data include systems with outdated anti-malware protection (or lacking protection altogether), then those systems are at high risk and therefore out of compliance with the GDPR regulation to maintain and prove privacy requirements are being met per Article 32, Article 58, and Article 82. See above methods, High Number of Hosts Not Updating Malware Signatures and Detection of Uncleaned Malware on Endpoint.</p><h4>Resolution Path:</h4><p>The data mapping exercise from the DPO can inform which systems are in-scope -- that is, those systems that are associated with the GDPR category. From there, identify the in-scope systems with outdated anti-malware or lacking anti-malware protection, pinpoint the root issue for updates not occurring, and remediate those hosts by configuring them or the environment appropriately, depending on what the root issue turns out to be. Also see above methods, High Number of Hosts Not Updating Malware Signatures and Detection of Uncleaned Malware on Endpoint.</p>",
         "includeSSE" : "Yes",
         "domain" : "Access",
         "data_source_categories" : "DS004EndPointAntiMalware-ET02UpdatedSig|DS004EndPointAntiMalware-ET03UpdatedEng",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "app" : "Splunk_Security_Essentials",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "usecase" : "Security Monitoring|Compliance",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Outdated Malware Definitions GDPR - Demo",
         "mitre_notes" : "Cyber hygiene",
         "similarUseCases" : [
            "UC0112"
         ]
      },
      "sse_dyndns" : {
         "hasSearch" : "Yes",
         "killchain" : "Command and Control",
         "searchKeywords" : "dyndns ddns",
         "description" : "<p>Detect outbound communication to Dynamic DNS servers, which are frequently leveraged for command and control by all types of attackers.</p>",
         "mitre_technique" : "|T1333|T1311|T1071",
         "SPLEase" : "Basic",
         "released" : "2.2.0",
         "category" : "Command and Control",
         "howToImplement" : "<p>The first step in implementing this detection is to acquire a list of dyndns providers. During our research for this use case, Malware-Domains* seemed to provide a comprehensive list, but there are other lists discoverable from Google*. Once you download a list, you will need to format it to fit the Splunk lookup format:</p><ol><li>First, download the file. If you are using Malware-Domains, you can find it here: <a href=\"http://www.malware-domains.com/files/dynamic_dns.zip\">Malware-Domains Download</a></li><li>Second, clean it and put it into the proper location:<ul><li>Windows <p>In notepad, use Find and Replace to change each sequence of \"#from...\" to \",true\" so that they all say things like chickenkiller.com,true. Add the line \"domain,inlist\" at the top of the file.</p></li><li>Linux / OSX:<pre>echo \"domain,inlist\" > $SPLUNK_HOME/etc/apps/Splunk_Security_Essentials/lookups/dynamic_dns_lookup.csv && cat dynamic_dns.txt | grep -v \"^#\" | egrep -v \"^\\s*$\" | sed 's/[^a-zA-Z]*#.*/,true/' >> $SPLUNK_HOME/etc/apps/Splunk_Security_Essentials/lookups/dynamic_dns_lookup.csv</pre></li><ul></li></ol><p>Once you have the file in place, the rest should move on smoothly!</p><p class=\"disclaimer\">* Information regarding third-party sites are provided solely as a convenience to Splunk customers, but Splunk neither controls nor endorses, nor is Splunk responsible for, such sites or any content therein.  Customer’s use of the sites is at customer’s own risk and may be subject to additional terms, conditions and policies applicable to such sites (such as license terms, terms of service or privacy policies of the providers of the sites).</p>",
         "operationalize" : "<p>When this alert fires, look for the common allowable scenarios, particularly that of users who are accessing their home networks (see Known False Positives). If that does not seem to be the case, consult data from Splunk Stream or from your packet capture to determine what type of data was sent, and review the dns name and IP in open source intelligence to see if there is anything of note (though that is often hard for this scenario). If this is a critical host, consider endpoint logging via Microsoft Sysmon that will indicate the process that is creating these connections, or other endpoint response mechanisms.</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an collection of outbound network communications, and a lookup of common command and control servers. For this analysis, we are pulling the outbound proxy requests (though you could also use DNS requests), using URL Toolbox to extract just the domain name, and then looking it up in the file pulled from Malware-Domains.</p>",
         "name" : "Basic Dynamic DNS Detection",
         "includeSSE" : "Yes",
         "domain" : "Network",
         "relevance" : "<p>Attackers desire flexibility in their command and control capabilities (along with other parts of their infrastructure), and dynamic DNS can provide that flexibility. While there are legitimate uses of dynamic DNS (many IT professionals use it to access home networks), the risks of not monitoring the practice can be significant. Fortunately, between Splunk and a list provided by Malware Domains, finding dynamic DNS in your environment is easy.</p>",
         "knownFP" : "Production services that use dynamic DNS, while rare, do happen. Those will cause some base level of false positives, though they should never be business-critical services. The most common scenario for dynamic DNS is for users reaching out to their homes to see their dogs via webcam, or etc. Whether to allow tune out these users (most common) or prohibit that activity is ultimately a policy decision.",
         "mitre" : "Command and Control",
         "journey" : "Stage_1",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "DynDNS - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "DynDNS - Live"
            },
            {
               "label" : "Accelerated Data",
               "name" : "DynDNS - Accelerated"
            }
         ],
         "mitre_tactic" : "TA0011|TA0022|TA0021",
         "data_source_categories" : "DS005WebProxyRequest-ET01Requested|DS002DNS-ET01Query",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "No",
         "datasource" : "Web Proxy|DNS",
         "displayapp" : "Splunk Security Essentials",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring|Advanced Threat Detection",
         "mitre_notes" : "",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=DynDNS - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sse_dyndns.png",
         "alertvolume" : "Medium"
      },
      "detection_abnormally_high_instances_launched" : {
         "search_name" : "ESCU - Abnormally High AWS Instances Launched by User - Rule",
         "mitre_technique" : "",
         "description" : "This search looks for CloudTrail events where a user successfully launches an abnormally high number of instances.",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Network",
         "mitre" : "Execution",
         "name" : "Abnormally High AWS Instances Launched by User",
         "includeSSE" : "Yes",
         "help" : "In this search, we query CloudTrail logs to look for events where an instance is successfully launched by a particular user. Since we want to detect a high number of instances launched within a short period, we create event buckets for 10-minute windows. We then calculate the total number of instances launched by a particular user, as well as the average and standard deviation values. Assign a <code>threshold_value</code> in the search. Start with 3 (but it will likely need to be tweaked for your environment). The <code>eval</code> function will set the outlier 1 if the number of instances is greater than the average number of instances terminated, added to the multiplied value of threshold and standard deviation. For your reference, we then keep only the outliers and calculate the number of standard deviations away the value is from the average.",
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS Cryptomining",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0002",
         "alertvolume" : "Medium",
         "mitre_notes" : "MITRE ATT&CK enterprise does not have good cataloging of cloud based activity.",
         "dashboard" : "ESCU_Use_Case"
      },
      "showcase_new_logon_type" : {
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Logon Type for User - Demo",
         "alertvolume" : "Low",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "|TA0004|TA0003",
         "examples" : [
            {
               "name" : "New Logon Type for User - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "New Logon Type for User - Live"
            }
         ],
         "journey" : "Stage_1",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Compliance",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the event creation, as well as the user account and systems that were logged into and in the case of remote login, where they initiated the logon from, credentials that were used, process executed and other pertinent information. Contact the user and owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of logon events. We check the first time that each user has performed each logon type and then alert if that was in the last day.</p>",
         "category" : "Account Compromise",
         "released" : "1.0.0",
         "mitre" : "Privilege Escalation|Persistence|Defense Evasion",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
         "domain" : "Access",
         "name" : "New Logon Type for User",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Installation",
         "hasSearch" : "Yes",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1078",
         "description" : "<p>Windows defines several logon types (Interactive, RemoteInteractive, Network, etc.). Established users rarely generate new logon types. This search will look for that scenario. (<a href=\"https://car.mitre.org/wiki/CAR-2013-02-012\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>"
      },
      "completely_inactive_account" : {
         "SPLEase" : "Advanced",
         "mitre_technique" : "|T1078",
         "search_name" : "Access - Completely Inactive Account - Rule",
         "description" : "Discovers accounts that are no longer used. Unused accounts should be disabled and are oftentimes used by attackers to gain unauthorized access.",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre" : "",
         "domain" : "Access",
         "includeSSE" : "Yes",
         "name" : "Completely Inactive Account",
         "help" : "Help not needed -- ES Use Case",
         "category" : "IAM Analytics",
         "released" : "2.0.0",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Compliance|Security Monitoring",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Authentication",
         "highlight" : "No",
         "app" : "Splunk_App_for_Enterprise_Security",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "mitre_tactic" : "|TA0001|TA0004|TA0003",
         "journey" : "Stage_4",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case"
      },
      "sser_monitor_autorun_registry_keys" : {
         "searchKeywords" : "",
         "killchain" : "Installation",
         "hasSearch" : "Yes",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1060",
         "description" : "<p>Attackers often add malware to the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa376977(v=vs.85).aspx\">Windows Autorun</a> registry keys to maintain persistence. This search looks through registry data for suspicious activities.</p><p><b>Alert Volume:</b> High</p>",
         "help" : "Often, attackers add malware to the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa376977(v=vs.85).aspx\">Windows Autorun</a> registry keys. This allows the malware to execute after a restart of the computer, which enables it to persist across reboots, and potentially delays the execution of the code until after a reboot to make its activities harder to detect. While legitimate applications also write to these keys, it is a good idea to monitor them and investigate anything that appears suspicious.",
         "operationalize" : "When this search fires, you will want to start your incident response process for dealing and verify the activities of the process that wrote the registry key.",
         "howToImplement" : "This use case requires a universal forwarder on the Windows endpoints you wish to monitor as well as the Windows add-on configured to send your logs to Splunk. Alternatively, data from endpoint solutions such as Carbon Black can also report registry modifications for this use case.",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "mitre" : "Persistence",
         "knownFP" : "None at the moment",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Monitor AutoRun Registry Keys",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "TA0003",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Suspicious Windows Registry activity - Demo"
            },
            {
               "name" : "Suspicious Windows Registry activity - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Suspicious Windows Registry activity - Demo",
         "similarUseCases" : [
            "detection_registry_persistence"
         ],
         "alertvolume" : "High"
      },
      "detection_aws_cloud_provisioning_from_previously_unseen_city" : {
         "mitre_technique" : "",
         "search_name" : "ESCU - AWS Cloud Provisioning From Previously Unseen City - Rule",
         "description" : "This search looks for AWS provisioning activities from previously unseen cities.  Provisioning activities are defined broadly as any event that begins with \"Run\" or \"Create.\" ",
         "killchain" : "",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Endpoint",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "AWS Cloud Provisioning From Previously Unseen City",
         "help" : "The subsearch returns all events with event names that start with \"Run\" or \"Create,\" and then does a <code>GeoIP</code> lookup on the IP address that initiated the action within the last hour. It appends the historical data to those results in the lookup file. Next, it recalculates the <code>firstTime</code> and <code>lastTime</code> field for each country, region, city, and IP address and outputs this data to the lookup file to update the local cache. It then calculates the <code>firstTime</code> and <code>lastTime</code> for each city. It returns only those events from cities that have first been seen in the past hour. This is combined with the main search to return the time, user, IP address, city, event name, and error code from the action.",
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS Suspicious Provisioning Activities",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case"
      },
      "UC0077" : {
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Maintain a tracking list of public domain suffix and data source &quot;seen&quot; by first epoch. ",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "released" : "2.0.0",
         "category" : "Unauthorized Software",
         "help" : "Help not needed -- PS Use Case",
         "name" : "Detection Risky Referral Domains",
         "includeSSE" : "No",
         "domain" : "Network",
         "mitre" : "",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "highlight" : "No",
         "datasource" : "Email|Web Server",
         "displayapp" : "Splunk Professional Services",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other"
      },
      "detection_api_acitivity_from_previously_unseen_user_role" : {
         "search_name" : "ESCU - Detect new API calls from user roles - Rule",
         "mitre_technique" : "",
         "description" : "This search detects new API calls that have either never been seen before or that have not been seen in the previous hour, where the identity type is <code>AssumedRole</code>.",
         "killchain" : "",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Endpoint",
         "mitre" : "",
         "name" : "Detect new API calls from user roles",
         "includeSSE" : "Yes",
         "help" : "The subsearch will execute first and return the user roles and names of the API calls completed within the last hour, where the type of user identity is <code>AssumedRole</code>. It then appends the historical data to those results in the lookup file. Next, it recalculates the <code>earliest</code> and <code>latest</code> fields for each user role, as well as the name of the API call, and returns only those roles and API calls that have first been seen in the past hour. This is combined with the main search to return the values of API calls, name of the user role, and the earliest and latest time of this activity. It is worth noting that the name of the role of a particular user is parsed as \"userName\" in the CloudTrail logs.",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS User Monitoring",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case"
      },
      "detection_dns_record_changed" : {
         "mitre_technique" : "T1043|T1048",
         "description" : "The search takes the DNS records and their answers results of the discovered_dns_records lookup and finds if any records have changed by searching DNS response from the Network_Resolution datamodel across the last day.",
         "killchain" : "Command and Control",
         "hasSearch" : "No",
         "domain" : "Network",
         "mitre" : "Exfiltration|Command and Control|Defense Evasion",
         "incluseSSE" : "No",
         "includeSSE" : "Yes",
         "name" : "DNS record changed",
         "help" : "Using a lookup `discover_dns_records` generated by support search \"Discover DNS records\" we check previous network traffic and make sure the responses have not changed.",
         "released" : "2.2.0",
         "category" : "Adversary Tactics|",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "datasource" : "DNS",
         "displayapp" : "Enterprise Security Content Update",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "DNS Hijacking",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0010|TA0011",
         "data_source_categories" : "DS002DNS-ET01Query",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case"
      },
      "detection_excessive_dns_failures" : {
         "category" : "Command and Control",
         "released" : "2.0.0",
         "help" : "This search looks at DNS traffic with a reply code that is NOT indicative of a successful response. Numerous unsuccessful replies may be indicative of DNS protocol tampering or other malicious activity. If more than 50 of these unsuccessful responses are observed over the time frame of the search, a notable event will be generated.",
         "includeSSE" : "Yes",
         "name" : "Excessive DNS Failures",
         "mitre" : "Exfiltration|Command and Control",
         "domain" : "Network",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Command and Control",
         "description" : "This search identifies DNS query failures by counting the number of DNS responses that do not indicate success, and trigger on more than 50 occurrences.",
         "SPLEase" : "None",
         "search_name" : "Network - Excessive DNS Failures - Rule",
         "mitre_technique" : "T1048|T1043",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "data_source_categories" : "DS002DNS-ET01QueryResponse",
         "mitre_tactic" : "TA0010|TA0011",
         "journey" : "Stage_4",
         "story" : "Suspicious DNS Traffic",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "DNS",
         "highlight" : "Yes",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection"
      },
      "suspicious_http_redirects" : {
         "description" : "Detects sequences of HTTP requests within a short period of time that suggests infection has taken place.",
         "mitre_technique" : "|T1185",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Suspicious HTTP redirects",
         "domain" : "Other",
         "mitre" : "",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "help" : "Help not needed -- UBA Use Case",
         "highlight" : "No",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Web Proxy",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_6",
         "data_source_categories" : "DS005WebProxyRequest-ET01Requested",
         "mitre_tactic" : "|TA0009",
         "app" : "Splunk_User_Behavior_Analytics",
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case"
      },
      "detection_ec2_instance_started_with_previously_unseen_ami" : {
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS Cryptomining",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "mitre_technique" : "",
         "search_name" : "ESCU - EC2 Instance Started With Previously Unseen AMI - Rule",
         "description" : "This search looks for EC2 instances being created with previously unseen AMIs.",
         "killchain" : "",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "domain" : "Endpoint",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "EC2 Instance Started With Previously Unseen AMI",
         "help" : "The subsearch returns the AMI image ID of all successful EC2 instance launches within the last hour and then appends the historical data from the lookup file to those results.  It then recalculates the earliest and latest seen time field for each AMI image ID and returns only those AMI image IDs that have first been seen in the past hour.  This is combined with the main search to return the time, user, and instance id of those systems.",
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS"
      },
      "excessive_data_transmission" : {
         "app" : "Splunk_User_Behavior_Analytics",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "|TA0010",
         "journey" : "Stage_6",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Insider Threat|Insider Threat",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Network Communication",
         "highlight" : "Yes",
         "dashboard" : "UBA_Use_Case",
         "mitre_notes" : "",
         "relatedUseCases" : [
            "multiple_logins",
            "multiple_outgoing_connections"
         ],
         "alertvolume" : "Other",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre_technique" : "|T1048|T1041",
         "description" : "Detects outliers in the timeseries of outgoing bytes transmission by each user, and each device. This detection will occur both normal traffic, VPN traffic, and separately after profiling connections. The profiling connections model only considers connections that behave as file transfers and ignores other type of connections, such as regular web browsing and interactive chat/video connections. Connection profiling aims to reduce False Positives (FP). Note that connection profiling is only available when network events include information about number of packets.",
         "help" : "Help not needed -- UBA Use Case",
         "category" : "Data Exfiltration|Insider Threat",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Other",
         "name" : "Excessive Data Transmission",
         "includeSSE" : "Yes"
      },
      "UC0044" : {
         "mitre" : "",
         "domain" : "Access",
         "name" : "Network authentication using password auth",
         "includeSSE" : "No",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Account Compromise|Compliance|Network Attack",
         "released" : "2.0.0",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Even using SSH encryption, allowing password authentication to Linux/Unix systems over the network increases the attack surface and the possible impact of a compromised account. Investigate and resolve all instances of network authentication utilizing password.",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "datasource" : "Authentication",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_4"
      },
      "detection_create_hidden_shares" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "story" : "Hidden Cobra Malware",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0002|TA0003",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "journey" : "Stage_3",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "help" : "Net.exe is a built-in command-line tool on Windows that can be used to create, delete, and manage shared resources on the computer, both locally and remotely. Though this tool is used by Microsoft administrators to manage the network shares, attackers also leverage it to create and delete hidden file shares by appending \"$\" after the name of the share. To look for hidden shares, use a regular expression to look for a <code>(name_file_share)$</code>. In this search, we are looking for the command-line execution of net.exe with command-line parameters such as <code>net</code>, <code>share</code>, or <code>delete</code> that may correspond to the creation of hidden shares",
         "released" : "2.2.0",
         "category" : "Malware",
         "mitre" : "Execution|Persistence",
         "domain" : "Endpoint",
         "name" : "Create or delete hidden shares using net.exe",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "search_name" : "ESCU - Create or delete hidden shares using net.exe - Rule",
         "mitre_technique" : "T1059",
         "description" : "This search looks for the creation or deletion of hidden shares using net.exe."
      },
      "detection_activity_related_to_pass_the_hash" : {
         "description" : "This search looks for specific authentication events from the Windows Security Event logs to detect potential attempts at using the Pass-the-Hash technique.",
         "SPLEase" : "None",
         "mitre_technique" : "T1075",
         "search_name" : "ESCU - Detect Activity Related to Pass the Hash Attacks - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "name" : "Detect Activity Related to Pass the Hash Attacks",
         "includeSSE" : "Yes",
         "mitre" : "Lateral Movement",
         "domain" : "Access",
         "category" : "Lateral Movement",
         "released" : "2.0.0",
         "help" : "To detect pass the hash activity, we look at all events with event code 4624 or 4625 that specify a logon type 3 (network logons). We are looking for the NtLmSsP account, with a key length set to 0. These indicate lower level protocols that are typically used through Pass the Hash (WMI, SMB, etc.). The search also filters out events with an account name of 'Anonymous' to help reduce false positives.",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0008",
         "journey" : "Stage_1",
         "story" : "Lateral Movement",
         "app" : "Enterprise_Security_Content_Update",
         "alertvolume" : "High",
         "dashboard" : "ESCU_Use_Case"
      },
      "UC0105" : {
         "description" : "Internal web applications often contain sensitive information and should be controlled. Multiple technologies can be used to detect rogue web applications, including Imperva WAF and/or Splunk App for Stream. Use one of these technologies to detect web applications in the environment that have not been seen internally before.",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "includeSSE" : "No",
         "name" : "Detect Newly Seen Public Web Application (Internal)",
         "domain" : "Endpoint",
         "mitre" : "",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "help" : "Help not needed -- PS Use Case",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Web Server|Web Application Firewall",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case"
      },
      "sser_monitor_successful_backups" : {
         "name" : "Monitor Successful Backups",
         "includeSSE" : "Yes",
         "mitre" : "",
         "knownFP" : "None at the moment",
         "domain" : "Operations",
         "released" : "1.0.0",
         "category" : "Operations|GDPR",
         "help" : "With sufficient backups that are maintained outside the local network, ransomware goes from unrecoverable losses to a manageable nuisance that consumes time. Organizations must track their back-up posture as a part of their overall corporate data availability and resiliency plan. This means knowing that routine backups are taking place and notifying the appropriate personnel when they are not. This use case helps Splunk users manage and verify that data resiliency processes are being conducted, specifically looking for indications of successful backups.",
         "operationalize" : "This search will let you know when one of your systems has been backed up. It will help you understand your environment and how often systems are backed up. You can use this knowledge in your risk assessment for your environment.",
         "howToImplement" : "Because there are so many different strategies for backups and data resiliency, this search is provided as an example. In order to implement this, you need to obtain data from the backup logs on your endpoints, or from a central server responsible for performing the backups. In this case, we used netbackup as an example. Feel free to modify this search according to your backup solution and strategy.",
         "description" : "<p>With good backups, a ransomware attack goes from unrecoverable losses to a manageable nuisance. This shows how you can track successful backups.</p><p><b>Alert Volume:</b> Very High</p>",
         "SPLEase" : "Basic",
         "mitre_technique" : "",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "alertvolume" : "Very High",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Successful Backups - Demo",
         "mitre_notes" : "Cyber hygiene monitoring",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Backup",
         "highlight" : "No",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "mitre_tactic" : "",
         "data_source_categories" : "DS027EndpointBackup-ET01General",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Successful Backups - Demo"
            },
            {
               "name" : "Successful Backups - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_1",
         "app" : "Splunk_Security_Essentials"
      },
      "unusual_activity_time" : {
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "mitre_technique" : "|T1078",
         "description" : "Detects unusual activity time of day, or time of week by a user based on their normal access profile.",
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.0.0",
         "category" : "Insider Threat|Account Compromise|IAM Analytics",
         "mitre" : "",
         "domain" : "Other",
         "includeSSE" : "Yes",
         "name" : "Unusual Activity Time",
         "app" : "Splunk_User_Behavior_Analytics",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "mitre_tactic" : "|TA0003|TA0001",
         "journey" : "Stage_6",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Insider Threat|Security Monitoring|Compliance",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Authentication",
         "highlight" : "No",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other"
      },
      "detection_common_ransomware_extensions" : {
         "includeSSE" : "Yes",
         "name" : "Common Ransomware Extensions",
         "mitre" : "",
         "domain" : "Endpoint",
         "released" : "2.0.0",
         "category" : "Ransomware",
         "help" : "This search looks at file modifications across your hosts and identifies files with extensions that are commonly associated with the encrypted files generated by ransomware.",
         "description" : "The search looks for file modifications with extensions commonly used by Ransomware",
         "SPLEase" : "None",
         "mitre_technique" : "|T1074",
         "search_name" : "ESCU - Common Ransomware Extensions - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case",
         "relatedUseCases" : [],
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "|TA0009",
         "journey" : "Stage_3",
         "story" : "Ransomware",
         "app" : "Enterprise_Security_Content_Update"
      },
      "showcase_renamed_executables" : {
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1036",
         "description" : "<p>Oftentimes, attackers will execute a temporary file, and rename it to something innocuous (e.g. svchost.exe) to maintain persistence. This search will look for renamed executables. (<a href=\"https://car.mitre.org/wiki/CAR-2013-05-009\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>",
         "searchKeywords" : "",
         "killchain" : "Installation|Actions on Objective",
         "hasSearch" : "Yes",
         "mitre" : "Defense Evasion",
         "knownFP" : "<p>This search will look for any time an executable file is renamed, which should be rare but could occur during software installations. If you see false positives here, you should be able to filter out the noise by looking the final filename and filter out those instances. Generally, you should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).",
         "relevance" : "Often when we investigate malware, we look for filenames that have different hashes, but the same filenames. This could point to either a legitimate binary update activity, or it could be a malicious process masquerading as a legitimate one. But what about executables that have different filenames, but the same hash? This could be malware renaming itself to masquerade as something benign. In the example here, we see a .tmp file dumped into a roaming directory that later on gets renamed as a legitimate Windows executable - but it has the same hash as before. This warrants investigation.",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Find Processes with Renamed Executables",
         "howToImplement" : "Implementing this search is similar to any of the other searches that require EDR data. In order to use it, we need to get process launch events with the file hash information. For the demo and live version of this search we use Microsoft Sysmon with the CommandLine field, but you could adjust that to another data source and match the field names (extract filename, sha1 or change the field names to match that datasource).",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the system(s) with the matching hashes. Determine which system(s) are executing the renamed executables by observing the user, image and parent image values, amongst others. Contact the user and system owner and contact them regarding this action. If it is authorized, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine if executables have been loaded onto the system with common names.</p>",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launch logs (Event ID 4688), where we have hashing turned on (look for tools like WLS, or Sysmon to help here). It then looks for the number of filenames per system, per file hash, and surfaces files that have been renamed.</p>",
         "released" : "1.0.0",
         "category" : "Endpoint Compromise",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0005",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "examples" : [
            {
               "name" : "Find Processes with Renamed Executables - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Find Processes with Renamed Executables - Live"
            }
         ],
         "journey" : "Stage_3",
         "alertvolume" : "Low",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Find Processes with Renamed Executables - Demo"
      },
      "detection_malicious_powershell_process_connect_to_internet_with_hidden_window" : {
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Malicious PowerShell",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0002|TA0005",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "killchain" : "Command and Control|Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "search_name" : "ESCU - Malicious PowerShell Process - Connect To Internet With Hidden Window - Rule",
         "mitre_technique" : "T1086|T1064|T1143",
         "SPLEase" : "None",
         "description" : "This search looks for PowerShell processes started with parameters to modify the execution policy of the run, run in a hidden window, and connect to the Internet. This combination of command-line options is suspicious because it's overriding the default PowerShell execution policy, attempts to hide its activity from the user, and connects to the Internet.",
         "help" : "This search looks for PowerShell processes running with specific command-line arguments that indicate that the process will download a file from the Internet without display anything to the user. The search for \"*-Exec*\" is to check and see if the default execution policy for PowerShell is being overridden on the command-line. The search for \"*-WindowStyle*\" and \"*hidden*\" are to see if the window that would normally be displayed will be hidden from the user instead. Finally, the search for \"*New-Object*\" and \"*System.Net.WebClient*\" are there to check to see if a PowerShell object that can be used to download files will be created. This search will return the host, the user the process ran under, the process and it's command-line arguments, the number of times it's seen this process, and the first and last times it saw this process.",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "includeSSE" : "Yes",
         "name" : "Malicious PowerShell Process - Connect To Internet With Hidden Window"
      },
      "UC0101" : {
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Vendor-Specific Data",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "name" : "Newly Seen Scheduled Task Detected by Host",
         "includeSSE" : "No",
         "domain" : "Endpoint",
         "mitre" : "",
         "category" : "Privilege Escalation|Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "description" : "Detect attempts to gain persistence through newly seen/unauthorized scheduled tasks per host.",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : ""
      },
      "detection_sc_manipulating_services" : {
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0003|TA0004|TA0005",
         "journey" : "Stage_3",
         "story" : "Windows Service Abuse",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Installation",
         "description" : "This search looks for arguments to sc.exe indicating the creation or modification of a Windows service.",
         "SPLEase" : "None",
         "mitre_technique" : "T1050|T1031|T1089",
         "search_name" : "ESCU - Sc.exe Manipulating Windows Services - Rule",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "help" : "This search looks for the execution of sc.exe with parameters that indicate the utility is being used to create a new Windows service, or modify an existing one. Attackers often create a new service to host their malicious code, or they may take a non-critical service or one that is disabled, and modify it to point to their malware and enable the service if necessary. It is unusual for a service to be created or modified using the sc.exe utility.",
         "name" : "Sc.exe Manipulating Windows Services",
         "includeSSE" : "Yes",
         "mitre" : "Persistence|Privilege Escalation|Defense Evasion",
         "domain" : "Endpoint"
      },
      "suspicious_powershell_activity" : {
         "category" : "Lateral Movement|Endpoint Compromise",
         "released" : "2.2.0",
         "help" : "Help not needed -- UBA Use Case",
         "includeSSE" : "Yes",
         "name" : "Suspicious Powershell Activity",
         "mitre" : "",
         "domain" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Detects Powershell based attacks",
         "mitre_technique" : "|T1086",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "data_source_categories" : "VendorSpecific-winsec-powershell",
         "mitre_tactic" : "|TA0002",
         "journey" : "Stage_6",
         "app" : "Splunk_User_Behavior_Analytics",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "icon" : "UBA_Use_Case.png"
      },
      "sser_detect_log_clearing_with_wevtutil" : {
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/detect_log_clearing_wevtutil.png",
         "similarUseCases" : [
            "sser_windows_event_log_clearing_events",
            "detection_suspicious_wevtutil_usage",
            "detection_windows_event_log_cleared"
         ],
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Log Clearing With wevtutil - Demo",
         "alertvolume" : "Low",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "Log Clearing With wevtutil - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Log Clearing With wevtutil - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0005",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "howToImplement" : "This use case requires Sysmon to be installed on the endpoints you wish to monitor and the Sysmon add-on installed on your forwarders and search heads.",
         "operationalize" : "When this search fires, you will want to verify with the owner of the account responsible for clearing the Windows Logs that it was a legitimate action taken on their part.",
         "help" : "This use case looks for the wevutil process clearing the Windows Audit Logs",
         "category" : "Endpoint Compromise",
         "released" : "1.1.0",
         "domain" : "Endpoint",
         "knownFP" : "None at the moment",
         "mitre" : "Defense Evasion",
         "includeSSE" : "Yes",
         "name" : "Detect Log Clearing With wevtutil",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1070",
         "SPLEase" : "Basic",
         "description" : "<p>This use case looks for the wevutil process clearing the Windows Audit Logs</p><p><b>Alert Volume:</b> Low</p>"
      },
      "UC0049" : {
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "datasource" : "DNS",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Insider Threat",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "app" : "Splunk_Professional_Services",
         "includeSSE" : "No",
         "name" : "Detection of DNS Tunnel",
         "mitre" : "",
         "domain" : "Network",
         "released" : "2.0.0",
         "category" : "Data Exfiltration|Command and Control|Endpoint Compromise",
         "help" : "Help not needed -- PS Use Case",
         "description" : "Endpoint utilizing DNS as a method of transmission for data exfiltration, command and control, or evasion of security controls. Detected by large total size of DNS traffic OR large number of unique queries.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None"
      },
      "detection_clients_connecting_to_multiple_dns_servers" : {
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "datasource" : "DNS",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "story" : "DNS Hijacking",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS002DNS-ET01Query",
         "mitre_tactic" : "TA0011|TA0010",
         "journey" : "Stage_3",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "SPLEase" : "None",
         "mitre_technique" : "T1048|T1043|T1071",
         "search_name" : "ESCU - Clients Connecting to Multiple DNS Servers - Rule",
         "description" : "This search allows you to identify the endpoints that have connected to more than five DNS servers and made DNS Queries over the time frame of the search.",
         "searchKeywords" : "",
         "killchain" : "Command and Control",
         "hasSearch" : "No",
         "mitre" : "Command and Control|Exfiltration",
         "domain" : "Network",
         "name" : "Clients Connecting to Multiple DNS Servers",
         "includeSSE" : "Yes",
         "help" : "DNS Queries with multiple DNS servers from a single client is unusual and may be indicative of malicious activity. This search works by performing a count by the source of the distinct destinations for the DNS traffic. The search uses the <code>Network_Resolution</code> data model.",
         "category" : "Command and Control",
         "released" : "2.0.0"
      },
      "UC0015" : {
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_Professional_Services",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Insider Threat",
         "icon" : "PS_Use_Case.png",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Authentication",
         "highlight" : "No",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Insider Threat|Lateral Movement|Account Compromise",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Access",
         "name" : "Privileged User Accessing More Systems than Usual",
         "includeSSE" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "description" : "Privileged user authenticates to more than X number of new targets successfully or is denied access to more than Y targets in the prior Z hours."
      },
      "scanning_activity" : {
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "data_source_categories" : "DS010NetworkCommunication-ET01Traffic",
         "mitre_tactic" : "|TA0007",
         "journey" : "Stage_6",
         "app" : "Splunk_User_Behavior_Analytics",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "Network Communication",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "icon" : "UBA_Use_Case.png",
         "category" : "Lateral Movement",
         "released" : "2.2.0",
         "help" : "Help not needed -- UBA Use Case",
         "name" : "Scanning Activity",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Identifies devices correlated to suspicious vertical and horizontal scanning patters.",
         "mitre_technique" : "|T1046"
      },
      "showcase_first_logon_jump_server" : {
         "mitre" : "Lateral Movement",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p><p>You should not review these alerts directly (except for access to extremely sensitive system), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
         "domain" : "Access",
         "relevance" : "By monitoring and alerting on first time log ins to a jump server, you are able to detect if/when an adversary is able to escalate permissions or add new accounts to AD, or to endpoints directly. This should be a priority particularly for critical infrastructure, high-value and mission critical assets or those systems containing sensitive data. In addition to external adversary, this type of behavior can also be indicative of a potential insider threat issue, where an employee is probing their access, or potentially testing new accounts they may have created for malicious purposes.",
         "name" : "First Time Access to Jump Server for Peer Group",
         "includeSSE" : "Yes",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and validate the user account accessing the specific system. Determine who the system owner is and contact them. If it is authorized, document it as such and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted as a first time logon to a server that was never logged into before could suggest compromised credentials gaining access to other systems.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is an anonymized collection of Windows Logon events. For this analysis, we are effectively grouping by username and system name, which will give us a row for each username+systemname combination. We check if the first time that has occurred was in the last day, and if the hostname matches our designation for jump servers.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p><p>For the specific scenario of jump server detection, you will need a way to prioritize jump servers in your environment. For customers that have a standard naming scheme for jump servers, that is easy to implement. If instead you have a list of random hostnames that can be jump servers, it's generally easiest to put them into a lookup and then use a subsearch to bring them in (e.g., | tstats ... where [| inputlookup jumpservers | table Authentication.dest | format] ).</p><p>The final piece of implementing this is to build out a departmental peer group. Follow here for an example: (DVREMINDER -- ADD THIS IN).</p>",
         "released" : "2.2.0",
         "category" : "Lateral Movement|Insider Threat",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1078|T1076",
         "description" : "<p>Detect a user who is logging into a jump server that neither they nor any of their peers have accessed before.</p>",
         "searchKeywords" : "",
         "killchain" : "Installation|Actions on Objective",
         "hasSearch" : "Yes",
         "alertvolume" : "High",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/showcase_first_logon_jump_server.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=First Log On to Jump Server - Peer Group - Demo",
         "usecase" : "Insider Threat|Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "datasource" : "Authentication|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0008|TA0001",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-winsec",
         "journey" : "Stage_4",
         "examples" : [
            {
               "label" : "Demo Data (No Peer Group)",
               "name" : "First Log On to Jump Server - Demo"
            },
            {
               "name" : "First Log On to Jump Server - Live",
               "label" : "Live Data (No Peer Group)"
            },
            {
               "label" : "Accelerated Data (No Peer Group)",
               "name" : "First Log On to Jump Server - Accelerated"
            },
            {
               "label" : "Demo Data (With Peer Group)",
               "name" : "First Log On to Jump Server - Peer Group - Demo"
            },
            {
               "label" : "Live Data (With Peer Group)",
               "name" : "First Log On to Jump Server - Peer Group - Live"
            },
            {
               "label" : "Accelerated Data (With Peer Group)",
               "name" : "First Log On to Jump Server - Peer Group - Accelerated"
            }
         ]
      },
      "detection_attrib_to_hide_files" : {
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "help" : "This search is looking to detect command-line execution with of attrib.exe binary with the +h flag set.  The +h flag is used to hide a file.",
         "name" : "Hiding Files And Directories With Attrib.exe",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion|Persistence",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "Attackers leverage an existing Windows binary, attrib.exe, to mark specific as hidden by using specific flags so that the victim does not see the file.  The search looks for specific command-line arguments to detect the use of attrib.exe to hide files.",
         "mitre_technique" : "|T1158",
         "search_name" : "ESCU - Hiding Files And Directories With Attrib.exe - Rule",
         "SPLEase" : "None",
         "relatedUseCases" : [],
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0005|TA0003",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Windows Persistence Techniques",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection"
      },
      "UC0087" : {
         "includeSSE" : "No",
         "name" : "Malware signature not updated by SLA for compliance asset",
         "mitre" : "",
         "domain" : "Endpoint",
         "released" : "2.0.0",
         "category" : "Compliance|Operations",
         "help" : "Help not needed -- PS Use Case",
         "description" : "Malware signature last updated on a asset designated as compliance such as PCI, CIP or HIPAA beyond SLA limits.  SLA in this use case refers to policy levels more than the traditional service level agreement. ",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Anti-Virus",
         "highlight" : "No",
         "usecase" : "Security Monitoring|Compliance",
         "icon" : "PS_Use_Case.png",
         "mitre_tactic" : "",
         "journey" : "Stage_4",
         "app" : "Splunk_Professional_Services"
      },
      "first_call_to_foreign_country" : {
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "",
         "examples" : [
            {
               "name" : " - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : " - Live",
               "label" : "Live Data"
            },
            {
               "label" : "Accelerated Data",
               "name" : " - Accelerated"
            }
         ],
         "journey" : "Stage_2",
         "usecase" : "Insider Threat|Compliance",
         "icon" : "Core_Use_Case.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Other",
         "highlight" : "No",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/first_call_to_foreign_country.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset= - Demo",
         "alertvolume" : "High",
         "searchKeywords" : "",
         "killchain" : "",
         "hasSearch" : "Yes",
         "SPLEase" : "Medium",
         "mitre_technique" : "",
         "description" : "<p>Detect when a user who has never called a foreign country before starts making international calls, to meet HR, Finance, or Regulatory requirements.</p>",
         "operationalize" : "<p>The rules for this will be highly dependent on your organizational policy dictated by legal, HR, or Finance. Consult the appropriate teams to build next steps before implementing.</p>",
         "howToImplement" : "<p>There are a few components to implementing this detection -- handling your CDR logs correctly, and then resolving those calls to external countries.</p>",
         "help" : "<p>This example leverages the  search assistant. Our dataset is an anonymized collection of . For this analysis, we are .</p>",
         "category" : "Insider Threat|Compliance",
         "released" : "2.2.0",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p>",
         "mitre" : "",
         "domain" : "Audit",
         "relevance" : "<p>Whether guided by HR concerns, phone cost concerns, or regulatory requirements, many organizations want to track when users start making international phone calls. Fortunately, that's easy to do in Splunk.</p>",
         "includeSSE" : "Yes",
         "name" : "First Call to Foreign Country"
      },
      "UC0018" : {
         "includeSSE" : "No",
         "name" : "Unauthorized access SSO brute force",
         "domain" : "Access",
         "mitre" : "",
         "category" : "Scanning|Account Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "description" : "Single IP address attempting authentication of more than two valid users within ten minutes where one or more unique accounts is successful, and one or more accounts is not successful against an approved SSO System.",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Authentication",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services"
      },
      "detection_aws_spike_acl_activity" : {
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS",
         "help" : "This search and its corresponding subsearch run through the following series of steps: <ol><li>Retrieve all the AWS CloudTrail log entries that have recorded AWS API calls specifically for creating/modifying/replacing network Access Control Lists (ACLs).</li><li>Kick off a subsearch that retrieves the same data and pulls out the ARN into a more friendly format.</li><li>Count the number of API calls per Amazon Resource Name (ARN).</li><li>Load the cache file that contains the number of data points, the count from the latest hour, the API call average, and the standard deviation for each ARN.</li><li>Drop the count from the latest hour, since it is not necessary, and merge the rest of the data with the results of the stats command. </li><li>Rename <code>apiCalls</code> as <code>latestCount</code>.</li><li>Calculate the new average value for each ARN with the latest count, weighting the past much more heavily than the current hour. They do the same for the standard deviation--weighting the past more heavily than the current.</li><li>Update the cache file with the latest results.</li><li>Set the minimum threshold for the number of data points and set the number of standard deviations away from the mean it must be to be considered a spike.</li><li>Make a determination regarding whether or not the current count is a spike by checking to see if the minimum data-point threshold has been met and the count is a sufficient number of standard deviations away from the average.</li><li>Filter out anything that it determines is not a spike and return the list of ARNs to the main search. </li></ol>The main search subsequently gets the names of all the API calls, the number of unique API calls, and the total number of API calls for each of these ARNs. Finally, it looks up the average and standard deviation and returns both the average and the number of standard deviations the spike is from the average.",
         "includeSSE" : "Yes",
         "name" : "Detect Spike in Network ACL Activity",
         "domain" : "Network",
         "mitre" : "Persistence|Exfiltration",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "This search will detect users creating spikes in API activity related to network access-control lists (ACLs)in your AWS environment.",
         "mitre_technique" : "",
         "search_name" : "ESCU - Detect Spike in Network ACL Activity - Rule",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0003|TA0010",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS Network ACL Activity",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection"
      },
      "detection_cscript_via_cmd" : {
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0002",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious Command-Line Executions",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "description" : "This search looks for the execution of the cscript.exe or wscript.exe processes, with a parent of cmd.exe. The search will return the count, the first and last time this execution was seen on a machine, the user, and the destination of the machine",
         "search_name" : "ESCU - Detect Use of cmd.exe to Launch Script Interpreters - Rule",
         "mitre_technique" : "T1059|T1064",
         "SPLEase" : "None",
         "hasSearch" : "No",
         "killchain" : "Exploitation",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Detect Use of cmd.exe to Launch Script Interpreters",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Attackers often leverage various scripting languages to execute their attacks. In a Windows environment, the Windows Script Host is the tool that interprets the scripts and is included in all modern versions of Windows. The Windows Script Host is available as a command-line tool called \"cscript.exe\" or \"wscript.exe.\" To detect this behavior, the search looks for process-creation events for cscript.exe or wscript.exe with a parent process of cmd.exe. The search will return the count, the first and last times this behavior was seen on a destination machine, and user and process information."
      },
      "Large_Web_Upload" : {
         "mitre_tactic" : "TA0010",
         "data_source_categories" : "DS005WebProxyRequest-ET01Requested",
         "examples" : [
            {
               "name" : "Large Web Upload - Demo",
               "label" : "Demo Data"
            },
            {
               "label" : "Live Data",
               "name" : "Large Web Upload - Live"
            },
            {
               "name" : "Large Web Upload - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_1",
         "app" : "Splunk_Security_Essentials",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Web Proxy",
         "highlight" : "Yes",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring|Insider Threat",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Large Web Upload - Demo",
         "relatedUseCases" : [
            "sser_tor_traffic",
            "showcase_huge_volume_dns_volume",
            "detection_long_dns_text_response"
         ],
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/large_web_upload.png",
         "alertvolume" : "Medium",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "description" : "Uses a basic threshold to detect a large web upload, which could be exfiltration from malware or a malicious insider.",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1041|T1048",
         "category" : "Data Exfiltration",
         "released" : "2.0.0",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Palo Alto Networks proxy logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Palo Alto Networks or the Common Information Model.",
         "operationalize" : "When this fires, it will usually do so for perfectly legitimate reasons (uploading vacation photos, etc.). When this fires, many analysts will look where the data was sent to, whether the user has uploaded data to that site before. Often analysts will call the user to confirm the activity, preferably with the knowledge of that employee's status in the organization (e.g., are they on a performance plan or reaching the end of a contract, where they would be at greater risk of data exfiltration). If you have SSL Inspection turned on via your NGFW or DLP for that site, you can sometimes see the actual files that were transferred, which can help provide context.",
         "howToImplement" : "This search should work immediately for any Palo Alto Networks environment, and can be easily adapted to apply to any other source of proxy visibility (dedicated proxies, along with network visibility tools such as Splunk Stream or bro). Just adjust the sourcetype and fields to match, and you will be good to go.",
         "includeSSE" : "Yes",
         "name" : "Large Web Upload",
         "knownFP" : "By definition, this search is very simple and will fire for many innocent occurrences (uploading vacation photos, etc.). Many organizations will try to filter this down by focusing on users who are on a watchlist either because they have access to sensitive data (execs, scientists, etc.) or because of employment reasons (performance plan, notice given, contract ending, etc.). These watchlists can be implemented by using lookups.",
         "mitre" : "Exfiltration",
         "relevance" : "Data Exfiltration usually occurs over standard channels these days, with insiders uploading data to Google, Dropbox, Box, smaller file sharing sites, or even unlisted drop sites. Because HTTPS is always allowed out, exfiltration becomes relatively easy in most organizations. Detect those big transfers!",
         "domain" : "Network"
      },
      "detection_spike_aws_security_group_activity" : {
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_3",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0006|TA0002",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "AWS User Monitoring",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "mitre_notes" : "MITRE ATT&CK enterprise does not have good cataloging of cloud based activity.",
         "description" : "This search will detect users creating spikes in API activity related to security groups in your AWS environment.  It will also update the cache file that factors in the latest data.",
         "search_name" : "ESCU - Detect Spike in Security Group Activity - Rule",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "name" : "Detect Spike in Security Group Activity",
         "includeSSE" : "Yes",
         "domain" : "Network",
         "mitre" : "Credential Access|Execution",
         "category" : "Cloud Security|SaaS",
         "released" : "2.2.0",
         "help" : "This search and its corresponding subsearch run through the following series of steps: <ol><li>Retrieves all the AWS CloudTrail log entries that have recorded AWS API calls specifically for security groups.</li><li>Kicks off a subsearch that retrieves the same data and pulls out the ARN into a more friendly format.</li><li>Counts the number of API calls per ARN.</li><li>Loads the cache file that contains the number of data points, the count from the latest hour, the API call average, and the standard deviation for each ARN.</li><li>Drops the count from the latest hour, since it is not necessary, and merges the rest of the data with the results of the stats command. </li><li>Renames <code>apiCalls</code> as <code>latestCount</code>.</li><li>Calculates the new average value for each ARN with the latest count, weighting the past much more heavily than the current hour. It does the same for the standard deviation--weighting the past more heavily than the current.</li><li>Updates the cache file with the latest results.</li><li>Sets the minimum threshold for the number of data points and sets the number of standard deviations away from the mean it must be to be considered a spike.</li><li>Makes a determination regarding whether or not the current count is a spike by checking to see if the minimum data-point threshold has been met and the count is a sufficient number of standard deviations away from the average.</li><li>Filters out anything that it determines is not a spike and returns the list of ARNs to the main search. </li></ol>The main search subsequently gets the names of all the API calls, the number of unique API calls, and the total number of API calls for each of these ARNs. Finally, it looks up the average and standard deviation and returns both the average and the number of standard deviations the spike is from the average."
      },
      "showcase_new_path_for_common_filename" : {
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Installation|Actions on Objective",
         "description" : "<p>Simpler malware will hide in plain sight with a filename like explorer.exe, running in the user profile. This detection will look for new paths, for common / expected executables. (<a href=\"https://car.mitre.org/wiki/CAR-2013-05-002\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Very Low (for most companies)</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1036",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the system demonstrating this behavior. Determine the time, process and parent process that is being executed and by what account on the system. Contact the user and system owner to determine if it is authorized, and make a note that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted to determine why an executable is starting from a path not previously executed from.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is a anonymized collection of process launch events (Event ID 4688) filtered for known good filenames, running from atypical directories. We find the first time that filename has launched from that path, and then alert if that was in the last day.</p>",
         "includeSSE" : "Yes",
         "name" : "Common Filename Launched from New Path",
         "mitre" : "Defense Evasion",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This search should almost never fire, except for suspicious events, as it's virtually guaranteed that any events firing are specifically trying to deceive the operator.</p>",
         "domain" : "Endpoint",
         "relevance" : "There are certain processes that everyone expects to see running on their Windows hosts, like iexplore.exe or svchost.exe. But they’re supposed to run from very specific places. This fairly simple search looks to find when legitimate looking filenames are found running, but out of unusual paths never seen before.",
         "mitre_tactic" : "TA0005",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch|VendorSpecific-winsec",
         "journey" : "Stage_3",
         "examples" : [
            {
               "name" : "New Paths for Common Executables - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "New Paths for Common Executables - Live",
               "label" : "Live Data"
            }
         ],
         "app" : "Splunk_Security_Essentials",
         "datasource" : "Endpoint Detection and Response|Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Paths for Common Executables - Demo",
         "alertvolume" : "Very Low"
      },
      "detection_suspicious_java_classes" : {
         "journey" : "Stage_3",
         "data_source_categories" : "DS014WebServer-ET01Access",
         "mitre_tactic" : "TA0002|TA0011",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Apache Struts Vulnerability",
         "highlight" : "No",
         "datasource" : "Web Server",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "hasSearch" : "No",
         "killchain" : "Exploitation",
         "description" : "This search looks for suspicious Java classes that are often used to exploit remote command execution in common Java frameworks, such as Apache Struts.",
         "mitre_technique" : "|T1203|T1219",
         "category" : "Vulnerability|",
         "released" : "2.2.0",
         "help" : "The search leverages HTTP form data from typically POST events that can be captured with Splunk streams or similar wire data capture tools. The search looks for java classes like `processbuilder` and `runtime` are used to create a new process and execute commands inside java, and are synonymous with spawning a shell. There are very exceptional reasons to ever these classes in Java via an HTTP API and hence when seen are highly suspicious. Also, this is a common vectors leverage to exploit Apache Struts.",
         "includeSSE" : "Yes",
         "name" : "Suspicious Java Classes",
         "domain" : "Threat",
         "mitre" : "Execution",
         "incluseSSE" : "No"
      },
      "detection_users_without_mfa" : {
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS",
         "help" : " In this search, we query CloudTrail logs and specifically look for events where the multi factor authentication context of the user's session is false which basically means, that the user does not have MFA enabled on AWS. We then filter out all the known AWS service accounts since service accounts typically do not have MFA enabled. The search then creates a table of the first and last time a user without MFA was detected, the values and count of the API calls made, the type of user identity, ARN and the name of the user.",
         "name" : "Detect API activity from users without MFA",
         "includeSSE" : "Yes",
         "mitre" : "Execution",
         "domain" : "Network",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "",
         "description" : "This search looks for CloudTrail events where a user logged into the AWS account, is making API calls and has not enabled Multi Factor authentication. Multi factor authentication adds a layer of security by forcing the users to type a unique authentication code from an approved authentication device when they access AWS websites or services. AWS Best Practices recommend that you enable MFA for privileged IAM users.",
         "search_name" : "ESCU - Detect API activity from users without MFA - Rule",
         "mitre_technique" : "",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0002",
         "journey" : "Stage_3",
         "story" : "AWS User Monitoring",
         "app" : "Enterprise_Security_Content_Update",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png"
      },
      "vulnerability_scanner_detected_by_targets" : {
         "mitre_tactic" : "|TA0007",
         "data_source_categories" : "DS012NetworkIntrusionDetection-ET01SigDetection",
         "journey" : "Stage_4",
         "app" : "Splunk_App_for_Enterprise_Security",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "IDS or IPS",
         "highlight" : "Yes",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "dashboard" : "ES_Use_Case",
         "similarUseCases" : [
            "Basic_Scanning",
            "showcase_network_dc_dest",
            "vulnerability_scanner_detected_by_events"
         ],
         "alertvolume" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "Detects a potential vulnerability scanner by detecting devices that have triggered events against a large number of unique targets. Vulnerability scanners generally trigger events against a high number of unique hosts when they are scanning a network for vulnerable hosts.",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1046",
         "search_name" : "Network - Vulnerability Scanner Detection (by targets) - Rule",
         "category" : "Scanning",
         "released" : "2.0.0",
         "help" : "Help not needed -- ES Use Case",
         "name" : "Vulnerability Scanner Detected (by targets)",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Network"
      },
      "detection_brand_abuse_dns" : {
         "datasource" : "DNS",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "|TA0022",
         "data_source_categories" : "DS002DNS-ET01QueryRequest",
         "journey" : "Stage_3",
         "story" : "Brand Monitoring",
         "app" : "Enterprise_Security_Content_Update",
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case",
         "description" : "This search looks for DNS requests for faux domains similar to the domains that you want to have monitored for abuse.",
         "SPLEase" : "None",
         "search_name" : "ESCU - Monitor DNS For Brand Abuse - Rule",
         "mitre_technique" : "|T1328",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Delivery|Actions on Objective",
         "includeSSE" : "Yes",
         "name" : "Monitor DNS For Brand Abuse",
         "mitre" : "",
         "domain" : "Network",
         "category" : "Operations",
         "released" : "2.0.0",
         "help" : "This search gathers all the answers to each system's DNS query, then filters out all queries that do not appear on the list of faux \"look-a-like\" domains that have been generated from the brand abuse domains you are monitoring."
      },
      "detection_sncd_processes" : {
         "description" : "This search looks for fast execution of processes used for system network configuration discovery on the endpoint.",
         "mitre_technique" : "|T1016",
         "hasSearch" : "No",
         "killchain" : "Installation|Command and Control|Actions on Objective",
         "name" : "Detect processes used for System Network Configuration Discovery",
         "includeSSE" : "Yes",
         "incluseSSE" : "No",
         "mitre" : "Execution",
         "domain" : "Endpoint",
         "category" : "Malware|",
         "released" : "2.2.0",
         "help" : "Attackers have a range of built-in Windows tools they leverage to ascertain the topography of a network from the point of view of a compromised machine. It is uncommon to see these commands execute quickly within short periods of time. This search returns the number of times, as well as the first time and last times, that every process has run for each endpoint. It then executes the macro <code>system_network_configuration_discovery_tools</code>, which looks for processes that are typically used for network configuration discovery. Once you have a list of suspicious process launches for each destination, you can leverage the transaction command to see what processes are fired within a five-minute span on an endpoint and detect only those events where the count of these processes is greater than five.",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "TA0007",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "journey" : "Stage_3",
         "story" : "Unusual Processes",
         "app" : "Enterprise_Security_Content_Update",
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case"
      },
      "Basic_Expired_Account" : {
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/successful_login_former_employee.png",
         "similarUseCases" : [
            "activity_from_expired_user_identity",
            "UC0014"
         ],
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Basic Expired Account - Demo",
         "alertvolume" : "Low",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "Basic Expired Account - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Basic Expired Account - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_4",
         "mitre_tactic" : "TA0004|TA0006",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-winsec",
         "usecase" : "Security Monitoring|Insider Threat",
         "icon" : "Core_Use_Case.png",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Authentication|Vendor-Specific Data",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Windows Authentication logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standard sourcetypes.",
         "operationalize" : "The first thing to understand after this alert fires is whether this was some continuation of normal system operations (e.g., the desktop under their desk was still logged in, or iPhone account still active) versus a deliberate action. Obviously success or failure also carries weight. Finally, particularly for sysadmin type employees in less structured organizations, it's important to make sure that there are no services or scheduled jobs running under that account where disabling the account outright might impact operations.",
         "howToImplement" : "If you have followed the data onboarding guides in this app, this search will work immediately for you. You should generally specify the index where you are storing Windows Security logs (e.g., index=oswinsec), and if you use a mechanism other than the Splunk Universal Forwarder to onboard that data, you should verify the sourcetype and fields that are used. The rest is simple!",
         "category" : "Account Compromise|Insider Threat",
         "released" : "2.0.0",
         "domain" : "Access",
         "relevance" : "Users who have left your organization should generally not be logging in. It could mean that their credentials were compromised earlier, or it could mean that they are trying to log in to take some inappropriate actions. Either way, this is something you want to detect.",
         "knownFP" : "If your organization doesn't actually disable or remove accounts, then this search may not be actionable. If this is you, consider creating some boundaries around this behavior by specifying systems that \"acceptable\" post-termination activity can be expected on, such as the email environment. Also put a detective control in place to ensure that passwords are changed when an employee goes from active to not, and try to limit the usage of accounts after the employee leaves.",
         "mitre" : "Privilege Escalation|Credential Access",
         "includeSSE" : "Yes",
         "name" : "Successful Login of Account for Former Employee",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1078|T1098",
         "SPLEase" : "Basic",
         "description" : "You shouldn't see any successful authentication activity on the accounts of former employees. Track this easily in Splunk."
      },
      "showcase_short_lived_accounts" : {
         "journey" : "Stage_1",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Short Lived Accounts - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Short Lived Accounts - Live"
            },
            {
               "label" : "Accelerated Data",
               "name" : "Short Lived Accounts - Accelerated"
            }
         ],
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0005|TA0003",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "similarUseCases" : [
            "showcase_new_local_admin_account"
         ],
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Short Lived Accounts - Demo",
         "alertvolume" : "Low",
         "hasSearch" : "Yes",
         "killchain" : "Command and Control",
         "searchKeywords" : "",
         "description" : "<p>A technique used by attackers is to create an account, take some actions, and then delete it right away. This search will find those accounts on the local system.</p><p><b>Alert Volume:</b> Low</p>",
         "mitre_technique" : "|T1136|TA0005",
         "SPLEase" : "Medium",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows security logs for user creation and user deletion. We filter for that, and then use the transaction command to group a create and delete in a short period of time. Anything that matches, we will surface. </p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the creation and deletion events, as well as the user accounts that created the account and the account name itself, the system that initiated the request and other pertinent information. Contact the owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials have been used by another party and additional investigation is warranted.</p>",
         "howToImplement" : "This search relies on the standard Windows Security events coming from a Windows Forwarder on a workstation or member server (so: not domain controllers). Implementation is as easy as just ingesting that data, specifying the correct index, and then running the search. If you are using a log source other than the Splunk TA for Windows (e.g., snare, WMI, etc.), you might need to adjust field names to match those in the search itself.",
         "name" : "Short Lived Admin Accounts",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion|Persistence",
         "knownFP" : "<p>The biggest potential false positive from this detection is that technically it will fire for any account creation, not just admin accounts. It's difficult to put sufficient logic into a single search to detect admin accounts while also detecting short lived accounts (though it may be possible to combine with the new admin account detection in this app), and wasn't a big priority given how rare short lived accounts are in general.</p><p>Beyond that, there are no known sources of false positives for this search.</p>"
      },
      "detection_email_attachments_with_spaces" : {
         "includeSSE" : "Yes",
         "name" : "Email Attachments With Lots Of Spaces",
         "mitre" : "",
         "domain" : "Network",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "This search looks at any emails with file attachment names that contain many spaces relative to the length of the file name. Specifically, it checks if spaces make up more than 10% of the number of characters in the file name. This percentage can be tuned for each environment. The search will then output the message ID of the email, the count, the recipient address and the recipient user, first and last time this event was seen and the space ratio of the file attachment name.",
         "description" : "Attackers often use spaces as a means to obfuscate an attachment's file extension. This search looks for messages with email attachments that have many spaces within the filename.",
         "SPLEase" : "None",
         "mitre_technique" : "|T1193",
         "search_name" : "ESCU - Email Attachments With Lots Of Spaces - Rule",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Delivery",
         "alertvolume" : "Low",
         "dashboard" : "ESCU_Use_Case",
         "relatedUseCases" : [
            "showcase_external_emails_with_internal_domain",
            "showcase_spike_in_outgoing_email",
            "high_volume_email_activity_to_noncorporate_domains_by_user",
            "detection_suspicious_email_attachments",
            "UC0004"
         ],
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Email",
         "highlight" : "Yes",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "data_source_categories" : "DS001MAIL-ET02Receive",
         "mitre_tactic" : "|TA0001",
         "journey" : "Stage_3",
         "story" : "Suspicious Emails",
         "app" : "Enterprise_Security_Content_Update"
      },
      "showcase_hosts_where_sourcetypes_go_silent" : {
         "description" : "<p>A frequent concern of SOCs is that their data feeds will disappear. This search will look on a host-by-host basis for when your security sources stop reporting home.</p><p><b>Alert Volume:</b> Medium</p>",
         "mitre_technique" : "|T1089",
         "SPLEase" : "Advanced",
         "hasSearch" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Hosts Where Security Sources Go Quiet",
         "domain" : "Endpoint",
         "knownFP" : "<p>This alert could generate false positives depending on how noisy the security log sources in your environment are. For example, if you are looking for AV to be disabled, but you typically only get an AV message every few days, this would be difficult to reliably search for. Checking for the silence of sparse data sources is tricky to implement, and should only be attempted for advanced SPL users.</p> ",
         "mitre" : "Defense Evasion",
         "category" : "Endpoint Compromise",
         "released" : "1.2.0",
         "operationalize" : "<p>When this search returns values, capture the time of the event and the sourcetype that is missing. Contact the system owner. If it is known behavior, document this as well as when it is expected to be resolved. If not, further investigation is warranted to determine if the collection capability was modified, stopped, deleted or compromised.</p>",
         "help" : "<p>This example leverages the Simple Search assistant. Here we are looking through all Splunk logs for hosts that are sending logs, but not sending Windows Security logs. We track that percentage over time, and look to see how many instances where the percentage = 0 (no Windows Logs) in the past we've seen, and whether yesterday the percentage was zero.</p>",
         "howToImplement" : "This search should work universally on all Splunk environments, since it uses Splunk internal fields. The only implementation detail to be aware of is specifying the index and sourcetype for the security events you care about.",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "usecase" : "Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "journey" : "Stage_1",
         "examples" : [
            {
               "label" : "Live Data (Auto Accelerated)",
               "name" : "Hosts That Stop Reporting Sourcetypes - Live"
            }
         ],
         "mitre_tactic" : "TA0005",
         "data_source_categories" : "VendorSpecific-AnySplunk",
         "app" : "Splunk_Security_Essentials",
         "alertvolume" : "Medium",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Hosts That Stop Reporting Sourcetypes - Live"
      },
      "showcase_increase_in_runas" : {
         "alertvolume" : "Low",
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Increase in Windows Privilege Escalation - Demo",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring",
         "mitre_tactic" : "TA0004",
         "data_source_categories" : "VendorSpecific-winsec",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Increase in Windows Privilege Escalation - Demo"
            },
            {
               "name" : "Increase in Windows Privilege Escalation - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_1",
         "app" : "Splunk_Security_Essentials",
         "includeSSE" : "Yes",
         "name" : "Increase in Windows Privilege Escalations",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
         "mitre" : "Privilege Escalation",
         "domain" : "Access",
         "relevance" : "Building upon the simpler example of reporting against 4648 events, this example tracks the privileged executions on a per-credential basis. It may be perfectly normal for a certain amount of privileged executions to happen from a given account, but when these spike against a certain account, this may be an indicator of account compromise.",
         "category" : "Account Compromise",
         "released" : "1.0.0",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of the creation, as well as the user account and system, credentials that were used, process executed and other pertinent information. Contact the owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of Windows logon with explicit credentials events (Event ID 4648, as you would see with RunAs). For this analysis, we are tracking the number of times the originating (unprivileged) user initiates an authentication with explicit credentials. Then we calculate the average, standard deviation, and the most recent value, and filter out any users where the most recent is within the configurable number of standard deviations from average. Notably, it might be more useful here to track the privileged account, for different use cases -- that's easy to do, just switch the dropdown from Unprivileged to Privileged. If you have a strong background and opinion on which is relevant in what scenarios, let us know so that we can improve this content for everyone.</p>",
         "description" : "<p>Privilege escalation (either via RunAs or Scheduled Tasks) create Windows Security EventID 4648 events. This search will baseline per (original, unprivileged) user and then track deviations.</p><p><b>Alert Volume:</b> Low</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1053|T1134",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Installation"
      },
      "gdpr_investigation" : {
         "alertvolume" : "Other",
         "mitre_notes" : "Not an attacker technique",
         "dashboard" : "gdpr_investigation?load=1",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Anti-Virus|Application Logs|Authentication|Endpoint Detection and Response|Network Communication|Web Proxy",
         "highlight" : "Yes",
         "usecase" : "Compliance",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "",
         "data_source_categories" : "DS004EndPointAntiMalware-ET01SigDetected|DS004EndPointAntiMalware-ET02UpdatedSig|DS034ApplicationLogs-ET01General|DS003Authentication-ET01Success|DS003Authentication-ET02Failure|DS009EndPointIntel-ET01ObjectChange|DS009EndPointIntel-ET01ProcessLaunch|DS010NetworkCommunication-ET01Traffic|DS005WebProxyRequest-ET01Requested",
         "journey" : "Stage_2",
         "app" : "Splunk_App_for_Enterprise_Security",
         "includeSSE" : "Yes",
         "name" : "Investigate GDPR Breaches Using ES",
         "mitre" : "",
         "domain" : "Data",
         "released" : "2.1.0",
         "category" : "GDPR",
         "help" : "Help not needed -- ES Use Case",
         "description" : "Meeting your compliance requirements necessitates being able to investigate breaches. Splunk ES provides you a single place to fully understand attacker activities.",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : ""
      },
      "anomalous_audit_trail_activity_detected" : {
         "app" : "Splunk_App_for_Enterprise_Security",
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "|TA0005",
         "journey" : "Stage_2",
         "usecase" : "Security Monitoring|Insider Threat",
         "icon" : "ES_Use_Case.png",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Vendor-Specific Data",
         "highlight" : "No",
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1070|T1146|T1107",
         "search_name" : "Audit - Anomalous Audit Trail Activity Detected - Rule",
         "description" : "Discovers anomalous activity such as the deletion of or clearing of log files. Attackers oftentimes clear the log files in order to hide their actions, therefore, this may indicate that the system has been compromised.",
         "help" : "Help not needed -- ES Use Case",
         "category" : "Endpoint Compromise|Insider Threat",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Audit",
         "includeSSE" : "Yes",
         "name" : "Anomalous Audit Trail Activity Detected"
      },
      "Update_Service" : {
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/disabled_update_service.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=Update Service - Demo",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0005",
         "journey" : "Stage_1",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Update Service - Demo"
            },
            {
               "name" : "Update Service - Live",
               "label" : "Live Data"
            }
         ],
         "mitre" : "Defense Evasion",
         "knownFP" : "No known false positives at this time.",
         "domain" : "Endpoint",
         "relevance" : "It is not uncommon for malware to somehow hamstring the Windows Update service, so that Microsoft can't push out fixes to patches, or push out their periodic malware removal tools. Regardless, finding hosts that aren't receiving updates should always be a big priority, as they leave you literally vulnerable.",
         "includeSSE" : "Yes",
         "name" : "Disabled Update Service",
         "operationalize" : "When Windows Update is disabled, the immediate question is why. Ask the user if they disabled it, look for software installations that might have done it, or look for any errors related to the Windows Update Service (wuauserv.exe).",
         "howToImplement" : "If you are using the Windows Forwarder with the WinHostMon://Service input configured, this search should work automatically. If you're using another source to detect Service status, you may need to adjust the search string to match your data source.",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Windows Service logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standard sourcetypes.",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "SPLEase" : "Basic",
         "mitre_technique" : "|T1089",
         "description" : "Splunk can detect the status of services, allowing us to find hosts where the Windows Update service is disabled.",
         "searchKeywords" : "",
         "killchain" : "",
         "hasSearch" : "Yes"
      },
      "detection_schtasks_forced_reboot" : {
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No",
         "SPLEase" : "None",
         "search_name" : "ESCU - Schtasks used for forcing a reboot - Rule",
         "mitre_technique" : "T1053",
         "description" : "This search looks for flags passed to schtasks.exe on the command-line that indicate that a forced reboot of system is scheduled.",
         "help" : "The search looks for execution of schtasks.exe with parameters that indicate a task is being scheduled that would cause a forced reboot on the host. Schtasks.exe is a native windows program that is used to schedule tasks on local or remote systems. Attackers often leverage this capability to schedule the execution of commands or establish persistence. This tactic is leveraged by the Bad Rabbit Ransomware.",
         "released" : "2.0.0",
         "category" : "Ransomware",
         "mitre" : "Persistence|Execution",
         "domain" : "Endpoint",
         "includeSSE" : "Yes",
         "name" : "Schtasks used for forcing a reboot",
         "story" : "Ransomware",
         "app" : "Enterprise_Security_Content_Update",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0003|TA0002",
         "journey" : "Stage_3",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "unauthorized_foreign_country_call" : {
         "killchain" : "",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "",
         "SPLEase" : "Medium",
         "description" : "<p>Tracking unauthorized users who are call foreign countries is very important to organizations subject to certain rules. Find those users with Splunk.</p>",
         "help" : "<p>This example leverages the first time seen search assistant. Our dataset is an anonymized collection of phone records, that we will filter for just the phone ranges that belong to our competitors.</p>",
         "operationalize" : "<p>Responding to this will depend on the requirements of your organization. This detection will only be implemented by organizations that have specific rules regulating external calls, so your next steps will be dictated by the regulations implemented on your organization.</p>",
         "howToImplement" : "<p>There are a few components to implementing this detection -- handling your CDR logs correctly, then resolving those calls to external countries, and maintaining an accurate list of the users who are permitted to call external countries.</p>",
         "released" : "2.2.0",
         "category" : "Compliance",
         "domain" : "Audit",
         "relevance" : "<p>Foreign Contacts Reporting is required by some organizations -- fulfill your regulatory requirements with Splunk.</p>",
         "knownFP" : "<p>The most common scenarios for false positives in this search relate to the three steps in implementing the search itself -- that phone logs formats are absolutely filled with corner cases, and that resolution of an external phone number to the country is a complicated process. Even maintaining the list of users who are permitted to call externally can be organizationally complicated.</p>",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "Unauthorized Call to Foreign Country",
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : " - Demo"
            },
            {
               "name" : " - Live",
               "label" : "Live Data"
            },
            {
               "label" : "Accelerated Data",
               "name" : " - Accelerated"
            }
         ],
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "usecase" : "Compliance",
         "icon" : "Core_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Other",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/unauthorized_foreign_country_call.png",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset= - Demo",
         "alertvolume" : "Low"
      },
      "showcase_first_git" : {
         "alertvolume" : "High",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=Accessing New Git Repositories - Demo",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Web Server",
         "highlight" : "Yes",
         "usecase" : "Insider Threat|Advanced Threat Detection",
         "icon" : "Core_Use_Case.png",
         "data_source_categories" : "DS014WebServer-ET03SourceCode",
         "mitre_tactic" : "TA0009",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Accessing New Git Repositories - Demo"
            },
            {
               "name" : "Accessing New Git Repositories - Live",
               "label" : "Live Data"
            },
            {
               "name" : "Accessing New Git Repositories - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_3",
         "app" : "Splunk_Security_Essentials",
         "name" : "First Time Accessing an Internal Git Repository",
         "includeSSE" : "Yes",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for access to extremely sensitive repositories), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
         "mitre" : "Collection",
         "domain" : "Data",
         "relevance" : "This is an insider threat use case. Your developers are often granted access to the Git (or other software life cycle repository) that their responsibilities require, but one condition to be aware of is the first time a user accesses a given repository. This could be perfectly normal, or if the repository contains code not relevant to the developers role, could be an anomaly to investigate.",
         "category" : "Data Exfiltration",
         "released" : "1.0.0",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the user account accessing the specific repo. Contact the user and manager to determine if they are accessing the repo with authorization. If they did not access this repo, attempt to determine if the user credentials have been used by another party by stealing a users credentials.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is the Splunk-internal git source source checkout history for a couple of our Splunk UBA software developers, anonymized to Alice and Chuck. On the last day, I added in a few more developers who visit other repositories, but set their usernames to Chuck so that it looks like he started downloading from a bunch of repositories that he's never touched before. We also have a user Bob, who has checked out from a few other repositories in the past, and is on Chuck's team. For this analysis, we are looking at the first time a username has checked out from a repository names, and alerting if that was in the last day. We can always also filter for peer groups, to exclude those repositories that Bob (on Chuck's team) had viewed before.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p><p><i>Note</i>: We include an accelerated version to show how this would work, but there is no data model for this out of the box, so you would need to build one yourself.</p>",
         "description" : "<p>Find users who accessed a git repository for the first time.</p><p><b>Alert Volume:</b> High</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1213",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective"
      },
      "codeword_threshold_departments" : {
         "mitre" : "Collection",
         "knownFP" : "Because we're using a static threshold here for the number of different departments, you would need to adjust this threshold to suit your organization. Because these types of events are inherently fairly bursty (someone catches up on their email, someone switches into a project management role, etc.) it's difficult to use ML to solve for it but relatively easy to understand it given business context. This alert, in isolation, is often benign for exactly the reasons listed above. ",
         "domain" : "Data",
         "includeSSE" : "Yes",
         "name" : "User Finding Project Code Names from Many Departments",
         "howToImplement" : "<p>There are two key components of implementing this particular detection. First, you need to make sure that you have the right Confluence logs -- run the base search, or look for confluence logs in your environment by searching for something like dositesearch (that's how I found them!) and record the index and sourcetype. If you use a different internal wiki (like Sharepoint), then you will need to alter the search to pull the search logs for that system. The second piece is harder -- in order to find project code names being searched in your logs, you have to know what those code names are (and for this detection, what department they belong to). You will have to reach out to different departments in your organization to find this knowledge, but once you have it you can mirror the format of the sample sse_project_codenames lookup.</p>",
         "operationalize" : "Because these activities can be benign (see Known False Positives), look for other indications of suspicious behavior with this user, or validate with their management or HR that the behavior is expected.",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of Confluence (an internal wiki software) logs centered around a few users for two months.</p>",
         "category" : "Insider Threat",
         "released" : "2.2.0",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1213",
         "description" : "<p>Find users trying to collect and analyze internal projects from across multiple departments by analyzing their search logs on company wiki software.</p>",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "Yes",
         "alertvolume" : "Low",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/codeword_threshold_departments.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Codeword Threshold Departments - Demo",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat",
         "datasource" : "Web Server",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "mitre_tactic" : "TA0009",
         "data_source_categories" : "DS014WebServer-ET02InternalKnowledgeManagement",
         "examples" : [
            {
               "name" : "Codeword Threshold Departments - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Codeword Threshold Departments - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_4"
      },
      "detection_malicious_powershell_process_multiple_suspicious_arguments" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Malicious PowerShell",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "help" : "This search looks for PowerShell processes that have a number of suspicious flags on the command-line. It is looking for flags are passing encoded commands on the command-line. The flags <code>-EncodedCommand</code> and <code>-enc</code> are two different possible flags that can be used to pass base64 encoded commands to PowerShell. The <code>*-Exec*</code> flag looks to see it the default execution policy of PowerShell is being overridden, while the <code>*-NonI*</code> flag tells the PowerShell process that this will be a noninteractive process, so the user doesn't know about the process. This search will return the host, the user the process ran under, the process and it's command-line arguments, the number of times it's seen this process, and the first and last times it saw this process.",
         "name" : "Malicious PowerShell Process - Multiple Suspicious Command-Line Arguments",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "hasSearch" : "No",
         "killchain" : "Command and Control|Actions on Objective",
         "searchKeywords" : "",
         "description" : "This search looks for PowerShell processes started with a base64 encoded command-line passed to it, with parameters to modify the execution policy for the process, and those that prevent the display of an interactive prompt to the user. This combination of command-line options is suspicious because it overrides the default PowerShell execution policy, attempts to hide itself from the user, and passes an encoded script to be run on the command-line.",
         "search_name" : "ESCU - Malicious PowerShell Process - Multiple Suspicious Command-Line Arguments - Rule",
         "mitre_technique" : "T1086|T1064",
         "SPLEase" : "None"
      },
      "multiple_external_alarms" : {
         "mitre_tactic" : "",
         "data_source_categories" : "DS016DataLossPrevention-ET01Violation|DS012NetworkIntrusionDetection-ET01SigDetection|DS020HostIntrustionDetection-ET01SigDetected|DS004EndPointAntiMalware-ET01SigDetected|DS025IPAddressAssignment-ET01General",
         "journey" : "Stage_5",
         "app" : "Splunk_User_Behavior_Analytics",
         "datasource" : "DLP|IDS or IPS|Host-based IDS|Anti-Virus|Web Application Firewall",
         "displayapp" : "Splunk User Behavior Analytics",
         "highlight" : "No",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Insider Threat",
         "icon" : "UBA_Use_Case.png",
         "dashboard" : "UBA_Use_Case",
         "mitre_notes" : "This is too generic to map to a specific technique. The alarms could be from various systems",
         "alertvolume" : "Other",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "description" : "Detects outliers in the timeseries of external alarm per internal device.",
         "mitre_technique" : "",
         "released" : "2.2.0",
         "category" : "Endpoint Compromise|Network Attack",
         "help" : "Help not needed -- UBA Use Case",
         "includeSSE" : "Yes",
         "name" : "Multiple External Alarms",
         "mitre" : "",
         "domain" : "Network|Endpoint|Threat"
      },
      "host_with_old_infection_or_potential_reinfection" : {
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : "",
         "alertvolume" : "Other",
         "images" : [
            {
               "path" : "/static/app/Splunk_Security_Essentials/images/example_images/es_host_with_reinfection_1.png",
               "name" : "Malware Operations Center",
               "label" : "In ES, the Malware Operations Center provides lots of powerful visibility into the malware status of your organization."
            }
         ],
         "app" : "Splunk_App_for_Enterprise_Security",
         "data_source_categories" : "DS004EndPointAntiMalware-ET01SigDetected",
         "mitre_tactic" : "|TA0002",
         "journey" : "Stage_2",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Anti-Virus",
         "highlight" : "Yes",
         "help" : "Help not needed -- ES Use Case",
         "category" : "Endpoint Compromise|GDPR",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Endpoint",
         "gdprtext" : "<h4>Impact:</h4><p>Similar to Detection of Uncleaned Malware on Endpoint – uncleaned malware puts digital systems at risk. For any environments/systems that are involved in processing personal data, this situation can be critical, and especially so in a GDPR context. Article 32 of the GDPR requires that organizations regularly test, assess and evaluate effectiveness of implemented technical and organizational security controls. In the event that a Supervisory Authority executes powers to place an organization within the scope of a privacy audit, the organization must demonstrate compliance (Article 58). If the organization faces a personal data breach and individuals are impacted, those individuals have the right to demand compensation for material and non-material damage caused by the breach. The organization must prove that they have understood and addressed the risk appropriately and deployed proper countermeasures (Article 82). </p><h4>Resolution Path:</h4><p>Removing malware infections that antivirus and other legacy endpoint protection software cannot remove (whether due to file permissions or other configurations that prevents easy quarantine or cleaning) can be considered in many cases appropriate, and helps to demonstrate compliance.</p>",
         "name" : "Host With Old Infection Or Potential Re-Infection",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "SPLEase" : "Accelerated",
         "search_name" : "Endpoint - Old Malware Infection - Rule",
         "mitre_technique" : "|T1204",
         "description" : "Alerts when a host with an old infection is discovered (likely a re-infection)."
      },
      "detection_no_win_updates_in_timeframe" : {
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "mitre_notes" : "Cyber Hygiene. Not an attacker technique",
         "relatedUseCases" : [
            "Basic_Scanning",
            "excessive_failed_logins",
            "showcase_first_logon"
         ],
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Patch Management",
         "highlight" : "No",
         "usecase" : "Compliance",
         "icon" : "ES_Use_Case.png",
         "mitre_tactic" : "",
         "data_source_categories" : "DS019PatchManagement-Applied",
         "journey" : "Stage_4",
         "story" : "Monitor for Updates",
         "app" : "Enterprise_Security_Content_Update",
         "includeSSE" : "Yes",
         "name" : "No Windows Updates in a time frame",
         "mitre" : "",
         "domain" : "Endpoint",
         "category" : "Compliance",
         "released" : "2.0.0",
         "help" : "Keeping your systems up-to-date with the latest patches is an important step in keeping your systems secured. For Windows endpoints, Microsoft typically releases patches on the second Tuesday of every month. These patches contain fixes for vulnerabilities in the system that could potentially be exploited by malicious actors. This search checks for messages regarding Windows updates in the 'Update' data model. If a message indicating a successful update has not been observed in 60 days, a notable event will be generated. These systems should be checked to determine why it has not been updated in that time frame.",
         "description" : "This search looks for Windows endpoints that have not generated an event indicating a successful Windows update in the last 60 days. Windows updates are typically released monthly and applied shortly thereafter. An endpoint that has not successfully applied an update in this time frame indicates the endpoint is not regularly being patched for some reason.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "search_name" : "ESCU - No Windows Updates in a time frame - Rule",
         "hasSearch" : "No",
         "searchKeywords" : ""
      },
      "detection_file_write_spikes" : {
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "The search looks for a sharp increase in the number of files written to a particular host",
         "search_name" : "ESCU - Spike in File Writes - Rule",
         "mitre_technique" : "|TA0002",
         "SPLEase" : "None",
         "released" : "2.0.0",
         "category" : "Ransomware",
         "help" : "This search calculates counts the number of file modification events per hour per host in your environment. It then takes the average and standard deviations of those numbers and displays any hosts with more than 20 events that have over four times the standard deviation more than the average number of file modifications.",
         "name" : "Spike in File Writes",
         "includeSSE" : "Yes",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "journey" : "Stage_2",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "TA0002",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Ransomware",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "usecase" : "Security Monitoring|Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "High"
      },
      "host_with_a_recurring_malware_infection" : {
         "help" : "Help not needed -- ES Use Case",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "name" : "Host With A Recurring Malware Infection",
         "includeSSE" : "Yes",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "search_name" : "Endpoint - Recurring Malware Infection - Rule",
         "mitre_technique" : "|T1204",
         "SPLEase" : "Accelerated",
         "description" : "Alerts when a host has an infection that has been re-infected remove multiple times over multiple days.",
         "similarUseCases" : [
            "Basic_Malware_Outbreak",
            "Recurring_Infection_on_Host",
            "high_number_of_infected_hosts",
            "host_with_multiple_infections",
            "UC0029",
            "UC0028",
            "UC0075",
            "UC0065"
         ],
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_App_for_Enterprise_Security",
         "journey" : "Stage_2",
         "data_source_categories" : "DS004EndPointAntiMalware-ET01SigDetected",
         "mitre_tactic" : "TA0002",
         "usecase" : "Security Monitoring",
         "icon" : "ES_Use_Case.png",
         "highlight" : "Yes",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Anti-Virus"
      },
      "detection_dyn_dns_queries" : {
         "description" : "Malicious actors often abuse legitimate Dynamic DNS services to host malicious payloads or interactive command and control nodes. Attackers will automate domain resolution changes by routing dynamic domains to countless IP addresses to circumvent firewall blocks, blacklists as well as frustrate a network defenders analytic and investigative processes. This search will look for DNS queries made from within your infrastructure to suspicious dynamic domains. ",
         "mitre_technique" : "T1043|T1311|TA0005",
         "search_name" : "ESCU - Detect hosts connecting to dynamic domain providers - Rule",
         "SPLEase" : "None",
         "hasSearch" : "No",
         "killchain" : "Command and Control|Actions on Objective",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Detect hosts connecting to dynamic domain providers",
         "domain" : "Network",
         "mitre" : "Exfiltration|Defense Evasion",
         "released" : "2.0.0",
         "category" : "Command and Control",
         "help" : "The search is querying an accelerated `Network_Resolution` data model to count and list the values of resolved domains for each DNS query and checks that against the list of Dynamic DNS providers (lookup - `dynamic_dns_providers`) by each host (DNS.src)",
         "highlight" : "No",
         "datasource" : "DNS",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_3",
         "data_source_categories" : "DS002DNS-ET01QueryRequest",
         "mitre_tactic" : "TA0005|TA0021",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "DNS Hijacking",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case"
      },
      "untriaged_notable_events" : {
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : "Cyber hygiene",
         "alertvolume" : "Other",
         "data_source_categories" : "DS013TicketManagement-ET01",
         "mitre_tactic" : "",
         "journey" : "Stage_5",
         "app" : "Splunk_App_for_Enterprise_Security",
         "datasource" : "Ticketing System",
         "displayapp" : "Splunk App for Enterprise Security",
         "highlight" : "Yes",
         "usecase" : "Security Monitoring|Compliance",
         "icon" : "ES_Use_Case.png",
         "category" : "Operations|GDPR",
         "released" : "2.0.0",
         "help" : "Help not needed -- ES Use Case",
         "gdprtext" : "<h4>Impact:</h4><p>Detecting and proving that priority alerts indicating potential risk to security posture are not being processed in a timely manner is an industry best practice.</p><p>Specific to GDPR, this method is considered an effective security control, as required by Article 32. Demonstrating that noteworthy activity is being triaged and appropriately escalated will help to prove compliance for data privacy audits from authorities (Article 58) or counteract any compensation claims (Article 82). </p>",
         "includeSSE" : "Yes",
         "name" : "Untriaged Notable Events",
         "mitre" : "",
         "domain" : "Audit",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "Alerts when notable events have not been triaged",
         "SPLEase" : "Medium",
         "search_name" : "Audit - Untriaged Notable Events - Rule",
         "mitre_technique" : ""
      },
      "Outdated_Malware_Definitions" : {
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "SPLEase" : "Basic",
         "mitre_technique" : "",
         "description" : "Looks for Symantec AV systems where we see Symantec AV events, but don't see a malware definition update in the last few days.",
         "operationalize" : "When this fires, look on the host to see why the Anti-Virus isn't updating. If you don't see an obvious reason (e.g., specific and logical error), then it may be worth investigating that host to see if there are any other suspicious events that have occurred to rule out an infection.",
         "howToImplement" : "This particular search usually finds most of its success with just Symantec AV. Many Anti-Virus products are found to provide insufficient logging to be able to see when the definitions are updated (often, just when there is malware found). If you are using Symantec AV and followed the data onboarding guide, this should work automatically. If you did not follow the data onboarding guide, make sure that your sourcetypes and indexes match. Always hard-code your sourcetypes and indexes rather than doing index=* in searches.",
         "help" : "This example leverages the Simple Search search assistant. Our example dataset is a collection of anonymized Symantec Endpoint Protection logs (onboarded in accordance with our Data Onboarding Guides), during which someone does something bad. Our live search looks for the same behavior using the standardized sourcetypes for Symantec Endpoint Protection or the Common Information Model.",
         "category" : "Operations|Compliance|Endpoint Compromise",
         "released" : "2.0.0",
         "knownFP" : "No known false positives at this time.",
         "mitre" : "",
         "relevance" : "This indicates that a host is not updating its anti-virus definitions, which can be an operational concern (e.g., anti-virus isn't working), or it could be an indication that updates have been shut off by malware itself. Regardless, it is something to fix.",
         "domain" : "Endpoint",
         "name" : "Outdated Malware Definitions",
         "includeSSE" : "Yes",
         "app" : "Splunk_Security_Essentials",
         "data_source_categories" : "DS004EndPointAntiMalware-ET02UpdatedSig|DS004EndPointAntiMalware-ET03UpdatedEng",
         "mitre_tactic" : "",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "Outdated Malware Definitions - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "Outdated Malware Definitions - Live"
            }
         ],
         "journey" : "Stage_1",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Security Monitoring",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Anti-Virus",
         "highlight" : "No",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/outdated_malware_definitions.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Outdated Malware Definitions - Demo",
         "mitre_notes" : "Cyber hygiene",
         "similarUseCases" : [
            "UC0030",
            "high_number_of_hosts_not_updating_malware_signatures",
            ""
         ],
         "alertvolume" : "Low"
      },
      "UC0023" : {
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Endpoints communicating with an excessive number of unique destination ports could indicate malicious code probing for vulnerabilities. Certain server applications will arrange for communication on a high number port with the client such as ftp in passive mode and RPC on windows server.",
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Scanning|Lateral Movement|Data Exfiltration",
         "domain" : "Network",
         "mitre" : "",
         "name" : "Endpoint communicating with an excessive number of unique ports",
         "includeSSE" : "No",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Insider Threat",
         "highlight" : "No",
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Network Communication",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other"
      },
      "detection_cred_dump_via_reg" : {
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "High",
         "mitre_tactic" : "TA0006",
         "data_source_categories" : "DS009EndPointIntel-ET03ProcessLaunchwithCLI",
         "journey" : "Stage_3",
         "story" : "Credential Dumping",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "No",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "released" : "2.2.0",
         "category" : "Adversary Tactics",
         "help" : "This search looks for the process reg.exe with the \"save\" parameter, which specifies a binary export from the registry. In addition, it looks for the keys that contain the hashed credentials, which attackers may retrieve and use for brute-force attacks in order to harvest legitimate credentials.",
         "includeSSE" : "Yes",
         "name" : "Attempted Credential Dump From Registry Via Reg.exe",
         "mitre" : "Credential Access",
         "domain" : "Endpoint",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "description" : "This search looks for execution of reg.exe with parameters specifying an export of keys that contain hashed credentials that attackers may try to crack offline,",
         "search_name" : "ESCU - Attempted Credential Dump From Registry Via Reg.exe - Rule",
         "mitre_technique" : "T1003"
      },
      "unusually_long_vpn_session" : {
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "mitre_notes" : "",
         "highlight" : "No",
         "displayapp" : "Splunk User Behavior Analytics",
         "datasource" : "IP Address Assignment",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Advanced Threat Detection|Security Monitoring|Insider Threat",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0010|TA0003",
         "data_source_categories" : "DS025IPAddressAssignment-ET01General",
         "app" : "Splunk_User_Behavior_Analytics",
         "name" : "Unusually Long VPN Session",
         "includeSSE" : "Yes",
         "domain" : "Other",
         "mitre" : "",
         "released" : "2.0.0",
         "category" : "Lateral Movement|Account Compromise|Data Exfiltration",
         "help" : "Help not needed -- UBA Use Case",
         "description" : "Detects unusually long VPN sessions, based on a user's baseline and their peer group.",
         "mitre_technique" : "|T1048|T1108",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : ""
      },
      "showcase_new_sfdc_tables_peer" : {
         "released" : "1.4.0",
         "category" : "Data Exfiltration|GDPR|SaaS",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the user demonstrating this behavior. Capture the time of the event, the user's role, and tables queried. If possible, determine the system the user is using and its location. Contact the user and their manager to determine if it is authorized, and document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple, though the peer group makes things slightly more complicated.<ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted.</li><li>Save the search.</li></ul></p><p>To configure the Peer Group:<ol><li>Start with a data source that gives you visibility into the peer group -- easiest is usually querying Active Directory via the <a href=\"https://splunkbase.splunk.com/app/1151/\">SA-ldapsearch add-on</a>, but you could get lists of users and their teams / departments / etc from any source you have.</li><li>Next you will need to convert that log source into a format that this lookup is expecting, which is as follows:<table class=\"table\" style=\"width: 300px\"><tr><td>user</td><td>peergroup (order not important)</td></tr><tr><td>john</td><td>john|sarah</td></tr><tr><td>sarah</td><td>john|sarah</td></tr><tr><td>mark</td><td>mark</td></tr></table>The easiest way to do this is with a search like <span class=\"spl\">| inputlookup LDAPSearch.csv | stats values(user) as user by department | eval peergroup=mvjoin(user, \"|\") | mvexpand user</span></li></ol></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "help" : "<p>This is the generic search builder for First Seen Detection. Our dataset is an anonymized data collection from an actual customer environment.</p>",
         "name" : "New Tables Queried by Salesforce.com Peer Group",
         "includeSSE" : "Yes",
         "gdprtext" : "<h4>Impact:</h4><p>Detecting first-time query attempts to sensitive tables by a peer group that has previously not accessed the tables in question, can help prove that individuals within the organization are not abusing or misusing legitimate access to assets that store and process personal data. This method is an industry best practice.</p><p>Specific to GDPR, this can be considered an effective security control, as required by Article 32. This is applicable to processing personal data from the controller, and needs to also be addressed if contractors or sub-processors from third countries or international organizations access and transfer personal data (Article 15). </p>",
         "domain" : "Data",
         "mitre" : "Discovery|Collection",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>You should not review these alerts directly (except for high sensitivity accounts), but instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p>",
         "hasSearch" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "salesforce sfdc",
         "description" : "<p>Salesforce.com supports a simplified query language called SOQL. This search detects users who begin querying sensitive tables that have never been contacted by peer group.</p><p><b>Alert Volume:</b> Low</p>",
         "mitre_technique" : "|T1213|T1018",
         "SPLEase" : "Medium",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New SFDC Tables Queried by Peer Group - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/sfdc_new_table_peer_group.png",
         "alertvolume" : "Low",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "New SFDC Tables Queried by Peer Group - Demo"
            },
            {
               "name" : "New SFDC Tables Queried by Peer Group - Live",
               "label" : "Live Data"
            }
         ],
         "data_source_categories" : "VendorSpecific-sfdc-elf",
         "mitre_tactic" : "TA0007|TA0009",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "usecase" : "Compliance|Insider Threat",
         "icon" : "Core_Use_Case.png"
      },
      "UC0084" : {
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "Define and maintain event types for unsuppressed notable events separately identifying review workflow, and triage SLA required.",
         "help" : "Help not needed -- PS Use Case",
         "category" : "Operations",
         "released" : "2.0.0",
         "domain" : "Operations",
         "mitre" : "",
         "includeSSE" : "No",
         "name" : "Monitor Execution of Triage Activity",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_5",
         "mitre_tactic" : "",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring",
         "highlight" : "No",
         "datasource" : "Ticketing System",
         "displayapp" : "Splunk Professional Services",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other"
      },
      "default_account_activity_detected" : {
         "app" : "Splunk_App_for_Enterprise_Security",
         "mitre_tactic" : "|TA0006",
         "data_source_categories" : "DS003Authentication-ET01Success",
         "journey" : "Stage_2",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "Authentication",
         "highlight" : "No",
         "dashboard" : "ES_Use_Case",
         "alertvolume" : "Other",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "SPLEase" : "Medium",
         "search_name" : "Access - Default Account Usage - Rule",
         "mitre_technique" : "|T1110",
         "description" : "Discovers use of default accounts (such as admin, administrator, etc.). Default accounts have default passwords and are therefore commonly targeted by attackers using brute force attack tools.",
         "help" : "Help not needed -- ES Use Case",
         "category" : "IAM Analytics|Endpoint Compromise|GDPR",
         "released" : "2.0.0",
         "mitre" : "",
         "domain" : "Access",
         "gdprtext" : "<h4>Problem:</h4><p>Default user accounts are often targeted for exploitation since they have administrative privileges on the host system, thereby enabling an attacker who gains access to the default account to use system resources how they see fit. Depending on the environment, default accounts may not be able to be deleted, and depending on corporate IT policy may have a no-use or limited-use restriction.</p><h4>Impact:</h4><p>The use of default accounts is often out of corporate IT compliance as in most cases no individual can be assigned to the activity happened. Using individual user accounts with administrator privileges in larger organizations with multiple system administrators, is a security best practice and service accounts should rarely be used. </p><p>Specific to GDPR, monitoring and demonstrating that security controls are effective is required by Article 32, therefore immediate awareness of any default account activity is critical to maintaining compliance posture and documenting such activity and remedial actions is required in order to prove compliance for data privacy audits initiated by data privacy authorities (Article 58) and also to help counteract compensation claims (Article 82).</p><h4>Resolution Path:</h4><p>Analyze default user accounts for activity that could be security issues – for example, creation of new accounts, modification in account or file privileges, or other unauthorized configuration changes that could indicate a threat. This helps maintain security posture, compliance, and provide early warning of a larger potential issue. </p>",
         "name" : "Default Account Activity Detected",
         "includeSSE" : "Yes"
      },
      "detection_registry_persistence" : {
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "search_name" : "ESCU - Registry Keys Used For Persistence - Rule",
         "mitre_technique" : "T1103|T1131|T1128|T1060|T1004",
         "SPLEase" : "None",
         "description" : "The search looks for modifications to registry keys that can be used to launch an application or service at system startup.",
         "help" : "This search looks for specific registry paths that malware often uses to ensure survivability and persistence on system startup. The search returns the count, the first time the activity was seen, the last time the activity was seen, the registry path that was modified, the host where the modification took place and the user that performed the modification.",
         "category" : "Endpoint Compromise",
         "released" : "2.0.0",
         "domain" : "Endpoint",
         "mitre" : "Persistence",
         "name" : "Registry Keys Used For Persistence",
         "includeSSE" : "Yes",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Ransomware",
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "mitre_tactic" : "TA0003",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "Yes",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "relatedUseCases" : [
            "sser_fake_windows_processes",
            "detection_malicious_powershell_process_obfuscation_techniques",
            "suspicious_network_exploration"
         ],
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "detection_ec2_instance_modified_by_previously_unseen_user" : {
         "domain" : "Endpoint",
         "mitre" : "",
         "includeSSE" : "Yes",
         "name" : "EC2 Instance Modified With Previously Unseen User",
         "help" : "The subsearch returns the ARNs of all successful EC2 instance modifications within the last hour and then appends the historical data in the lookup file to those results. EC2 modification APIs are defined by the macro <code>ec2ModificationAPIs</code>. The search then recalculates the <code>firstTime</code> and <code>lastTime</code> field for each ARN and returns only those ARNs that have first been seen in the past hour. This is combined with the main search to return the time, user, and instance ID of those systems.",
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS",
         "search_name" : "ESCU - EC2 Instance Modified With Previously Unseen User - Rule",
         "mitre_technique" : "",
         "description" : "This search looks for EC2 instances being modified by users who have not previously modified them.",
         "killchain" : "",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Vendor-Specific Data",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Unusual AWS EC2 Modifications",
         "journey" : "Stage_3",
         "mitre_tactic" : "",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail"
      },
      "UC0052" : {
         "help" : "Help not needed -- PS Use Case",
         "released" : "2.0.0",
         "category" : "Insider Threat",
         "domain" : "Access",
         "mitre" : "",
         "name" : "Non-CIP user attempts to access CIP asset",
         "includeSSE" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "",
         "SPLEase" : "None",
         "description" : "CIP assets require special protections; therefore, users that have not been vetted for CIP access, or should have had their access removed, should not have access.  System owners should be notified immediately should a non-CIP user attempt to access a CIP asset. ",
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_Professional_Services",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Insider Threat",
         "highlight" : "No",
         "datasource" : "Authentication",
         "displayapp" : "Splunk Professional Services"
      },
      "detection_s3_access_from_new_ip" : {
         "includeSSE" : "Yes",
         "name" : "Detect S3 access from a new IP",
         "domain" : "Network",
         "mitre" : "Execution|Exfiltration",
         "released" : "2.2.0",
         "category" : "Cloud Security|SaaS",
         "help" : "Here the subsearch executes first and returns all successful S3 bucket-access attempts (HTTP code \"200\") within the last hour. It groups the results by the earliest and latest times it has seen a remote IP accessing a particular bucket. It appends this information to the historical data from the lookup file and then recalculates the <code>firstTime</code> and <code>lastTime</code> field for each remote IP accessing an S3 bucket. Next, it returns only those remote IP addresses that have first been seen accessing a specific bucket within the past hour. This is combined with the main search to return the time, bucket name, source IP, city, and country operations performed, as well as the requested URI of the resource ",
         "description" : "This search looks at S3 bucket-access logs and detects new or previously unseen remote IP addresses that have successfully accessed an S3 bucket.",
         "search_name" : "ESCU - Detect S3 access from a new IP - Rule",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "alertvolume" : "High",
         "mitre_notes" : "MITRE ATT&CK enterprise does not have good cataloging of cloud based activity.",
         "dashboard" : "ESCU_Use_Case",
         "highlight" : "No",
         "datasource" : "Vendor-Specific Data|Web Server",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_1",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail|DS014WebServer-ET01Access",
         "mitre_tactic" : "TA0002|TA0010",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Suspicious AWS S3 Activities"
      },
      "stale_account_usage" : {
         "hasSearch" : "Yes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "description" : "<p>Detect long-inactive accounts that suddenly become active.</p>",
         "mitre_technique" : "|T1078",
         "SPLEase" : "Medium",
         "released" : "2.2.0",
         "category" : "Insider Threat|IAM Analytics|Account Compromise",
         "implementationNotes_Internal" : "create a lookup to cache, and automatically lowercase the username 'cause lookups are case sensitive. Also make sure we're filtering for successful authentications.",
         "howToImplement" : "<p>Building this detection is relatively straightforward. The actual data source is authentication logs, and the search automatically populates that lookup with content. The only step you'll need to take is to create a lookup called account_status_tracker, and have authentication data in Common Information Model format (or by default we'll just use Windows logs as well).</p><p>There is on key business decision that you must make to implement this detection -- the definition of stale. Most commonly we hear about the desire to detect logins from accounts that are more than 90 days old, though some organizations will also look at 45 days. Generally speaking you want to target more than once per month, as some services or tasks will only run that often.</p><p>One good note is that this search will automatically store usernames in lowercase format, as lookups are case sensitive by default (adjustable via transforms.conf). If you have case sensitive usernames (e.g., jsmith and Jsmith are different users) then.. first, I'm sorry to hear how you suffer.. but you can remove the lowercase eval function.</p>",
         "operationalize" : "<p>When this search fires, your first instinct should be to look for legitimate cause. See the Known False Positives for more detail. Whenever a service account becomes active suddenly, your best bet is to reach out to the service owners to determine whether they expected it while simultaneously looking to ensure that the systems where that account is active (and/or the actions being taken if you have that visibility) are what would be expected. For suspicious scenarios or high risk services you may also wish to look for employees who left under unfriendly scenarios, who might have left a backdoor. For users where this fires, it should be relatively straightforward to see whether they still work at the company and if they do not, reach out to their manager to determine if there was a reason the account remained (or consult any notes about their separation).</p>",
         "help" : "<p>This example leverages the simple search assistant. Our dataset is an anonymized collection of authentication logs. For this analysis, we are creating a lookup with the historical record of the first and last recorded login time per user. When a user logs in on a day, but the last login we tracked was from months earlier, we create an alert.</p>",
         "includeSSE" : "Yes",
         "name" : "Stale Account Usage",
         "domain" : "Access",
         "relevance" : "<p>There are two primary scenarios where the activation of a stale account can be a concern. The first, and usually the first to come to mind, is a former employee or contractor who wants to gather sensitive information or compromise systems. They may check to see if their old user account was accidentally left active, or if a service account that they managed did not have a password reset (or even if there were API keys they had access to that weren't terminated). The other, is that an adversary does a brute force to find some accounts laying around, often service accounts that aren't actively used and so no admin had the opportunity to think \"say, we probably shouldn't use admin / changeme on our production system.\" In either case, you likely want to know.</p>",
         "knownFP" : "<p>This search doesn't have false positives in the sense of accounts where the search would alert even though the account had recently been active. However, there can be scenarios where this alerts and it is not an account compromise or other malicious act. Particularly when this is a new detection for your organization, you may find accounts that are only active once every month, once every quarter, or even once per year (often associated with closing out the financial quarter / year). Beyond periodic accounts, the most likely scenario for a benign alert will be an employee who is on long term leave.</p>",
         "mitre" : "Privilege Escalation|Credential Access|Lateral Movement",
         "examples" : [
            {
               "name" : "Stale Account Used - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Stale Account Used - Live",
               "label" : "Live Data"
            },
            {
               "name" : "Stale Account Used - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_2",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-winsec",
         "mitre_tactic" : "TA0004|TA0003|TA0001",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "Yes",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Authentication|Vendor-Specific Data",
         "usecase" : "Insider Threat|Security Monitoring",
         "icon" : "Core_Use_Case.png",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Stale Account Used - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/stale_account_usage.png",
         "alertvolume" : "Low"
      },
      "detection_suspicious_write_to_recycler" : {
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0009",
         "data_source_categories" : "DS009EndPointIntel-ET01ObjectChange",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Collection and Staging",
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "description" : "This search detects writes to the recycle bin by a process other than explorer.exe.",
         "mitre_technique" : "T1074",
         "search_name" : "ESCU - Suspicious writes to windows Recycle Bin - Rule",
         "hasSearch" : "No",
         "killchain" : "",
         "searchKeywords" : "",
         "includeSSE" : "Yes",
         "name" : "Suspicious writes to windows Recycle Bin",
         "domain" : "Endpoint",
         "mitre" : "Collection",
         "category" : "Adversary Tactics",
         "released" : "2.2.0",
         "help" : "This search uses data on file writes captured via Sysmon to watch for writes to the Recycle Bin by processes other than explorer.exe. The search looks for event code 11 in the Sysmon events, which indicates a file-creation event. Next, it looks for files created with a path that includes the string \"$Recycle.Bin\" by processes other than explorer.exe, which is the process responsible for copying files to the Recycle Bin on delete. It will report the system where the activity occurred, the path to which the file was written, the process responsible for the write, and the times it first and last saw this activity."
      },
      "AWS_APIs_Called_More_Often_Than_Usual_Per_Account" : {
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=AWS APIs Called More Often Than Usual Per Account - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/aws_apis_more_often_per_user.png",
         "alertvolume" : "High",
         "data_source_categories" : "VendorSpecific-aws-cloudtrail",
         "mitre_tactic" : "TA0015",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "AWS APIs Called More Often Than Usual Per Account - Demo"
            },
            {
               "name" : "AWS APIs Called More Often Than Usual Per Account - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "app" : "Splunk_Security_Essentials",
         "datasource" : "Vendor-Specific Data",
         "displayapp" : "Splunk Security Essentials",
         "highlight" : "No",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "category" : "Account Compromise|IAM Analytics|SaaS",
         "released" : "2.0.0",
         "help" : "This example leverages the Detect Spikes search assistant. Our example dataset is a collection of anonymized AWS CloudTrail logs, during which someone does something bad. Our live search looks for the same behavior using the very standardized index and sourcetype for AWS CloudTrail, as detailed in How to Implement.",
         "operationalize" : "When this alert fires, you should look at what APIs were called. We've excluded some of the basic inaction ones (such as DescribeInstances), but the severity of the event will vary based on the severity of the API calls. The natural next step is to call a user and see if they expected this behavior. If the user cannot attribute this activity, it is best to reset the keys and continue your investigation to see what occurred.",
         "howToImplement" : "Assuming you use the ubiquitous AWS Add-on for Splunk to pull these logs in, this search should work automatically for you without issue. While implementing, make sure you follow the best practice of specifying the index for your data.",
         "includeSSE" : "Yes",
         "name" : "AWS APIs Called More Often Than Usual Per User",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>How you handle these alerts depends on where you set the standard deviation. If you set a low standard deviation (2 or 3), you are likely to get a lot of events that are useful only for contextual information. If you set a high standard deviation (6 or 10), the amount of noise can be reduced enough to send an alert directly to analysts.</p>",
         "mitre" : "Execution",
         "domain" : "Access",
         "relevance" : "The risk that this detection intends to reduce is the compromise of an existing AWS account, where it all of a sudden begins taking new actions that it hasn't before. This could mean that the credentials for that account have been compromised, and are in control of an adversary, potentially resulting in data leakage, data deletion, or cost run-up.",
         "hasSearch" : "Yes",
         "searchKeywords" : "cloudtrail",
         "killchain" : "Actions on Objective",
         "description" : "Builds a per-user baseline for how many API calls is normal, and then alerts for deviations.",
         "SPLEase" : "Medium",
         "mitre_technique" : "|T1260"
      },
      "UC0055" : {
         "description" : "Detect when an endpoint is permitted external access by the web proxy where the category is known it indicate high risk by category. This list should not include undesirable but frequent categories such as social media, porn, time wasting, or advertising.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "name" : "Allowed Communication from a endpoint with external &quot;risky&quot; category",
         "includeSSE" : "No",
         "mitre" : "",
         "domain" : "Network",
         "category" : "Unauthorized Software|Compliance",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case",
         "datasource" : "Web Proxy",
         "displayapp" : "Splunk Professional Services",
         "highlight" : "No",
         "icon" : "PS_Use_Case.png",
         "usecase" : "Security Monitoring|Compliance",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "app" : "Splunk_Professional_Services",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case"
      },
      "excessive_dns_queries" : {
         "name" : "Excessive DNS Queries",
         "includeSSE" : "Yes",
         "domain" : "Network",
         "mitre" : "",
         "category" : "Command and Control|Endpoint Compromise",
         "released" : "2.0.0",
         "help" : "Help not needed -- ES Use Case",
         "description" : "Alerts when a host starts sending excessive DNS queries",
         "mitre_technique" : "|T1071",
         "search_name" : "Network - Excessive DNS Queries - Rule",
         "SPLEase" : "Accelerated",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "alertvolume" : "Other",
         "dashboard" : "ES_Use_Case",
         "mitre_notes" : "",
         "highlight" : "No",
         "displayapp" : "Splunk App for Enterprise Security",
         "datasource" : "DNS",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "journey" : "Stage_3",
         "mitre_tactic" : "|TA0011",
         "data_source_categories" : "DS002DNS-ET01QueryRequest",
         "app" : "Splunk_App_for_Enterprise_Security"
      },
      "detection_excessive_user_account_lockouts" : {
         "hasSearch" : "No",
         "searchKeywords" : "",
         "description" : "This search detects user accounts that have been locked out a relatively high number of times in a short period.",
         "SPLEase" : "None",
         "search_name" : "ESCU - Detect Excessive User Account Lockouts - Rule",
         "mitre_technique" : "T1078|T1110",
         "released" : "2.0.0",
         "category" : "Account Compromise",
         "help" : "This search queries the `Change.All_Changes` datamodel under the nodename is `Account_Management` , where the result is \"lockout\", which indicates that an account has been locked out. It then counts the number of times a user  has caused an account lockout within a four hour window and displays those users with a count greater than or equal to five.",
         "name" : "Detect Excessive User Account Lockouts",
         "includeSSE" : "Yes",
         "mitre" : "",
         "domain" : "Access",
         "mitre_tactic" : "|TA0006",
         "data_source_categories" : "DS003Authentication-ET02Failure",
         "journey" : "Stage_1",
         "story" : "Account Monitoring and Controls",
         "app" : "Enterprise_Security_Content_Update",
         "datasource" : "Authentication",
         "displayapp" : "Enterprise Security Content Update",
         "highlight" : "Yes",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "dashboard" : "ESCU_Use_Case",
         "similarUseCases" : [
            "detection_excessive_lockouts_from_endpoint"
         ],
         "relatedUseCases" : [
            "basic_brute_force",
            "Basic_Scanning",
            "showcase_many_hosts",
            "detection_excessive_lockouts_from_endpoint"
         ],
         "alertvolume" : "Medium"
      },
      "showcase_increase_in_interactively_logged_on_users" : {
         "app" : "Splunk_Security_Essentials",
         "journey" : "Stage_1",
         "examples" : [
            {
               "name" : "Increase in Interactively Logged In Users - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Increase in Interactively Logged In Users - Live",
               "label" : "Live Data"
            }
         ],
         "data_source_categories" : "VendorSpecific-winsec",
         "mitre_tactic" : "TA0004|TA0003",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Advanced Threat Detection",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Vendor-Specific Data",
         "similarUseCases" : [
            "showcase_many_hosts",
            "showcase_increase_interactive_logon"
         ],
         "dashboard" : "showcase_standard_deviation?ml_toolkit.dataset=Increase in Interactively Logged In Users - Demo",
         "alertvolume" : "Medium",
         "killchain" : "Command and Control|Installation",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1078",
         "SPLEase" : "Medium",
         "description" : "<p>Most systems will have a relatively predictable number of interactively logged on users. This search will look for systems that have dramatically more than they typically do, with a per-user baseline.</p><p><b>Alert Volume:</b> Medium</p>",
         "help" : "<p>This example leverages the Detect Spikes (standard deviation) search assistant. Our dataset is an anonymized collection of Windows Logon events, filtered to interactive logon types (Local: 2, RemoteInteractive: 10, Cached Local: 11). For this analysis, we are tracking the number of unique users log into each system per day 'dc(user) by host _time'. Then we calculate the average, standard deviation, and the most recent value, and filter out any systems where the most recent is within the configurable number of standard deviations from average.</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and capture the time of events created, as well as the user accounts logged into the system, processes executed and other pertinent information. Contact the users and owner of the system. If it is authorized behavior, document that this is authorized and by whom. If not, the user credentials may have been used by another party and additional investigation is warranted.</p>",
         "howToImplement" : "<p>Implementation of this example (or any of the Time Series Spike / Standard Deviation examples) is generally pretty simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. If the base search you see in the box below returns results.</li><li>Save the search to run over a long period of time (recommended: at least 30 days).</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend using a summary index that first aggregates the data. We will have documentation for this process shortly, but for now you can look at Summary Indexing descriptions such as <a href=\"http://docs.splunk.com/Documentation/SplunkCloud/6.6.3/Knowledge/Usesummaryindexing\">here</a> and <a href=\"http://www.davidveuve.com/tech/how-i-do-summary-indexing-in-splunk/\">here</a>.</p>",
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "relevance" : "<p>By monitoring the number of interactively logged in users to assets, security teams can identify anomalies that may indicate the compromise of an asset or credentials. A spike in users on a particular asset could be an indicate that the asset was compromised and additional system level user accounts are being created for malicious purposes, or if they are valid credentials in AD that accounts have been compromised and the adversary is testing the accounts against a particular asset or groups of assets to test and or escalate privileges to gain deeper access to critical assets and infrastructure.</p>",
         "domain" : "Access",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately a spike in the number we're monitoring... it's nearly impossible for the math to lie. But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This detection is relatively unique amongst the behavioral searches in that there can be special tuning required for it. Generally, you can choose a high standard deviation if you do not want to receive much noise, but for this particular search we will see many systems where 99% of days there is only one user logged on. For this reason, you will likely be alerting effectively on when any other user logs onto the system. It might be prudent to exclude help desk staff from the search, or filter specifically for where 3 or more users log on if you're receiving too much noise. In any event, this is generally most useful as a contextual search technique.</p>",
         "mitre" : "Privilege Escalation|Persistence",
         "name" : "Significant Increase in Interactively Logged On Users",
         "includeSSE" : "Yes"
      },
      "detection_web_servers_executing_suspicious_processes" : {
         "help" : "This detection search uses the Enterprise Security Application State data model. The search uses tstats to search within an accelerated data model to find suspicious applications or processes such as whoami, ping, iptables, wget, service, or curl, running on hosts which are marked as web servers in the Assets and Identity Framework of ES.",
         "category" : "Web Attack",
         "released" : "2.0.0",
         "domain" : "Endpoint",
         "mitre" : "Defense Evasion|Execution|Discovery",
         "includeSSE" : "Yes",
         "name" : "Web Servers Executing Suspicious Processes",
         "killchain" : "Actions on Objective",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "T1082|T1059|T1089",
         "search_name" : "ESCU - Web Servers Executing Suspicious Processes - Rule",
         "SPLEase" : "None",
         "description" : "This search looks for suspicious processes on all systems labeled as web servers.",
         "relatedUseCases" : [],
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Apache Struts Vulnerability",
         "journey" : "Stage_4",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0002|TA0007|TA0005",
         "usecase" : "Application Security",
         "icon" : "ES_Use_Case.png",
         "highlight" : "No",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response"
      },
      "new_data_exfil_dlp_alerts" : {
         "alertvolume" : "High",
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=New Data Exfil DLP Alerts - Demo",
         "printable_image" : "/static/app/Splunk_Security_Essentials/images/printable_demo_images/new_data_exfil_dlp_alerts.png",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "DLP",
         "highlight" : "No",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat",
         "data_source_categories" : "DS016DataLossPrevention-ET01Violation",
         "mitre_tactic" : "TA0010",
         "journey" : "Stage_3",
         "examples" : [
            {
               "label" : "Demo Data",
               "name" : "New Data Exfil DLP Alerts - Demo"
            },
            {
               "label" : "Live Data",
               "name" : "New Data Exfil DLP Alerts - Live"
            },
            {
               "name" : "New Data Exfil DLP Alerts - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "app" : "Splunk_Security_Essentials",
         "name" : "New Data Exfil DLP Alerts for User",
         "includeSSE" : "Yes",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p>",
         "mitre" : "Exfiltration",
         "domain" : "Data",
         "relevance" : "<p>When a user who normally does not generate data exfil DLP alerts suddenly starts, it is more notable than a traditional alert. For crucial rules or high privileged users, investigate these events to determine whether sensitive company intelligence is leaving the organization.</p>",
         "released" : "2.2.0",
         "category" : "Insider Threat",
         "operationalize" : "<p>Because this is a behavioral alert, you should generally not use this in isolation unless the severity of the alert or the priority of the user dictate that it is so crucial it must be looked at in isolation, or your DLP is so carefully tuned that alerts are rare. For everyone else, most alerts should only be considered when in conjunction with other alerts, via a risk aggregation mechanism in Splunk ES or the threat models in Splunk UBA.</p>",
         "howToImplement" : "<p>Implementation of this rule is straightforward -- the only requirement is to be able to record which DLP alerts represent data exfiltration. That nomenclature or configuration can vary wildly from one organization to another, so this will require coordination with your DLP team. Beyond that, so long as you have a user field and a signature field defined, the search will work.</p>",
         "help" : "<p>This example leverages the first time seen search assistant. Our dataset is an anonymized collection of DLP events. For this analysis, we are filtering for data exfiltration alerts.</p>",
         "description" : "<p>When you first seen an alert from a user who hasn't generated DLP alerts for data exfiltration before, learn about that.</p>",
         "SPLEase" : "Medium",
         "mitre_technique" : "|TA0010",
         "hasSearch" : "Yes",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective"
      },
      "detection_delete_shadow_copies" : {
         "alertvolume" : "Medium",
         "dashboard" : "ESCU_Use_Case",
         "icon" : "ES_Use_Case.png",
         "usecase" : "Security Monitoring",
         "displayapp" : "Enterprise Security Content Update",
         "datasource" : "Endpoint Detection and Response",
         "highlight" : "No",
         "story" : "Ransomware",
         "app" : "Enterprise_Security_Content_Update",
         "mitre_tactic" : "TA0002|TA0005",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "journey" : "Stage_3",
         "mitre" : "Execution",
         "domain" : "Endpoint",
         "name" : "Deleting Shadow Copies",
         "includeSSE" : "Yes",
         "help" : "This search looks for execution of vssadmin or wmic with both the \"delete\" and \"shadows\" parameters passed on the command-line. The two arguments are searched for separately because we can't predict the number of spaces between the words on the command-line. The search will return the number of times this activity was observed, and the times of the first and last event.",
         "category" : "Ransomware",
         "released" : "2.0.0",
         "SPLEase" : "None",
         "mitre_technique" : "|T1107|T1059",
         "search_name" : "ESCU - Deleting Shadow Copies - Rule",
         "description" : "The vssadmin.exe utility is used to interact with the Volume Shadow Copy Service.  Wmic is an interface to the Windows Management Instrumentation.  This search looks for either of these tools being used to delete shadow copies.",
         "searchKeywords" : "",
         "killchain" : "Actions on Objective",
         "hasSearch" : "No"
      },
      "multiple_authentications" : {
         "alertvolume" : "Other",
         "dashboard" : "UBA_Use_Case",
         "highlight" : "No",
         "datasource" : "Authentication|Vendor-Specific Data",
         "displayapp" : "Splunk User Behavior Analytics",
         "usecase" : "Advanced Threat Detection|Insider Threat|Security Monitoring|Compliance",
         "icon" : "UBA_Use_Case.png",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0001",
         "data_source_categories" : "DS003Authentication-ET01Success|VendorSpecific-winsec",
         "app" : "Splunk_User_Behavior_Analytics",
         "name" : "Multiple Authentications",
         "includeSSE" : "Yes",
         "domain" : "Other",
         "mitre" : "",
         "released" : "2.2.0",
         "category" : "Lateral Movement|Insider Threat|Account Compromise|IAM Analytics",
         "help" : "Help not needed -- UBA Use Case",
         "description" : "Detects outliers in the timeseries of service or machine authentication successes per user.",
         "mitre_technique" : "|T1078",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : ""
      },
      "showcase_series_attacker_tools_hashes" : {
         "category" : "Endpoint Compromise",
         "released" : "1.0.0",
         "operationalize" : "<p>This alert is very clearly tied to a known threat, so when it fires your concern is that this represents an attacker inside of one of your systems. Recommended steps are to begin incident response on the host where this alert fired from, to look for signs of other suspicious activities. The first step in that process will be to look at the parent process that launched these suspicious processes, and see what other activities that process has done. That should guide you to the underlying problem. As you get more information about this particular system (for example, how did malware end up on it, what websites has it communicated with, etc.), make sure to pivot and look across your entire organization for other indications, and to look in Open Source Intelligence sites like VirusTotal to learn more about the attacker.</p>",
         "help" : "<p>This example leverages the Simple Search assistant. Our dataset is a collection of Windows process launch logs (Event ID 4688), where we have hashing turned on (look for tools like WLS, or Sysmon to help here). It then filters for a set of file hashes that are known to be hacker related (from a lookup called tools.csv) and uses the transaction command to group them by time. If there's a single transaction with many events, it surfaces those.</p>",
         "howToImplement" : "The hardest part of implementing this correctly, once you have EDR logs ingested, will be to make sure that the fields correctly set. (Why EDR? The boundary between EDR logs and Windows Security Logs for <b>most</b> Splunk customers is that Windows Process Launch Logs won't contain hashes, or the right variety of hashes, but EDR tools including the free Sysmon tool will.)<ul><li>In the live version, we start with index=* which is bad Splunk form (but makes it a little bit easier to get started). You should make sure that you specify the index where your EDR logs live (index=epintel if you follow our best practices, and the documentation in this app).</li><li>The next field you have to worry about is the sourcetype, which should be pretty standard.</li><li>The EventCode field is the second to last field you have to think about, which if you use our <a href=\"https://splunkbase.splunk.com/app/1914/\">Splunk Add-on for Sysmon</a> on your Search Head, will also work automatically for you (again, docs are key!)</li><li>Finally, Sysmon will return multiple different hashes. In order for the hashes to show up correctly in the table, make sure that you have a field named sha1 (or change the search to match what you see in the events).</ul><p>Once you have the search itself running, then you need only schedule it (click \"Schedule Alert\") and have Splunk email you, create a ticket in Enterprise Security or Service Now, or take some other action for you.",
         "includeSSE" : "Yes",
         "name" : "Concentration of Attacker Tools by SHA1 Hash",
         "relevance" : "Building on the two examples of surfacing concentrations of attacker or discovery tools via filename, a more accurate method for doing this is to use the SHA1 cryptographic hashes for these tools, because tools can always be renamed before executing. By correlating the process hashes being executed on endpoints with a list of 'known hacker tool executable hashes' we can detect this suspicious activity.",
         "domain" : "Endpoint",
         "knownFP" : "<p>This search should trigger very few false positives, because it's filtered to just very specific launches, and even more, looking for multiple process launches in a short period of time. The only scenario where you would expect to see this happen is if your organization happens to use some of those unusual tools for normal sysadmin tasks, and have them scripted. Beyond that, be suspicious!</p>",
         "mitre" : "Discovery|Lateral Movement|Execution",
         "hasSearch" : "Yes",
         "killchain" : "Exploitation",
         "searchKeywords" : "",
         "description" : "<p>It's uncommon to see attacker tools used in rapid succession on an endpoint. This search will identify tools by file hash, and look for multiple executions. (<a href=\"https://car.mitre.org/wiki/CAR-2013-04-002\">MITRE CAR Reference</a>)</p><p><b>Alert Volume:</b> Low</p>",
         "mitre_technique" : "|T1087|T1010|T1069|T1057|T1012|T1082|T1016|T1063|T1007|T1033|T1049|T1003|T1077|T1050|T1031|T1058|T1035|T1029|T1053|T1089|T1098|T1059|T1054",
         "SPLEase" : "Basic",
         "dashboard" : "showcase_simple_search?ml_toolkit.dataset=Series of Hacker Hashes - Demo",
         "alertvolume" : "Low",
         "examples" : [
            {
               "name" : "Series of Hacker Hashes - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "Series of Hacker Hashes - Live",
               "label" : "Live Data"
            }
         ],
         "journey" : "Stage_3",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "mitre_tactic" : "TA0007|TA0008|TA0002|TA0006|TA0004|TA0003|TA0010|TA0005",
         "app" : "Splunk_Security_Essentials",
         "highlight" : "No",
         "displayapp" : "Splunk Security Essentials",
         "datasource" : "Endpoint Detection and Response",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "icon" : "Core_Use_Case.png"
      },
      "detection_malicious_powershell_process_encoded_command" : {
         "hasSearch" : "No",
         "killchain" : "Command and Control|Actions on Objective",
         "searchKeywords" : "",
         "description" : "This search looks for PowerShell processes that have encoded the script within the command-line. Malware has been seen using this parameter, as it obfuscates the code and makes it relatively easy to pass a script on the command-line.",
         "mitre_technique" : "T1086|T1064",
         "search_name" : "ESCU - Malicious PowerShell Process - Encoded Command - Rule",
         "SPLEase" : "None",
         "released" : "2.0.0",
         "category" : "Endpoint Compromise",
         "help" : "This search looks for PowerShell processes that are passing encoded commands on the command-line. The flags \"-EncodedCommand\" and \"-enc\" are two different possible flags that can be used to pass base64 encoded commands to PowerShell.  This search will return the host, the user the process ran under, the process and it's command-line arguments, the number of times it's seen this process, and the first and last times it saw this process.",
         "includeSSE" : "Yes",
         "name" : "Malicious PowerShell Process - Encoded Command",
         "domain" : "Endpoint",
         "mitre" : "Execution",
         "journey" : "Stage_3",
         "mitre_tactic" : "TA0002",
         "data_source_categories" : "DS009EndPointIntel-ET01ProcessLaunch",
         "app" : "Enterprise_Security_Content_Update",
         "story" : "Malicious PowerShell",
         "highlight" : "No",
         "datasource" : "Endpoint Detection and Response",
         "displayapp" : "Enterprise Security Content Update",
         "usecase" : "Advanced Threat Detection",
         "icon" : "ES_Use_Case.png",
         "dashboard" : "ESCU_Use_Case",
         "alertvolume" : "Medium"
      },
      "external_website_attack" : {
         "relatedUseCases" : [
            ""
         ],
         "mitre_notes" : "",
         "dashboard" : "UBA_Use_Case",
         "alertvolume" : "Other",
         "app" : "Splunk_User_Behavior_Analytics",
         "journey" : "Stage_4",
         "mitre_tactic" : "|TA0001|TA0018",
         "data_source_categories" : "DS014WebServer-ET01Access",
         "icon" : "UBA_Use_Case.png",
         "usecase" : "Application Security",
         "highlight" : "No",
         "datasource" : "Web Server",
         "displayapp" : "Splunk User Behavior Analytics",
         "help" : "Help not needed -- UBA Use Case",
         "released" : "2.0.0",
         "category" : "Web Attack",
         "domain" : "Other",
         "mitre" : "",
         "name" : "External Website Attack",
         "includeSSE" : "Yes",
         "killchain" : "None",
         "searchKeywords" : "",
         "hasSearch" : "No",
         "mitre_technique" : "|T1190|T1293",
         "description" : "Raises anomalies when there are suspicious patterns in incoming web traffic."
      },
      "UC0001" : {
         "displayapp" : "Splunk Professional Services",
         "datasource" : "Web Proxy",
         "highlight" : "No",
         "usecase" : "Security Monitoring|Compliance|Insider Threat",
         "icon" : "PS_Use_Case.png",
         "mitre_tactic" : "",
         "journey" : "Stage_3",
         "app" : "Splunk_Professional_Services",
         "alertvolume" : "Other",
         "dashboard" : "PS_Use_Case",
         "description" : "Prohibited web applications such as file sharing platforms (i.e. Box, Dropbox, etc.), and games can be detected, and filtered by modern web proxy solutions/next generation firewalls. Existing exceptions, or new application instances should be reviewed to ensure appropriate usage.",
         "SPLEase" : "None",
         "mitre_technique" : "",
         "hasSearch" : "No",
         "searchKeywords" : "",
         "killchain" : "None",
         "name" : "Detection of new/prohibited web application",
         "includeSSE" : "No",
         "mitre" : "",
         "domain" : "Network",
         "category" : "Unauthorized Software|Data Exfiltration|Compliance",
         "released" : "2.0.0",
         "help" : "Help not needed -- PS Use Case"
      },
      "showcase_first_usb" : {
         "app" : "Splunk_Security_Essentials",
         "examples" : [
            {
               "name" : "First USB Usage - Demo",
               "label" : "Demo Data"
            },
            {
               "name" : "First USB Usage - Live",
               "label" : "Live Data"
            },
            {
               "name" : "First USB Usage - Accelerated",
               "label" : "Accelerated Data"
            }
         ],
         "journey" : "Stage_1",
         "mitre_tactic" : "TA0008|TA0009|TA0010",
         "data_source_categories" : "DS016DataLossPrevention-ET01Violation|DS009EndPointIntel-ET05ObjectChangeRemovableStorage",
         "icon" : "Core_Use_Case.png",
         "usecase" : "Insider Threat",
         "highlight" : "No",
         "datasource" : "DLP|Endpoint Detection and Response",
         "displayapp" : "Splunk Security Essentials",
         "relatedUseCases" : [
            "unusual_usb_activity",
            "Basic_Malware_Outbreak",
            "outbreak_detected",
            "UC0029"
         ],
         "dashboard" : "showcase_first_seen_demo?ml_toolkit.dataset=First USB Usage - Demo",
         "alertvolume" : "Medium",
         "killchain" : "Delivery",
         "searchKeywords" : "",
         "hasSearch" : "Yes",
         "mitre_technique" : "|T1091|T1025|T1052",
         "SPLEase" : "Medium",
         "description" : "<p>Find systems the first time they generate Windows Event ID 20001, which for some customers occurs when a USB drive is plugged in.</p><p><b>Alert Volume:</b> Medium</p>",
         "operationalize" : "<p>When this search returns values, initiate your incident response process and identify the physical location of the system. Determine the system owner and inform them of this action. Work with the system owner to determine next steps or note that this is authorized and by whom. USB insertions that are unauthorized could be used as a mechanism to infect a machine.</p>",
         "help" : "<p>This example leverages the Detect New Values search assistant. Our dataset is an anonymized collection of Windows Event ID 20001 logs, which correlated on that system with when USB drives were used. (You may also get value from using endpoint DLP, etc -- we have also seen at a larger customer where their Splunk installation did not have 20001 logs showing up). For this analysis, we are looking at the first time that Event ID is showing up from that system and alerting if that was in the last day. </p>",
         "howToImplement" : "<p>Implementation of this example (or any of the First Time Seen examples) is generally very simple. <ul><li>Validate that you have the right data onboarded, and that the fields you want to monitor are properly extracted. <b>For this example</b> this is tricky, since in our testing some systems generate system EventCode 20001 when a USB drive is plugged in, and others do not, and it is not clear why. You may wish to switch the base dataset here with endpoint DLP if available, as it would more reliably track USB key usage.</li><li>Save the search.</li></ul></p><p>For most environments, these searches can be run once a day, often overnight, without worrying too much about a slow search. If you wish to run this search more frequently, or if this search is too slow for your environment, we recommend leveraging a lookup cache. For more on this, see the lookup cache dropdown below and select the sample item. A window will pop up telling you more about this feature.</p>",
         "released" : "1.0.0",
         "category" : "Data Exfiltration",
         "relevance" : "USB is a common attack vector for many different kinds of malicious deliverables. Your corporation may have a policy of not allowing removable media at all, or may only allow approved media to be used. By Splunking USB activity from Windows and other endpoints using the Universal Forwarder, we can get a feeling for what systems might be vulnerable to attack, or what users might need a security training refresher. This example demonstrates that if we have the USB usage data in Splunk, we can determine the first time a “new device” is used on an endpoint. This activity might result in an alert or a notable event so that security personnel can conduct follow-up.",
         "domain" : "Data",
         "mitre" : "Lateral Movement|Collection|Exfiltration",
         "knownFP" : "<p class=\"disclaimer\">This is a strictly behavioral search, so we define \"false positive\" slightly differently. Every time this fires, it will accurately reflect the first occurrence in the time period you're searching over (or for the lookup cache feature, the first occurrence over whatever time period you built the lookup). But while there are really no \"false positives\" in a traditional sense, there is definitely lots of noise.</p> <p>This will obviously fire any time there is a USB key inserted for the first time, which is not an explicit indicator of suspicious activities. Instead use them for context, or to aggregate risk (as mentioned under How To Respond).</p> ",
         "name" : "First Time USB Usage",
         "includeSSE" : "Yes"
      },
      "UC0008" : {
         "dashboard" : "PS_Use_Case",
         "alertvolume" : "Other",
         "journey" : "Stage_4",
         "mitre_tactic" : "",
         "app" : "Splunk_Professional_Services",
         "highlight" : "No",
         "datasource" : "Authentication",
         "displayapp" : "Splunk Professional Services",
         "usecase" : "Advanced Threat Detection|Security Monitoring",
         "icon" : "PS_Use_Case.png",
         "released" : "2.0.0",
         "category" : "Account Compromise|Lateral Movement",
         "help" : "Help not needed -- PS Use Case",
         "name" : "Activity on previously inactive account",
         "includeSSE" : "No",
         "domain" : "Access",
         "mitre" : "",
         "hasSearch" : "No",
         "killchain" : "None",
         "searchKeywords" : "",
         "description" : "Excluding computer accounts in active directory, an account with new activity that has not been active in the previous thirty days is suspicious.",
         "mitre_technique" : "",
         "SPLEase" : "None"
      }
   }
}
